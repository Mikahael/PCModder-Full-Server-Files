import base64
text= b'IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KaW1wb3J0IGJzCmltcG9ydCBic1V0aWxzCmZyb20gYnNWZWN0b3IgaW1wb3J0IFZlY3RvcgppbXBvcnQgcmFuZG9tCmltcG9ydCBic0FjaGlldmVtZW50CmltcG9ydCB3ZWFrcmVmCmltcG9ydCBic0ludGVybmFsCmltcG9ydCBic1NvbWV0aGluZwppbXBvcnQgYnNNYXAKaW1wb3J0IGRvbgppbXBvcnQgYnNTcGF6CgonJycKRG9uZSBieSBQQzIzMTM5MiAvIFBDTW9kZGVyIC8gUEMyOTA3MTcKRnVsbCBzY3JpcHRzIHNoYXJlZCB0byB0aGUgd29ybGQuCkRvIHVzZSBpdCB3ZWxsIGFuZCBlbmpveSBpdCB3ZWxsLgpJZiBwb3NzaWJsZSwga2luZGx5IGRvIGdpdmUgY3JlZGl0IHRvIG1lLgpUaGFua3MgdG8gYWxsLgoxMDAlCicnJwoKY2xhc3MgQW50aUdyYXZBcmVhKG9iamVjdCk6CiAgICAiIiJGb3IgbWFraW5nIHRoZSBhcmVhIHRvIGdpdmUgdGhlIHNwYXogdXB3YXJkIGZvcmNlLiIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwb3NpdGlvbiwgcmFkaXVzKToKICAgICAgICBzZWxmLnBvc2l0aW9uID0gKHBvc2l0aW9uWzBdLCBwb3NpdGlvblsxXSArIDEsIHBvc2l0aW9uWzJdKQogICAgICAgIHNlbGYucmFkaXVzID0gcmFkaXVzCiAgICAgICAgY29sb3IgPSAocmFuZG9tLnJhbmRvbSgpLCByYW5kb20ucmFuZG9tKCksIHJhbmRvbS5yYW5kb20oKSkKICAgICAgICBzZWxmLm1hdGVyaWFsID0gYnMuTWF0ZXJpYWwoKQogICAgICAgIHNlbGYubWF0ZXJpYWwuYWRkQWN0aW9ucyhjb25kaXRpb25zPSgoJ3RoZXlIYXZlTWF0ZXJpYWwnLCBicy5nZXRTaGFyZWRPYmplY3QoJ3BsYXllck1hdGVyaWFsJykpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9ucz0oKCJtb2RpZnlQYXJ0Q29sbGlzaW9uIiwgImNvbGxpZGUiLCBUcnVlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCJtb2RpZnlQYXJ0Q29sbGlzaW9uIiwgInBoeXNpY2FsIiwgRmFsc2UpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoImNhbGwiLCAiYXRDb25uZWN0Iiwgc2VsZi50b3VjaGVkU3BheikpKQogICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3JlZ2lvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3Bvc2l0aW9uJzogKHNlbGYucG9zaXRpb25bMF0sIHNlbGYucG9zaXRpb25bMV0sIHNlbGYucG9zaXRpb25bMl0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzY2FsZSc6IChzZWxmLnJhZGl1cywgc2VsZi5yYWRpdXMsIHNlbGYucmFkaXVzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdzcGhlcmUnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOiBbc2VsZi5tYXRlcmlhbF19KQogICAgICAgIHNlbGYudmlzdWFsUmFkaXVzID0gYnMubmV3Tm9kZSgnc2hpZWxkJywgYXR0cnM9eydwb3NpdGlvbic6IHNlbGYucG9zaXRpb24sICdjb2xvcic6IGNvbG9yLCAncmFkaXVzJzogMC4xfSkKICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi52aXN1YWxSYWRpdXMsICJyYWRpdXMiLCB7MDogMCwgNTAwOiBzZWxmLnJhZGl1cyAqIDJ9KQogICAgICAgIGJzVXRpbHMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZSwgInNjYWxlIiwgMywgezA6ICgwLCAwLCAwKSwgNTAwOiAoc2VsZi5yYWRpdXMsIHNlbGYucmFkaXVzLCBzZWxmLnJhZGl1cyl9KQoKICAgIGRlZiBkZWxldGUoc2VsZik6CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBzZWxmLm5vZGUuZGVsZXRlKCkKICAgICAgICBpZiBzZWxmLnZpc3VhbFJhZGl1cy5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi52aXN1YWxSYWRpdXMuZGVsZXRlKCkKCiAgICBkZWYgdG91Y2hlZFNwYXooc2VsZik6CiAgICAgICAgbm9kZSA9IGJzLmdldENvbGxpc2lvbkluZm8oJ29wcG9zaW5nTm9kZScpCiAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ2dyYXZpdHknKSkKCmNsYXNzIFNwbGF0TWVzc2FnZShvYmplY3QpOgogICAgcGFzcwoKY2xhc3MgRXhwbG9kZU1lc3NhZ2Uob2JqZWN0KToKICAgIHBhc3MKCmNsYXNzIEltcGFjdE1lc3NhZ2Uob2JqZWN0KToKICAgICIiIiBpbXBhY3QgYm9tYiB0b3VjaGVkIHNvbWV0aGluZyAiIiIKICAgIHBhc3MKCmNsYXNzIEFybU1lc3NhZ2Uob2JqZWN0KToKICAgIHBhc3MKCmNsYXNzIFdhcm5NZXNzYWdlKG9iamVjdCk6CiAgICBwYXNzCgpjbGFzcyBGaXJld29ya0JvbWJIaXRNZXNzYWdlKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgcGFzcwoKY2xhc3MgVGVsZXBvcnRCb21iSGl0TWVzc2FnZShvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHBhc3MKCmNsYXNzIFBvaXNvbkJvbWJIaXRNZXNzYWdlKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgcGFzcwoKY2xhc3MgRXhwbG9kZUhpdE1lc3NhZ2Uob2JqZWN0KToKICAgICJNZXNzYWdlIHNheWluZyBhbiBvYmplY3Qgd2FzIGhpdCIKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBwYXNzCgpjbGFzcyBEaXJ0Qm9tYk91dE1lc3NhZ2Uob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBwYXNzCgpjbGFzcyBCb21iRmFjdG9yeShvYmplY3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogR2FtZSBGbG93IENsYXNzZXMKCiAgICBXcmFwcyB1cCBtZWRpYSBhbmQgb3RoZXIgcmVzb3VyY2VzIHVzZWQgYnkgYnMuQm9tYnMKICAgIEEgc2luZ2xlIGluc3RhbmNlIG9mIHRoaXMgaXMgc2hhcmVkIGJldHdlZW4gYWxsIGJvbWJzCiAgICBhbmQgY2FuIGJlIHJldHJpZXZlZCB2aWEgYnMuQm9tYi5nZXRGYWN0b3J5KCkuCgogICAgQXR0cmlidXRlczoKCiAgICAgICBib21iTW9kZWwKICAgICAgICAgIFRoZSBicy5Nb2RlbCBvZiBhIHN0YW5kYXJkIG9yIGljZSBib21iLgoKICAgICAgIHN0aWNreUJvbWJNb2RlbAogICAgICAgICAgVGhlIGJzLk1vZGVsIG9mIGEgc3RpY2t5LWJvbWIuCgogICAgICAgaW1wYWN0Qm9tYk1vZGVsCiAgICAgICAgICBUaGUgYnMuTW9kZWwgb2YgYW4gaW1wYWN0LWJvbWIuCgogICAgICAgbGFuZE1pbk1vZGVsCiAgICAgICAgICBUaGUgYnMuTW9kZWwgb2YgYSBsYW5kLW1pbmUuCgogICAgICAgdG50TW9kZWwKICAgICAgICAgIFRoZSBicy5Nb2RlbCBvZiBhIHRudCBib3guCgogICAgICAgcmVndWxhclRleAogICAgICAgICAgVGhlIGJzLlRleHR1cmUgZm9yIHJlZ3VsYXIgYm9tYnMuCgogICAgICAgaWNlVGV4CiAgICAgICAgICBUaGUgYnMuVGV4dHVyZSBmb3IgaWNlIGJvbWJzLgoKICAgICAgIHN0aWNreVRleAogICAgICAgICAgVGhlIGJzLlRleHR1cmUgZm9yIHN0aWNreSBib21icy4KCiAgICAgICBpbXBhY3RUZXgKICAgICAgICAgIFRoZSBicy5UZXh0dXJlIGZvciBpbXBhY3QgYm9tYnMuCgogICAgICAgaW1wYWN0TGl0VGV4CiAgICAgICAgICBUaGUgYnMuVGV4dHVyZSBmb3IgaW1wYWN0IGJvbWJzIHdpdGggbGlnaHRzIGxpdC4KCiAgICAgICBsYW5kTWluZVRleAogICAgICAgICAgVGhlIGJzLlRleHR1cmUgZm9yIGxhbmQtbWluZXMuCgogICAgICAgbGFuZE1pbmVMaXRUZXgKICAgICAgICAgIFRoZSBicy5UZXh0dXJlIGZvciBsYW5kLW1pbmVzIHdpdGggdGhlIGxpZ2h0IGxpdC4KCiAgICAgICB0bnRUZXgKICAgICAgICAgIFRoZSBicy5UZXh0dXJlIGZvciB0bnQgYm94ZXMuCgogICAgICAgaGlzc1NvdW5kCiAgICAgICAgICBUaGUgYnMuU291bmQgZm9yIHRoZSBoaXNzIHNvdW5kIGFuIGljZSBib21iIG1ha2VzLgoKICAgICAgIGRlYnJpc0ZhbGxTb3VuZAogICAgICAgICAgVGhlIGJzLlNvdW5kIGZvciByYW5kb20gZmFsbGluZyBkZWJyaXMgYWZ0ZXIgYW4gZXhwbG9zaW9uLgoKICAgICAgIHdvb2REZWJyaXNGYWxsU291bmQKICAgICAgICAgIEEgYnMuU291bmQgZm9yIHJhbmRvbSB3b29kIGRlYnJpcyBmYWxsaW5nIGFmdGVyIGFuIGV4cGxvc2lvbi4KCiAgICAgICBleHBsb2RlU291bmRzCiAgICAgICAgICBBIHR1cGxlIG9mIGJzLlNvdW5kcyBmb3IgZXhwbG9zaW9ucy4KCiAgICAgICBmcmVlemVTb3VuZAogICAgICAgICAgQSBicy5Tb3VuZCBvZiBhbiBpY2UgYm9tYiBmcmVlemluZyBzb21ldGhpbmcuCgogICAgICAgZnVzZVNvdW5kCiAgICAgICAgICBBIGJzLlNvdW5kIG9mIGEgYnVybmluZyBmdXNlLgoKICAgICAgIGFjdGl2YXRlU291bmQKICAgICAgICAgIEEgYnMuU291bmQgZm9yIGFuIGFjdGl2YXRpbmcgaW1wYWN0IGJvbWIuCgogICAgICAgd2FyblNvdW5kCiAgICAgICAgICBBIGJzLlNvdW5kIGZvciBhbiBpbXBhY3QgYm9tYiBhYm91dCB0byBleHBsb2RlIGR1ZSB0byB0aW1lLW91dC4KCiAgICAgICBib21iTWF0ZXJpYWwKICAgICAgICAgIEEgYnMuTWF0ZXJpYWwgYXBwbGllZCB0byBhbGwgYm9tYnMuCgogICAgICAgbm9ybWFsU291bmRNYXRlcmlhbAogICAgICAgICAgQSBicy5NYXRlcmlhbCB0aGF0IGdlbmVyYXRlcyBzdGFuZGFyZCBib21iIG5vaXNlcyBvbiBpbXBhY3RzLCBldGMuCgogICAgICAgc3RpY2t5TWF0ZXJpYWwKICAgICAgICAgIEEgYnMuTWF0ZXJpYWwgdGhhdCBtYWtlcyAnc3BsYXQnIHNvdW5kcyBhbmQgbWFrZXMgY29sbGlzaW9ucyBzb2Z0ZXIuCgogICAgICAgbGFuZE1pbmVOb0V4cGxvZGVNYXRlcmlhbAogICAgICAgICAgQSBicy5NYXRlcmlhbCB0aGF0IGtlZXBzIGxhbmQtbWluZXMgZnJvbSBibG93aW5nIHVwLgogICAgICAgICAgQXBwbGllZCB0byBsYW5kLW1pbmVzIHdoZW4gdGhleSBhcmUgY3JlYXRlZCB0byBhbGxvdyBsYW5kLW1pbmVzIHRvCiAgICAgICAgICB0b3VjaCB3aXRob3V0IGV4cGxvZGluZy4KCiAgICAgICBsYW5kTWluZUJsYXN0TWF0ZXJpYWwKICAgICAgICAgIEEgYnMuTWF0ZXJpYWwgYXBwbGllZCB0byBhY3RpdmF0ZWQgbGFuZC1taW5lcyB0aGF0IGNhdXNlcyB0aGVtIHRvCiAgICAgICAgICBleHBsb2RlIG9uIGltcGFjdC4KCiAgICAgICBpbXBhY3RCbGFzdE1hdGVyaWFsCiAgICAgICAgICBBIGJzLk1hdGVyaWFsIGFwcGxpZWQgdG8gYWN0aXZhdGVkIGltcGFjdC1ib21icyB0aGF0IGNhdXNlcyB0aGVtIHRvCiAgICAgICAgICBleHBsb2RlIG9uIGltcGFjdC4KCiAgICAgICBibGFzdE1hdGVyaWFsCiAgICAgICAgICBBIGJzLk1hdGVyaWFsIGFwcGxpZWQgdG8gYm9tYiBibGFzdCBnZW9tZXRyeSB3aGljaCB0cmlnZ2VycyBpbXBhY3QKICAgICAgICAgIGV2ZW50cyB3aXRoIHdoYXQgaXQgdG91Y2hlcy4KCiAgICAgICBkaW5rU291bmRzCiAgICAgICAgICBBIHR1cGxlIG9mIGJzLlNvdW5kcyBmb3Igd2hlbiBib21icyBoaXQgdGhlIGdyb3VuZC4KCiAgICAgICBzdGlja3lJbXBhY3RTb3VuZAogICAgICAgICAgVGhlIGJzLlNvdW5kIGZvciBhIHNxdWlzaCBtYWRlIGJ5IGEgc3RpY2t5IGJvbWIgaGl0dGluZyBzb21ldGhpbmcuCgogICAgICAgcm9sbFNvdW5kCiAgICAgICAgICBicy5Tb3VuZCBmb3IgYSByb2xsaW5nIGJvbWIuCiAgICAiIiIKCiAgICBkZWYgZ2V0UmFuZG9tRXhwbG9kZVNvdW5kKHNlbGYpOgogICAgICAgICdSZXR1cm4gYSByYW5kb20gZXhwbG9zaW9uIGJzLlNvdW5kIGZyb20gdGhlIGZhY3RvcnkuJwogICAgICAgIHJldHVybiBzZWxmLmV4cGxvZGVTb3VuZHNbcmFuZG9tLnJhbmRyYW5nZShsZW4oc2VsZi5leHBsb2RlU291bmRzKSldCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIEluc3RhbnRpYXRlIGEgQm9tYkZhY3RvcnkuCiAgICAgICAgWW91IHNob3VsZG4ndCBuZWVkIHRvIGRvIHRoaXM7IGNhbGwgYnMuQm9tYi5nZXRGYWN0b3J5KCkgdG8gZ2V0IGEKICAgICAgICBzaGFyZWQgaW5zdGFuY2UuCiAgICAgICAgIiIiCgogICAgICAgIHNlbGYuYm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWInKQogICAgICAgIHNlbGYuZmlyZXdvcmtNb2RlbCA9IGJzLmdldE1vZGVsKCd0bnQnKQogICAgICAgIHNlbGYua2lsbExhS2lsbE1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWJTdGlja3knKQogICAgICAgIHNlbGYuc3RpY2t5Qm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWJTdGlja3knKQogICAgICAgIHNlbGYuaW1wYWN0Qm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2ltcGFjdEJvbWInKQogICAgICAgIHNlbGYubGFuZE1pbmVNb2RlbCA9IGJzLmdldE1vZGVsKCdsYW5kTWluZScpCiAgICAgICAgc2VsZi50bnRNb2RlbCA9IGJzLmdldE1vZGVsKCd0bnQnKQogICAgICAgIHNlbGYucXFNb2RlbCA9IGJzLmdldE1vZGVsKCdib21iJykgI3FxIGlzIGp1bXBpbmcgYm9tYgogICAgICAgIHNlbGYudHBNb2RlbCA9IGJzLmdldE1vZGVsKCdib21iJykKICAgICAgICBzZWxmLnBvaXNvbk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWInKQogICAgICAgIHNlbGYudGltZXJUZXggPSBicy5nZXRUZXh0dXJlKCJudWIiKQojb3VyIGJvbWJzIG5vd3MKICAgICAgICBzZWxmLmJhbGxvbk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWInKQogICAgICAgIHNlbGYuYmxvY2tNb2RlbCA9IGJzLmdldE1vZGVsKCd0bnQnKQogICAgICAgIHNlbGYuaWNlSW1wYWN0TW9kZWwgPSBicy5nZXRNb2RlbCgnaW1wYWN0Qm9tYicpCiAgICAgICAgc2VsZi50Ym9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2Zyb3N0eVBlbHZpcycpCiAgICAgICAgc2VsZi5nbHVlYm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2ltcGFjdEJvbWInKQogICAgICAgIHNlbGYud2VlZGJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlQZWx2aXMnKQogICAgICAgIHNlbGYuc3BhekJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCduZW9TcGF6SGVhZCcpCiAgICAgICAgc2VsZi5jdXJzZUJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCdpbXBhY3RCb21iJykKICAgICAgICBzZWxmLm5pZ2h0Qm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWInKQogICAgICAgIHNlbGYuYmxhc3RCb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnYm9tYicpCiAgICAgICAgc2VsZi5yZXZlbmdlQm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbWInKQogICAgICAgIHNlbGYua25vY2tCb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnaW1wYWN0Qm9tYicpCiAgICAgICAgc2VsZi5oZWFsQm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2ltcGFjdEJvbWInKQogICAgICAgIHNlbGYuc3BlZWRCb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnaW1wYWN0Qm9tYicpCiAgICAgICAgc2VsZi5jaGFyYWN0ZXJCb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnaW1wYWN0Qm9tYicpCiAgICAgICAgc2VsZi5takJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCdpbXBhY3RCb21iJykKICAgICAgICBzZWxmLmljeVRyaW9Nb2RlbCA9IGJzLmdldE1vZGVsKCdpbXBhY3RCb21iJykKICAgICAgICBzZWxmLnRyaW9Cb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnaW1wYWN0Qm9tYicpCiAgICAgICAgc2VsZi5zdGlja3lJY2VCb21iTW9kZWwgPSBicy5nZXRNb2RlbCgnYm9tYicpCiAgICAgICAgc2VsZi5zdGlja3lJY2VUcmlvQm9tYk1vZGVsID0gYnMuZ2V0TW9kZWwoJ2ltcGFjdEJvbWInKQogICAgICAgIHNlbGYuYm9vbUJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCdpbXBhY3RCb21iJykKICAgICAgICBzZWxmLnVzZUJvbWJNb2RlbCA9IGJzLmdldE1vZGVsKCdpbXBhY3RCb21iJykKCiAgICAgICAgc2VsZi5yZWd1bGFyVGV4ID0gYnMuZ2V0VGV4dHVyZSgnYm9tYkNvbG9yJykKICAgICAgICBzZWxmLnRwVGV4ID0gYnMuZ2V0VGV4dHVyZSgnYm9tYlN0aWNreUNvbG9yJykKICAgICAgICBzZWxmLnBvaXNvblRleCA9IGJzLmdldFRleHR1cmUoJ2JvbWJDb2xvcicpCiAgICAgICAgc2VsZi5raWxsTGFLaWxsVGV4ID0gYnMuZ2V0VGV4dHVyZSgnYm9tYkNvbG9yJykgCiAgICAgICAgc2VsZi5maXJld29ya1RleCA9IGJzLmdldFRleHR1cmUoJ2VnZ1RleDInKSAKICAgICAgICBzZWxmLmljZVRleCA9IGJzLmdldFRleHR1cmUoJ2JvbWJDb2xvckljZScpCiAgICAgICAgc2VsZi5zdGlja3lUZXggPSBicy5nZXRUZXh0dXJlKCdib21iU3RpY2t5Q29sb3InKSNib21iU3RpY2t5Q29sb3IKICAgICAgICBzZWxmLmltcGFjdFRleCA9IGJzLmdldFRleHR1cmUoJ2ltcGFjdEJvbWJDb2xvcicpCiAgICAgICAgc2VsZi5pbXBhY3RMaXRUZXggPSBicy5nZXRUZXh0dXJlKCdpbXBhY3RCb21iQ29sb3JMaXQnKQogICAgICAgIHNlbGYubGFuZE1pbmVUZXggPSBicy5nZXRUZXh0dXJlKCdsYW5kTWluZScpCiAgICAgICAgc2VsZi5iYWxsVGV4ID0gYnMuZ2V0VGV4dHVyZSgnYWNoaWV2ZW1lbnRPdXRsaW5lJykKICAgICAgICBzZWxmLmJhbGxNb2RlbCA9IGJzLmdldE1vZGVsKCdzaGllbGQnKQogICAgICAgIHNlbGYubGFuZE1pbmVMaXRUZXggPSBicy5nZXRUZXh0dXJlKCdsYW5kTWluZUxpdCcpCiAgICAgICAgc2VsZi50bnRUZXggPSBicy5nZXRUZXh0dXJlKCd0bnQnKQogICAgICAgIHNlbGYucXFUZXggPSBicy5nZXRUZXh0dXJlKCdlZ2dUZXgzJykKICAgICAgICBzZWxmLnFxTGl0VGV4ID0gYnMuZ2V0VGV4dHVyZSgnZWdnVGV4MycpCiNvdXIgdGV4CiAgICAgICAgc2VsZi5iYWxsb25UZXggPSBicy5nZXRUZXh0dXJlKCdiZycpCiAgICAgICAgc2VsZi5ibG9ja1RleCA9IGJzLmdldFRleHR1cmUoJ2FjaGlldmVtZW50RW1wdHknKQogICAgICAgIHNlbGYuaWNlSW1wYWN0VGV4ID0gYnMuZ2V0VGV4dHVyZSgnYm9tYkNvbG9ySWNlJykKICAgICAgICBzZWxmLnRib21iVGV4ID0gYnMuZ2V0VGV4dHVyZSgnZWdnVGV4MScpCiAgICAgICAgc2VsZi5nbHVlYm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ3Bvd2VydXBTdGlja3lCb21icycpCiAgICAgICAgc2VsZi53ZWVkYm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ2VnZ1RleDInKQogICAgICAgIHNlbGYudGV4U3BhekJvbWIgPSBicy5nZXRUZXh0dXJlKCduZW9TcGF6Q29sb3InKQogICAgICAgIHNlbGYuY3Vyc2VCb21iVGV4ID0gYnMuZ2V0VGV4dHVyZSgnbmlnaHQnKQogICAgICAgIHNlbGYubmlnaHRCb21iVGV4ID0gYnMuZ2V0VGV4dHVyZSgnc2hpZWxkJykKICAgICAgICBzZWxmLmJsYXN0Qm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ2Nyb3NzT3V0TWFzaycpCiAgICAgICAgc2VsZi5yZXZlbmdlQm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ2dhbWVDaXJjbGVJY29uJykKICAgICAgICBzZWxmLmtub2NrQm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ21lZGFsR29sZCcpCiAgICAgICAgc2VsZi5oZWFsQm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ3NoaWVsZCcpCiAgICAgICAgc2VsZi5zcGVlZEJvbWJUZXggPSBicy5nZXRUZXh0dXJlKCdleWVDb2xvcicpCiAgICAgICAgc2VsZi5jaGFyYWN0ZXJCb21iVGV4ID0gYnMuZ2V0VGV4dHVyZSgnY3Jvc3NPdXRNYXNrJykKICAgICAgICBzZWxmLm1qQm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ21lbnVCdXR0b24nKQogICAgICAgIHNlbGYuaWN5VHJpb1RleCA9IGJzLmdldFRleHR1cmUoJ3Bvd2VydXBTaGllbGQnKQogICAgICAgIHNlbGYudHJpb0JvbWJUZXggPSBicy5nZXRUZXh0dXJlKCdzdGFyJykKICAgICAgICBzZWxmLnN0aWNreUljZVRyaW9UZXggPSBicy5nZXRUZXh0dXJlKCduaWdodCcpCiAgICAgICAgc2VsZi5ib29tQm9tYlRleCA9IGJzLmdldFRleHR1cmUoJ2Nyb3NzT3V0TWFzaycpCiAgICAgICAgc2VsZi51c2VUZXggPSBicy5nZXRUZXh0dXJlKCduaWdodCcpCiAgICAgICAgc2VsZi5uZXdUZXggPSBicy5nZXRUZXh0dXJlKCJhY2hpZXZlbWVudE9uc2xhdWdodCIpCgogICAgICAgIHNlbGYuaGlzc1NvdW5kID0gYnMuZ2V0U291bmQoJ2hpc3MnKQogICAgICAgIHNlbGYuZGVicmlzRmFsbFNvdW5kID0gYnMuZ2V0U291bmQoJ2RlYnJpc0ZhbGwnKQogICAgICAgIHNlbGYud29vZERlYnJpc0ZhbGxTb3VuZCA9IGJzLmdldFNvdW5kKCd3b29kRGVicmlzRmFsbCcpCiAgICAgICAgc2VsZi5xcVNvdW5kID0gYnMuZ2V0U291bmQoJ2xhc2VyJykKCiAgICAgICAgc2VsZi5leHBsb2RlU291bmRzID0gKGJzLmdldFNvdW5kKCdleHBsb3Npb24wMScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTb3VuZCgnZXhwbG9zaW9uMDInKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U291bmQoJ2V4cGxvc2lvbjAzJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNvdW5kKCdleHBsb3Npb24wNCcpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTb3VuZCgnZXhwbG9zaW9uMDUnKSkKCiAgICAgICAgc2VsZi5mcmVlemVTb3VuZCA9IGJzLmdldFNvdW5kKCdmcmVlemUnKQogICAgICAgIHNlbGYuZnVzZVNvdW5kID0gYnMuZ2V0U291bmQoJ2Z1c2UwMScpCiAgICAgICAgc2VsZi5zcGxhdHRlclNvdW5kID0gYnMuZ2V0U291bmQoJ3NwbGF0dGVyJykKICAgICAgICBzZWxmLmFjdGl2YXRlU291bmQgPSBicy5nZXRTb3VuZCgnYWN0aXZhdGVCZWVwJykKICAgICAgICBzZWxmLndhcm5Tb3VuZCA9IGJzLmdldFNvdW5kKCd3YXJuQmVlcCcpCgogICAgICAgICMgc2V0IHVwIG91ciBtYXRlcmlhbCBzbyBuZXcgYm9tYnMgZG9udCBjb2xsaWRlIHdpdGggb2JqZWN0cwogICAgICAgICMgdGhhdCB0aGV5IGFyZSBpbml0aWFsbHkgb3ZlcmxhcHBpbmcKICAgICAgICBzZWxmLmJvbWJNYXRlcmlhbCA9IGJzLk1hdGVyaWFsKCkKICAgICAgICBzZWxmLm5vcm1hbFNvdW5kTWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5zdGlja3lNYXRlcmlhbCA9IGJzLk1hdGVyaWFsKCkKICAgICAgICBzZWxmLnN0aWNreUljZU1hdGVyaWFsID0gYnMuTWF0ZXJpYWwoKQoKICAgICAgICBzZWxmLmJvbWJNYXRlcmlhbC5hZGRBY3Rpb25zKAogICAgICAgICAgICBjb25kaXRpb25zPSgoKCd3ZUFyZVlvdW5nZXJUaGFuJywxMDApLAogICAgICAgICAgICAgICAgICAgICAgICAgJ29yJywoJ3RoZXlBcmVZb3VuZ2VyVGhhbicsMTAwKSksCiAgICAgICAgICAgICAgICAgICAgICAgICdhbmQnLCgndGhleUhhdmVNYXRlcmlhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpKSwKICAgICAgICAgICAgYWN0aW9ucz0oKCdtb2RpZnlOb2RlQ29sbGlzaW9uJywnY29sbGlkZScsRmFsc2UpKSkKCiAgICAgICAgIyB3ZSB3YW50IHBpY2t1cCBtYXRlcmlhbHMgdG8gYWx3YXlzIGhpdCB1cyBldmVuIGlmIHdlJ3JlIGN1cnJlbnRseSBub3QKICAgICAgICAjIGNvbGxpZGluZyB3aXRoIHRoZWlyIG5vZGUgKGdlbmVyYWxseSBkdWUgdG8gdGhlIGFib3ZlIHJ1bGUpCiAgICAgICAgc2VsZi5ib21iTWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgY29uZGl0aW9ucz0oJ3RoZXlIYXZlTWF0ZXJpYWwnLAogICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ3BpY2t1cE1hdGVyaWFsJykpLAogICAgICAgICAgICBhY3Rpb25zPSgoJ21vZGlmeVBhcnRDb2xsaXNpb24nLCd1c2VOb2RlQ29sbGlkZScsIEZhbHNlKSkpCiAgICAgICAgCiAgICAgICAgc2VsZi5ib21iTWF0ZXJpYWwuYWRkQWN0aW9ucyhhY3Rpb25zPSgnbW9kaWZ5UGFydENvbGxpc2lvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZnJpY3Rpb24nLCAwLjMpKQoKICAgICAgICBzZWxmLmxhbmRNaW5lTm9FeHBsb2RlTWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5sYW5kTWluZUJsYXN0TWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5sYW5kTWluZUJsYXN0TWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgY29uZGl0aW9ucz0oCiAgICAgICAgICAgICAgICAoJ3dlQXJlT2xkZXJUaGFuJywyMDApLAogICAgICAgICAgICAgICAgICdhbmQnLCAoJ3RoZXlBcmVPbGRlclRoYW4nLDIwMCksCiAgICAgICAgICAgICAgICAgJ2FuZCcsICgnZXZhbENvbGxpZGluZycsKSwKICAgICAgICAgICAgICAgICAnYW5kJywgKCgndGhleURvbnRIYXZlTWF0ZXJpYWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGFuZE1pbmVOb0V4cGxvZGVNYXRlcmlhbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAnYW5kJywgKCgndGhleUhhdmVNYXRlcmlhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3InLCgndGhleUhhdmVNYXRlcmlhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgncGxheWVyTWF0ZXJpYWwnKSkpKSksCiAgICAgICAgICAgIGFjdGlvbnM9KCgnbWVzc2FnZScsICdvdXJOb2RlJywgJ2F0Q29ubmVjdCcsIEltcGFjdE1lc3NhZ2UoKSkpKQogICAgICAgIAogICAgICAgIHNlbGYuaW1wYWN0Qmxhc3RNYXRlcmlhbCA9IGJzLk1hdGVyaWFsKCkKICAgICAgICBzZWxmLmltcGFjdEJsYXN0TWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgY29uZGl0aW9ucz0oKCd3ZUFyZU9sZGVyVGhhbicsIDIwMCksCiAgICAgICAgICAgICAgICAgICAgICAgICdhbmQnLCAoJ3RoZXlBcmVPbGRlclRoYW4nLDIwMCksCiAgICAgICAgICAgICAgICAgICAgICAgICdhbmQnLCAoJ2V2YWxDb2xsaWRpbmcnLCksCiAgICAgICAgICAgICAgICAgICAgICAgICdhbmQnLCAoKCd0aGV5SGF2ZU1hdGVyaWFsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdmb290aW5nTWF0ZXJpYWwnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3InLCgndGhleUhhdmVNYXRlcmlhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpKSksCiAgICAgICAgICAgIGFjdGlvbnM9KCgnbWVzc2FnZScsJ291ck5vZGUnLCdhdENvbm5lY3QnLEltcGFjdE1lc3NhZ2UoKSkpKQoKICAgICAgICBzZWxmLmJsYXN0TWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5ibGFzdE1hdGVyaWFsLmFkZEFjdGlvbnMoCiAgICAgICAgICAgIGNvbmRpdGlvbnM9KCgndGhleUhhdmVNYXRlcmlhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpKSwKICAgICAgICAgICAgYWN0aW9ucz0oKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywnY29sbGlkZScsVHJ1ZSksCiAgICAgICAgICAgICAgICAgICAgICgnbW9kaWZ5UGFydENvbGxpc2lvbicsJ3BoeXNpY2FsJyxGYWxzZSksCiAgICAgICAgICAgICAgICAgICAgICgnbWVzc2FnZScsJ291ck5vZGUnLCdhdENvbm5lY3QnLEV4cGxvZGVIaXRNZXNzYWdlKCkpKSkKCiAgICAgICAgc2VsZi5kaXJ0TWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5kaXJ0TWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgY29uZGl0aW9ucz0oKCd0aGV5SGF2ZU1hdGVyaWFsJywKICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSkpLAogICAgICAgICAgICBhY3Rpb25zPSgoJ21vZGlmeVBhcnRDb2xsaXNpb24nLCdjb2xsaWRlJyxUcnVlKSwKICAgICAgICAgICAgICAgICAgICAgKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywncGh5c2ljYWwnLEZhbHNlKSwKICAgICAgICAgICAgICAgICAgICAgKCdtZXNzYWdlJywnb3VyTm9kZScsJ2F0RGlzY29ubmVjdCcsIERpcnRCb21iT3V0TWVzc2FnZSgpKSwKICAgICAgICAgICAgICAgICAgICAgKCdtZXNzYWdlJywnb3VyTm9kZScsJ2F0Q29ubmVjdCcsRXhwbG9kZUhpdE1lc3NhZ2UoKSkpKQoKICAgICAgICBzZWxmLmRpbmtTb3VuZHMgPSAoYnMuZ2V0U291bmQoJ2JvbWJEcm9wMDEnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U291bmQoJ2JvbWJEcm9wMDInKSkKICAgICAgICBzZWxmLnN0aWNreUltcGFjdFNvdW5kID0gYnMuZ2V0U291bmQoJ3N0aWNreUltcGFjdCcpCiAgICAgICAgc2VsZi5zdGlja3lJY2VJbXBhY3RTb3VuZCA9IGJzLmdldFNvdW5kKCdzdGlja3lJbXBhY3QnKQogICAgICAgIHNlbGYucm9sbFNvdW5kID0gYnMuZ2V0U291bmQoJ2JvbWJSb2xsMDEnKQoKICAgICAgICAjIGNvbGxpc2lvbiBzb3VuZHMKICAgICAgICBzZWxmLm5vcm1hbFNvdW5kTWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgY29uZGl0aW9ucz0oJ3RoZXlIYXZlTWF0ZXJpYWwnLAogICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ2Zvb3RpbmdNYXRlcmlhbCcpKSwKICAgICAgICAgICAgYWN0aW9ucz0oKCdpbXBhY3RTb3VuZCcsc2VsZi5kaW5rU291bmRzLDIsMC44KSwKICAgICAgICAgICAgICAgICAgICAgKCdyb2xsU291bmQnLHNlbGYucm9sbFNvdW5kLDMsNikpKQoKICAgICAgICBzZWxmLnN0aWNreU1hdGVyaWFsLmFkZEFjdGlvbnMoCiAgICAgICAgICAgIGFjdGlvbnM9KCgnbW9kaWZ5UGFydENvbGxpc2lvbicsJ3N0aWZmbmVzcycsMC4xKSwKICAgICAgICAgICAgICAgICAgICAgKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywnZGFtcGluZycsMS4wKSkpCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHNlbGYuc3RpY2t5SWNlTWF0ZXJpYWwuYWRkQWN0aW9ucygKICAgICAgICAgICAgYWN0aW9ucz0oKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywnc3RpZmZuZXNzJywwLjIpLAogICAgICAgICAgICAgICAgICAgICAoJ21vZGlmeVBhcnRDb2xsaXNpb24nLCdkYW1waW5nJywxLjIpKSkKCiAgICAgICAgc2VsZi5zdGlja3lNYXRlcmlhbC5hZGRBY3Rpb25zKAogICAgICAgICAgICBjb25kaXRpb25zPSgoJ3RoZXlIYXZlTWF0ZXJpYWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdwbGF5ZXJNYXRlcmlhbCcpKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ29yJywgKCd0aGV5SGF2ZU1hdGVyaWFsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnZm9vdGluZ01hdGVyaWFsJykpKSwKICAgICAgICAgICAgYWN0aW9ucz0oKCdtZXNzYWdlJywnb3VyTm9kZScsJ2F0Q29ubmVjdCcsU3BsYXRNZXNzYWdlKCkpKSkKICAgICAgICAgICAgCiAgICAgICAgc2VsZi5zdGlja3lJY2VNYXRlcmlhbC5hZGRBY3Rpb25zKAogICAgICAgICAgICBjb25kaXRpb25zPSgoJ3RoZXlIYXZlTWF0ZXJpYWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdwbGF5ZXJNYXRlcmlhbCcpKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ29yJywgKCd0aGV5SGF2ZU1hdGVyaWFsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnZm9vdGluZ01hdGVyaWFsJykpKSwKICAgICAgICAgICAgYWN0aW9ucz0oKCdtZXNzYWdlJywnb3VyTm9kZScsJ2F0Q29ubmVjdCcsU3BsYXRNZXNzYWdlKCkpKSkKCmNsYXNzIEJsYXN0KGJzLkFjdG9yKToKICAgICIiIgogICAgY2F0ZWdvcnk6IEdhbWUgRmxvdyBDbGFzc2VzCgogICAgQW4gZXhwbG9zaW9uLCBhcyBnZW5lcmF0ZWQgYnkgYSBicy5Cb21iLgogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgcG9zaXRpb249KDAsMSwwKSwgdmVsb2NpdHk9KDAsMCwwKSwgYmxhc3RSYWRpdXM9Mi4wLAogICAgICAgICAgICAgICAgIGJsYXN0VHlwZT0ibm9ybWFsIiwgc291cmNlUGxheWVyPU5vbmUsIGhpdFR5cGU9J2V4cGxvc2lvbicsCiAgICAgICAgICAgICAgICAgaGl0U3ViVHlwZT0nbm9ybWFsJyk6CiAgICAgICAgICAgICAgICAKICAgICAgICAiIiIKICAgICAgICBJbnN0YW50aWF0ZSB3aXRoIGdpdmVuIHZhbHVlcy4KICAgICAgICAiIiIKICAgICAgICBicy5BY3Rvci5fX2luaXRfXyhzZWxmKQogICAgICAgIAogICAgICAgIGZhY3RvcnkgPSBCb21iLmdldEZhY3RvcnkoKQoKICAgICAgICBzZWxmLmJsYXN0VHlwZSA9IGJsYXN0VHlwZQogICAgICAgIHNlbGYuc291cmNlUGxheWVyID0gc291cmNlUGxheWVyCgogICAgICAgIHNlbGYuaGl0VHlwZSA9IGhpdFR5cGU7CiAgICAgICAgc2VsZi5oaXRTdWJUeXBlID0gaGl0U3ViVHlwZTsKCiAgICAgICAgIyBibGFzdCByYWRpdXMKICAgICAgICBzZWxmLnJhZGl1cyA9IGJsYXN0UmFkaXVzCgogICAgICAgICMgc2V0IG91ciBwb3NpdGlvbiBhIGJpdCBsb3dlciBzbyB3ZSB0aHJvdyBtb3JlIHRoaW5ncyB1cHdhcmQKICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdyZWdpb24nLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICdwb3NpdGlvbic6KHBvc2l0aW9uWzBdLCBwb3NpdGlvblsxXS0wLjEsIHBvc2l0aW9uWzJdKSwKICAgICAgICAgICAgJ3NjYWxlJzooc2VsZi5yYWRpdXMsc2VsZi5yYWRpdXMsc2VsZi5yYWRpdXMpLAogICAgICAgICAgICAndHlwZSc6J3NwaGVyZScsCiAgICAgICAgICAgICdtYXRlcmlhbHMnOihmYWN0b3J5LmJsYXN0TWF0ZXJpYWwgaWYgc2VsZi5ibGFzdFR5cGUgbm90IGluIFsnZGlydCddIGVsc2UgZmFjdG9yeS5kaXJ0TWF0ZXJpYWwsIGJzLmdldFNoYXJlZE9iamVjdCgnYXR0YWNrTWF0ZXJpYWwnKSl9KQoKICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZGlydCc6IAogICAgICAgICAgICBkZWYgYSgpOgogICAgICAgICAgICAgICAgZm9yIGkgaW4gZ2V0YXR0cihzZWxmLCAnZGlydF9ub2RlcycsIFtdKToKICAgICAgICAgICAgICAgICAgICBpZiBpLmV4aXN0cygpOiBpLmhhbmRsZU1lc3NhZ2UoRGlydEJvbWJPdXRNZXNzYWdlKCkpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZGVsZXRlKCkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDcwMDAsIGJzLkNhbGwoYSkpCiAgICAgICAgZWxzZTogYnMuZ2FtZVRpbWVyKDEwLCBzZWxmLm5vZGUuZGVsZXRlKQoKICAgICAgICAjIHRocm93IGluIGFuIGV4cGxvc2lvbiBhbmQgZmxhc2gKICAgICAgICBleHBsb3Npb24gPSBicy5uZXdOb2RlKCJleHBsb3Npb24iLCBhdHRycz17CiAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICd2ZWxvY2l0eSc6KHZlbG9jaXR5WzBdLG1heCgtMS4wLHZlbG9jaXR5WzFdKSx2ZWxvY2l0eVsyXSksCiAgICAgICAgICAgICdyYWRpdXMnOnNlbGYucmFkaXVzIGlmIHNlbGYuYmxhc3RUeXBlICE9ICdxcScgZWxzZSAwLjgsCiAgICAgICAgICAgICdiaWcnOihzZWxmLmJsYXN0VHlwZSA9PSAndG50Jyl9KQogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICJpY2UiIG9yIHNlbGYuYmxhc3RUeXBlID09ICJpY2VJbXBhY3QiIG9yIHNlbGYuYmxhc3RUeXBlID09ICJzdGlja3lJY2UiOiAjIElmIHdlIGFyZSBpY2Ugb3IgaWNlSW1wYWN0IGJvbWIsCiAgICAgICAgICAgIGV4cGxvc2lvbi5jb2xvciA9ICgwLCAwLjA1LCAwLjQpCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAiQmxvY2siOgogICAgICAgICAgICBleHBsb3Npb24uY29sb3IgPSAoMCwgMC41LCAwLjUpICMgSWYgd2UgYXJlICdCbG9jaycgbWFrZQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3NwYXpCb21iJzoKICAgICAgICAgICAgZXhwbG9zaW9uLmNvbG9yID0gKDEsMSwxKQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gImZpcmV3b3JrIjoKICAgICAgICAgICAgZXhwbG9zaW9uLmNvbG9yID0gKDAuNiwgMSwgMSkKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJraWxsTGFLaWxsIjoKICAgICAgICAgICAgZXhwbG9zaW9uLmNvbG9yID0gKDAuMywgMC4zLCAwLjMpCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAiYm9zcyI6CiAgICAgICAgICAgIGV4cGxvc2lvbi5jb2xvciA9ICgxLjEsIDEuMSwgMSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBleHBsb3Npb24uY29sb3IgPSAoMSwwLjgsMCkKICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSAhPSAnYm9zcyc6CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAwLCBleHBsb3Npb24uZGVsZXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MDAsIGV4cGxvc2lvbi5kZWxldGUpCgogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlICE9ICdpY2UnIGFuZCBzZWxmLmJsYXN0VHlwZSAhPSAnaWNlSW1wYWN0JyBhbmQgc2VsZi5ibGFzdFR5cGUgIT0gJ3N0aWNreUljZSc6CiAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDEuMCtyYW5kb20ucmFuZG9tKCkqNCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSd0ZW5kcmlscycsdGVuZHJpbFR5cGU9J3RoaW5TbW9rZScpCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAna2lsbExhS2lsbCc6CiAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKAogICAgICAgICAgICAgICAgcG9zaXRpb249cG9zaXRpb24sIGVtaXRUeXBlPSdkaXN0b3J0aW9uJywKICAgICAgICAgICAgICAgIHNwcmVhZD01NTAuMCkKICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MoCiAgICAgICAgICAgICAgICBwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo0MCksIGVtaXRUeXBlPSd0ZW5kcmlscycsCiAgICAgICAgICAgICAgICB0ZW5kcmlsVHlwZT0naWNlJyBpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaWNlJyBlbHNlICdzbW9rZScpCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgIT0gJ3FxJzoKICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MoCiAgICAgICAgICAgICAgICBwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo0KSwgZW1pdFR5cGU9J3RlbmRyaWxzJywKICAgICAgICAgICAgICAgIHRlbmRyaWxUeXBlPSdpY2UnIGlmIHNlbGYuYmxhc3RUeXBlID09ICdpY2UnIGVsc2UgJ3Ntb2tlJykKICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MoCiAgICAgICAgICAgICAgICBwb3NpdGlvbj1wb3NpdGlvbiwgZW1pdFR5cGU9J2Rpc3RvcnRpb24nLAogICAgICAgICAgICAgICAgc3ByZWFkPTEuMCBpZiBzZWxmLmJsYXN0VHlwZSA9PSAndG50JyBlbHNlIDIuMCkKICAgICAgICAKICAgICAgICAjIGFuZCBlbWl0IHNvbWUgc2hyYXBuZWwuLgogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICdpY2UnIG9yIHNlbGYuYmxhc3RUeXBlID09ICdpY2VJbXBhY3QnIG9yIHNlbGYuYmxhc3RUeXBlID09ICdzdGlja3lJY2UnOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MzAsIHNwcmVhZD0yLjAsIHNjYWxlPTAuNCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0naWNlJywgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCwgX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3BvaXNvbic6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0zMCwgc3ByZWFkPTIuMCwgc2NhbGU9MC40LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdyb2NrJywgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCwgX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZmlyZXdvcmsnOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PSgxLjEgKyByYW5kb20ucmFuZG9tKCksIDEuOCArIHJhbmRvbS5yYW5kb20oKSwgMS4xICsgcmFuZG9tLnJhbmRvbSgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ID0gMzYwICsgcmFuZG9tLnJhbmRyYW5nZSgwLDQwKSwgc3ByZWFkPTAuOCwgc2NhbGU9MC43LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlID0gJ3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig0NSwgX2RvRW1pdCkgCgogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2tpbGxMYUtpbGwnOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MTUsIHNjYWxlPTAuNiwgY2h1bmtUeXBlPSdtZXRhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0wLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNi4wK3JhbmRvbS5yYW5kb20oKSoxMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgICAgICAKCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAndXNlJzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NsaW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdCAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdzcGF6Qm9tYic6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9Mi44LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdtZXRhbCcpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTIuNCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0nbWV0YWwnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0yLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoOC4wK3JhbmRvbS5yYW5kb20oKSoxNSksIHNjYWxlPTIuOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0yNS41LCBjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KQogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdzdGlja3lJY2VUcmlvJzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdjdXJzZUJvbWInOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTE1LCBzY2FsZT0wLjYsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0yMCwgc2NhbGU9MC43LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDYuMCtyYW5kb20ucmFuZG9tKCkqMTIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC44LCBzcHJlYWQ9MS41LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0CiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2NoYXJhY3RlckJvbWInOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTE1LCBzY2FsZT0wLjYsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0yMCwgc2NhbGU9MC43LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDYuMCtyYW5kb20ucmFuZG9tKCkqMTIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC44LCBzcHJlYWQ9MS41LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0CiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ21qQm9tYic6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MTUsIHNjYWxlPTAuNiwgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0wLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNi4wK3JhbmRvbS5yYW5kb20oKSoxMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaWN5VHJpbyc6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MTUsIHNjYWxlPTAuNiwgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0wLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNi4wK3JhbmRvbS5yYW5kb20oKSoxMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnYm9vbUJvbWInOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTE1LCBzY2FsZT0wLjYsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0yMCwgc2NhbGU9MC43LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDYuMCtyYW5kb20ucmFuZG9tKCkqMTIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC44LCBzcHJlYWQ9MS41LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0CiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RyaW9Cb21iJzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAoKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdzcGVlZEJvbWInOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTE1LCBzY2FsZT0wLjYsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0yMCwgc2NhbGU9MC43LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDYuMCtyYW5kb20ucmFuZG9tKCkqMTIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC44LCBzcHJlYWQ9MS41LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0CiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2hlYWxCb21iJzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdrbm9ja0JvbWInOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTE1LCBzY2FsZT0wLjYsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0yMCwgc2NhbGU9MC43LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDYuMCtyYW5kb20ucmFuZG9tKCkqMTIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC44LCBzcHJlYWQ9MS41LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0CiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ25pZ2h0Qm9tYic6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MTUsIHNjYWxlPTAuNiwgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0wLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNi4wK3JhbmRvbS5yYW5kb20oKSoxMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnYmxhc3RCb21iJzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdyZXZlbmdlQm9tYic6CiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MTUsIHNjYWxlPTAuNiwgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTIwLCBzY2FsZT0wLjcsIGNodW5rVHlwZT0nc3BhcmsnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNi4wK3JhbmRvbS5yYW5kb20oKSoxMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnc3RpY2t5JzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0xNSwgc2NhbGU9MC42LCBjaHVua1R5cGU9J3NsaW1lJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg2LjArcmFuZG9tLnJhbmRvbSgpKjEyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuNSxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAoKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdkaXJ0JzoKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NsaW1lJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KQogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICd0Ym9tYic6ICMgcmVndWxhciBib21iIHNocmFwbmVsCiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD0wLCBzY2FsZT0wLjgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdCAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnQmxvY2snOgogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksIHNjYWxlPTAuOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0nbWV0YWwnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J21ldGFsJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC44LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdtZXRhbCcpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZ2x1ZWJvbWInOiAjIHJlZ3VsYXIgYm9tYiBzaHJhcG5lbAogICAgICAgICAgICBkZWYgX2RvRW1pdCgpOgogICAgICAgICAgICAgICAgZyA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17J3Bvc2l0aW9uJzoocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMyxwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSozKSwndmVsb2NpdHknOigwLDAsMCksJ2JvZHknOidzcGhlcmUnLCdtb2RlbCc6J3h4eHgnLCdzaGFkb3dTaXplJzowLjMsJ3N0aWNreSc6VHJ1ZSwnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmltcGFjdFRleCwnYm9keVNjYWxlJzoxLjUsJ21hdGVyaWFscyc6KGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSl9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDY1MDAsZy5kZWxldGUpCiAgICAgICAgICAgICAgICBnID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsncG9zaXRpb24nOihwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSozLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjMpLCd2ZWxvY2l0eSc6KDAsMCwwKSwnYm9keSc6J3NwaGVyZScsJ21vZGVsJzoneHh4eCcsJ3NoYWRvd1NpemUnOjAuMywnc3RpY2t5JzpUcnVlLCdjb2xvclRleHR1cmUnOmZhY3RvcnkuaW1wYWN0VGV4LCdib2R5U2NhbGUnOjEuNSwnbWF0ZXJpYWxzJzooYnMuZ2V0U2hhcmVkT2JqZWN0KCdvYmplY3RNYXRlcmlhbCcpKX0pCiAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNjUwMCxnLmRlbGV0ZSkKICAgICAgICAgICAgICAgIGcgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9eydwb3NpdGlvbic6KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjMscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMyksJ3ZlbG9jaXR5JzooMCwwLDApLCdib2R5Jzonc3BoZXJlJywnbW9kZWwnOid4eHh4Jywnc2hhZG93U2l6ZSc6MC4zLCdzdGlja3knOlRydWUsJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5pbXBhY3RUZXgsJ2JvZHlTY2FsZSc6MS41LCdtYXRlcmlhbHMnOihicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpfSkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig2NTAwLGcuZGVsZXRlKQogICAgICAgICAgICAgICAgZyA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17J3Bvc2l0aW9uJzoocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMyxwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSozKSwndmVsb2NpdHknOigwLDAsMCksJ2JvZHknOidzcGhlcmUnLCdtb2RlbCc6J3h4eHgnLCdzaGFkb3dTaXplJzowLjMsJ3N0aWNreSc6VHJ1ZSwnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmltcGFjdFRleCwnYm9keVNjYWxlJzoxLjUsJ21hdGVyaWFscyc6KGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSl9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDY1MDAsZy5kZWxldGUpCiAgICAgICAgICAgICAgICBnID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsncG9zaXRpb24nOihwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSozLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjMpLCd2ZWxvY2l0eSc6KDAsMCwwKSwnYm9keSc6J3NwaGVyZScsJ21vZGVsJzoneHh4eCcsJ3NoYWRvd1NpemUnOjAuMywnc3RpY2t5JzpUcnVlLCdjb2xvclRleHR1cmUnOmZhY3RvcnkuaW1wYWN0VGV4LCdib2R5U2NhbGUnOjEuNSwnbWF0ZXJpYWxzJzooYnMuZ2V0U2hhcmVkT2JqZWN0KCdvYmplY3RNYXRlcmlhbCcpKX0pCiAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNjUwMCxnLmRlbGV0ZSkKICAgICAgICAgICAgICAgIGcgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9eydwb3NpdGlvbic6KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjMscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMyksJ3ZlbG9jaXR5JzooMCwwLDApLCdib2R5Jzonc3BoZXJlJywnbW9kZWwnOid4eHh4Jywnc2hhZG93U2l6ZSc6MC4zLCdzdGlja3knOlRydWUsJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5pbXBhY3RUZXgsJ2JvZHlTY2FsZSc6MS41LCdtYXRlcmlhbHMnOihicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpfSkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig2NTAwLGcuZGVsZXRlKQogICAgICAgICAgICAgICAgZyA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17J3Bvc2l0aW9uJzoocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMyxwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSozKSwndmVsb2NpdHknOigwLDAsMCksJ2JvZHknOidzcGhlcmUnLCdtb2RlbCc6J3h4eHgnLCdzaGFkb3dTaXplJzowLjMsJ3N0aWNreSc6VHJ1ZSwnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmltcGFjdFRleCwnYm9keVNjYWxlJzoxLjUsJ21hdGVyaWFscyc6KGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSl9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDY1MDAsZy5kZWxldGUpCiAgICAgICAgICAgICAgICBnID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsncG9zaXRpb24nOihwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSozLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjMpLCd2ZWxvY2l0eSc6KDAsMCwwKSwnYm9keSc6J3NwaGVyZScsJ21vZGVsJzoneHh4eCcsJ3NoYWRvd1NpemUnOjAuMywnc3RpY2t5JzpUcnVlLCdjb2xvclRleHR1cmUnOmZhY3RvcnkuaW1wYWN0VGV4LCdib2R5U2NhbGUnOjEuNSwnbWF0ZXJpYWxzJzooYnMuZ2V0U2hhcmVkT2JqZWN0KCdvYmplY3RNYXRlcmlhbCcpKX0pCiAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNjUwMCxnLmRlbGV0ZSkKICAgICAgICAgICAgICAgIGcgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9eydwb3NpdGlvbic6KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjMscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMyksJ3ZlbG9jaXR5JzooMCwwLDApLCdib2R5Jzonc3BoZXJlJywnbW9kZWwnOid4eHh4Jywnc2hhZG93U2l6ZSc6MC4zLCdzdGlja3knOlRydWUsJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5pbXBhY3RUZXgsJ2JvZHlTY2FsZSc6MS41LCdtYXRlcmlhbHMnOihicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpfSkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig2NTAwLGcuZGVsZXRlKQogICAgICAgICAgICAgICAgZyA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17J3Bvc2l0aW9uJzoocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMyxwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSozKSwndmVsb2NpdHknOigwLDAsMCksJ2JvZHknOidzcGhlcmUnLCdtb2RlbCc6J3h4eHgnLCdzaGFkb3dTaXplJzowLjMsJ3N0aWNreSc6VHJ1ZSwnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmltcGFjdFRleCwnYm9keVNjYWxlJzoxLjUsJ21hdGVyaWFscyc6KGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSl9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDY1MDAsZy5kZWxldGUpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj0ocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMiksdmVsb2NpdHk9KDAsMCwwKSxjb3VudD01LHNjYWxlPTcuNSxjaHVua1R5cGU9J3NsaW1lJyxlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPShwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSxwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSoyKSx2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTUsc2NhbGU9Ny41LGNodW5rVHlwZT0nc2xpbWUnLGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjIpLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NSxzY2FsZT03LjUsY2h1bmtUeXBlPSdzbGltZScsZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj0ocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMiksdmVsb2NpdHk9KDAsMCwwKSxjb3VudD01LHNjYWxlPTcuNSxjaHVua1R5cGU9J3NsaW1lJyxlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPShwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSxwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSoyKSx2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTUsc2NhbGU9Ny41LGNodW5rVHlwZT0nc2xpbWUnLGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjIpLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NSxzY2FsZT03LjUsY2h1bmtUeXBlPSdzbGltZScsZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj0ocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMiksdmVsb2NpdHk9KDAsMCwwKSxjb3VudD01LHNjYWxlPTcuNSxjaHVua1R5cGU9J3NsaW1lJyxlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPShwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSxwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSoyKSx2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTUsc2NhbGU9Ny41LGNodW5rVHlwZT0nc2xpbWUnLGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjIpLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NSxzY2FsZT03LjUsY2h1bmtUeXBlPSdzbGltZScsZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj0ocG9zaXRpb25bMF0tMStyYW5kb20ucmFuZG9tKCkqMixwb3NpdGlvblsxXStyYW5kb20ucmFuZG9tKCkscG9zaXRpb25bMl0tMStyYW5kb20ucmFuZG9tKCkqMiksdmVsb2NpdHk9KDAsMCwwKSxjb3VudD01LHNjYWxlPTcuNSxjaHVua1R5cGU9J3NsaW1lJyxlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPShwb3NpdGlvblswXS0xK3JhbmRvbS5yYW5kb20oKSoyLHBvc2l0aW9uWzFdK3JhbmRvbS5yYW5kb20oKSxwb3NpdGlvblsyXS0xK3JhbmRvbS5yYW5kb20oKSoyKSx2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTUsc2NhbGU9Ny41LGNodW5rVHlwZT0nc2xpbWUnLGVtaXRUeXBlPSdzdGlja2VycycpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249KHBvc2l0aW9uWzBdLTErcmFuZG9tLnJhbmRvbSgpKjIscG9zaXRpb25bMV0rcmFuZG9tLnJhbmRvbSgpLHBvc2l0aW9uWzJdLTErcmFuZG9tLnJhbmRvbSgpKjIpLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NSxzY2FsZT03LjUsY2h1bmtUeXBlPSdzbGltZScsZW1pdFR5cGU9J3N0aWNrZXJzJyk7CiAgICAgICAgICAgICAgICAjYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sZW1pdFR5cGU9J2Rpc3RvcnRpb24nLHNwcmVhZD02LGNvdW50ID0gMTAwKTsKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwLF9kb0VtaXQpICMgbG9va3MgYmV0dGVyIGlmIHdlIGRlbGF5IGEgYml0ICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3dlZWRib21iJzogIyByZWd1bGFyIGJvbWIgc2hyYXBuZWwKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J3N3ZWF0Jyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC44LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdzd2VhdCcpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaW1wYWN0JzogIyByZWd1bGFyIGJvbWIgc2hyYXBuZWwKICAgICAgICAgICAgZGVmIF9kb0VtaXQoKToKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLCBzY2FsZT0wLjgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J21ldGFsJyk7CiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoNC4wK3JhbmRvbS5yYW5kb20oKSo4KSwgc2NhbGU9MC40LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdtZXRhbCcpOwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9MjAsIHNjYWxlPTAuNywgY2h1bmtUeXBlPSdzcGFyaycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg4LjArcmFuZG9tLnJhbmRvbSgpKjE1KSwgc2NhbGU9MC44LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTEuNSwgY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAsX2RvRW1pdCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICAgICAgZWxzZTogIyByZWd1bGFyIG9yIGxhbmQgbWluZSBib21iIHNocmFwbmVsCiAgICAgICAgICAgIGRlZiBfZG9FbWl0KCk6CiAgICAgICAgICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSAhPSAndG50JzoKICAgICAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KDQuMCtyYW5kb20ucmFuZG9tKCkqOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdyb2NrJyk7CiAgICAgICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCg0LjArcmFuZG9tLnJhbmRvbSgpKjgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuNSxjaHVua1R5cGU9J3JvY2snKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PTMwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MS4wIGlmIHNlbGYuYmxhc3RUeXBlPT0ndG50JyBlbHNlIDAuNywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0nc3BhcmsnLCBlbWl0VHlwZT0nc3RpY2tlcnMnKTsKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXBvc2l0aW9uLCB2ZWxvY2l0eT12ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCgxOC4wK3JhbmRvbS5yYW5kb20oKSoyMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0xLjAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RudCcgZWxzZSAwLjgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9MS41LCBjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyB0bnQgdGhyb3dzIHNwbGludGVyeSBjaHVua3MKICAgICAgICAgICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICd0bnQnOgogICAgICAgICAgICAgICAgICAgIGRlZiBfZW1pdFNwbGludGVycygpOgogICAgICAgICAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1wb3NpdGlvbiwgdmVsb2NpdHk9dmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludCgyMC4wK3JhbmRvbS5yYW5kb20oKSoyNSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOCwgc3ByZWFkPTEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2h1bmtUeXBlPSdzcGxpbnRlcicpOwogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMCxfZW1pdFNwbGludGVycykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBldmVyeSBub3cgYW5kIHRoZW4gZG8gYSBzcGFya3kgb25lCiAgICAgICAgICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAndG50JyBvciByYW5kb20ucmFuZG9tKCkgPCAwLjE6CiAgICAgICAgICAgICAgICAgICAgZGVmIF9lbWl0RXh0cmFTcGFya3MoKToKICAgICAgICAgICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249cG9zaXRpb24sIHZlbG9jaXR5PXZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1pbnQoMTAuMCtyYW5kb20ucmFuZG9tKCkqMjApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjgsIHNwcmVhZD0xLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoMjAsX2VtaXRFeHRyYVNwYXJrcykKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCxfZG9FbWl0KSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAoKICAgICAgICBsaWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0JywgYXR0cnM9ewogICAgICAgICAgICAncG9zaXRpb24nOiBwb3NpdGlvbiwKICAgICAgICAgICAgJ3ZvbHVtZUludGVuc2l0eVNjYWxlJzogMTAuMCwKICAgICAgICAgICAgJ2NvbG9yJzogKCgwLjYsIDAuNiwgMS4wKSBpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaWNlJyBvciBzZWxmLmJsYXN0VHlwZSA9PSAnaWNlSW1wYWN0JyBvciBzZWxmLmJsYXN0VHlwZSA9PSAnc3RpY2t5SWNlJwogICAgICAgICAgICAgICAgICAgICAgZWxzZSAoMCw1LDApIGlmIHNlbGYuYmxhc3RUeXBlID09ICdCbG9jaycKICAgICAgICAgICAgICAgICAgICAgIGVsc2UgKDEsIDAuMywgMC4xKSl9KQoKICAgICAgICBzID0gcmFuZG9tLnVuaWZvcm0oMC42LDAuOSkKICAgICAgICBzY29yY2hSYWRpdXMgPSBsaWdodFJhZGl1cyA9IHNlbGYucmFkaXVzCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RudCc6CiAgICAgICAgICAgIGxpZ2h0UmFkaXVzICo9IDEuNAogICAgICAgICAgICBzY29yY2hSYWRpdXMgKj0gMS4xNQogICAgICAgICAgICBzICo9IDMuMAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3FxJzoKICAgICAgICAgICAgc2NvcmNoUmFkaXVzICo9IDAuNQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2Jvc3MnOgogICAgICAgICAgICBzY29yY2hSYWRpdXMgPSAwCiAgICAgICAgICAgIGxpZ2h0UmFkaXVzID0gMC4zNQoKICAgICAgICBpU2NhbGUgPSAxLjYKICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSBub3QgaW4gWydmaXJld29yaycsICdxcSddOgogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUobGlnaHQsImludGVuc2l0eSIsIHsKICAgICAgICAgICAgICAgIDA6MCwgMTA6MC41LCAyMDoxLjAsIDIwMDA6MC41LCAyNzUwOjB9KQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUobGlnaHQsInJhZGl1cyIsIHsKICAgICAgICAgICAgICAgIDA6MCwgMTA6MC41LCAyMDoxLjAsIDIwMDA6MC41LCAyNzUwOjB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjc1MCxsaWdodC5kZWxldGUpCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3FxJzoKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKGxpZ2h0LCJpbnRlbnNpdHkiLCB7CiAgICAgICAgICAgICAgICAwOjAsIDEwOjAuNSwgMjA6MC41NSwgNzAwOjEsIDkwMDowfSkKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKGxpZ2h0LCJyYWRpdXMiLCB7CiAgICAgICAgICAgICAgICAwOjAsIDEwOjAuNSwgMjA6MC41NSwgNzAwOjAuNiwgOTAwOjB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoOTAwLGxpZ2h0LmRlbGV0ZSkKICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZmlyZXdvcmsnOgogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUobGlnaHQsImludGVuc2l0eSIsIHsKICAgICAgICAgICAgICAgIDA6MCwgMTA6MC41LCAyMDoxLjAsIDEyMDA6MC41LCA0MDAwOjB9KQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUobGlnaHQsInJhZGl1cyIsIHsKICAgICAgICAgICAgICAgIDA6MCwgMTA6MC41LCAyMDoxLjAsIDEyMDA6MC41LCA0MDAwOjB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoNDAwMCxsaWdodC5kZWxldGUpCgogICAgICAgICMgbWFrZSBhIHNjb3JjaCB0aGF0IGZhZGVzIG92ZXIgdGltZQogICAgICAgIHNjb3JjaCA9IGJzLm5ld05vZGUoJ3Njb3JjaCcsIGF0dHJzPXsKICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgJ3NpemUnOnNjb3JjaFJhZGl1cyowLjUgaWYgc2VsZi5ibGFzdFR5cGUgIT0gImRpcnQiIGVsc2Ugc2NvcmNoUmFkaXVzKjEuMiwKICAgICAgICAgICAgJ2JpZyc6KHNlbGYuYmxhc3RUeXBlIGluIFsnZGlydCcsJ3RudCddKX0pCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2ljZScgb3Igc2VsZi5ibGFzdFR5cGUgPT0gJ2ljZUltcGFjdCcgb3Igc2VsZi5ibGFzdFR5cGUgPT0gJ3N0aWNreUljZSc6CiAgICAgICAgICAgIHNjb3JjaC5jb2xvciA9ICgxLDEsMS41KQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ0Jsb2NrJzoKICAgICAgICAgICAgc2NvcmNoLmNvbG9yID0gKDAsIDUsIDApICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICd0Ym9tYic6CiAgICAgICAgICAgIHNjb3JjaC5jb2xvciA9ICgxLDEsMS41KSAgICAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdnbHVlYm9tYic6CiAgICAgICAgICAgIHNjb3JjaC5jb2xvciA9ICgwLDEsMCkgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnd2VlZGJvbWInOgogICAgICAgICAgICBzY29yY2guY29sb3IgPSAoLTMsMiwtMS41KSAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3NwYXpCb21iJzoKICAgICAgICAgICAgc2NvcmNoLmNvbG9yID0gKDEsMSwxKSAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2RpcnQnOgogICAgICAgICAgICBzY29yY2guY29sb3IgPSAoMC41LCAwLjEsIDAuMDIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2NvcmNoLmNvbG9yID0gKGxpZ2h0LmNvbG9yWzBdLTAuMDUsIGxpZ2h0LmNvbG9yWzFdLTAuMDUsIGxpZ2h0LmNvbG9yWzJdLTAuMDcpCgogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlIG5vdCBpbiBbJ2ZpcmV3b3JrJywgJ2RpcnQnXToKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKHNjb3JjaCwicHJlc2VuY2UiLHswOjAsIDYwOjAuNTUsIDIwMDA6MSwgNTAwMDowfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEzMDAwLHNjb3JjaC5kZWxldGUpCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSBpbiBbJ2RpcnQnXToKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKHNjb3JjaCwicHJlc2VuY2UiLHswOjAsIDYwOjAuNTUsIDIwMDA6MSwgNjcwMDoxLCA3MjUwOjB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoNzI1MCxzY29yY2guZGVsZXRlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJzVXRpbHMuYW5pbWF0ZShzY29yY2gsInByZXNlbmNlIix7MzAwMDoxLCAxMDAwMDoxLCAyNjAwMDowfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI2MDAwLHNjb3JjaC5kZWxldGUpCgogICAgICAgIHAgPSBsaWdodC5wb3NpdGlvbgogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICdpY2UnIG9yIHNlbGYuYmxhc3RUeXBlID09ICdpY2VJbXBhY3QnIG9yIHNlbGYuYmxhc3RUeXBlID09ICdzdGlja3lJY2UnOgogICAgICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5oaXNzU291bmQscG9zaXRpb249cCkKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnc3BhekJvbWInOgogICAgICAgICAgICBicy5wbGF5U291bmQoYnMuZ2V0U291bmQoJ3NwYXpGYWxsMDEnKSkKCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZmlyZXdvcmsnOgogICAgICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5oaXNzU291bmQscG9zaXRpb249cCkKCiAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAna2lsbExhS2lsbCc6CiAgICAgICAgICAgIGJzLnBsYXlTb3VuZChmYWN0b3J5LmdldFJhbmRvbUV4cGxvZGVTb3VuZCgpLHBvc2l0aW9uPXApCiAgICAgICAgZWxzZTogIAogICAgICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5nZXRSYW5kb21FeHBsb2RlU291bmQoKSxwb3NpdGlvbj1wKQogICAgICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5kZWJyaXNGYWxsU291bmQscG9zaXRpb249cCkKCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RudCc6CiAgICAgICAgICAgIGludGVuc2l0eT01LjAKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdraWxsTGFLaWxsJzoKICAgICAgICAgICAgaW50ZW5zaXR5PTYuMQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2ZpcmV3b3JrJzoKICAgICAgICAgICAgaW50ZW5zaXR5PTAuNQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3FxJzoKICAgICAgICAgICAgaW50ZW5zaXR5PTAuMzIKICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdib3NzJzoKICAgICAgICAgICAgaW50ZW5zaXR5PTAuMQogICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2RpcnQnOiAKICAgICAgICAgICAgaW50ZW5zaXR5PTAuMgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGludGVuc2l0eT0xLjAKCiAgICAgICAgYnMuc2hha2VDYW1lcmEoaW50ZW5zaXR5KQogICAgICAgIAogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICdub3JtYWwnOgogICAgICAgICAgICBpZiBkb24uYm9tYkJsYXN0OgogICAgICAgICAgICAgICAgZGVmIF9leHBsb2RlV2l0aFBvd2VydXAoKToKICAgICAgICAgICAgICAgICAgICBwVHlwZSA9IGJzLlBvd2VydXBGYWN0b3J5KCkuZ2V0UmFuZG9tUG93ZXJ1cFR5cGUoKQogICAgICAgICAgICAgICAgICAgIGJzLlBvd2VydXAocG9zaXRpb24scFR5cGUpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEwMCxfZXhwbG9kZVdpdGhQb3dlcnVwKSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAogICAgICAgICAgICAgICAgCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2Jsb2NrJzoKICAgICAgICAgICAgZGVmIF9leHBsb2RlV2l0aFBvd2VydXAoKToKICAgICAgICAgICAgICAgIHBUeXBlID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEwMCxfZXhwbG9kZVdpdGhQb3dlcnVwKSAjIGxvb2tzIGJldHRlciBpZiB3ZSBkZWxheSBhIGJpdAogICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlID09ICdnb2xkZW5Cb21iJzoKICAgICAgICAgICAgZGVmIF9leHBsb2RlV2l0aFBvd2VydXAoKToKICAgICAgICAgICAgICAgIHBUeXBlMSA9IGJzLlBvd2VydXBGYWN0b3J5KCkuZ2V0UmFuZG9tUG93ZXJ1cFR5cGUoKQogICAgICAgICAgICAgICAgcFR5cGUyID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICBwVHlwZTMgPSBicy5Qb3dlcnVwRmFjdG9yeSgpLmdldFJhbmRvbVBvd2VydXBUeXBlKCkKICAgICAgICAgICAgICAgIHBUeXBlNCA9IGJzLlBvd2VydXBGYWN0b3J5KCkuZ2V0UmFuZG9tUG93ZXJ1cFR5cGUoKQogICAgICAgICAgICAgICAgcFR5cGU1ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICBwVHlwZTYgPSBicy5Qb3dlcnVwRmFjdG9yeSgpLmdldFJhbmRvbVBvd2VydXBUeXBlKCkKICAgICAgICAgICAgICAgIHBUeXBlNyA9IGJzLlBvd2VydXBGYWN0b3J5KCkuZ2V0UmFuZG9tUG93ZXJ1cFR5cGUoKQogICAgICAgICAgICAgICAgcFR5cGU4ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlMSkuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlMikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlMykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlNCkuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlNSkuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlNikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlNykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlOCkuYXV0b1JldGFpbigpCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAsX2V4cGxvZGVXaXRoUG93ZXJ1cCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICAgICAgIyB0bnQgaXMgbW9yZSBlcGljLi4KICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAndG50JzoKICAgICAgICAgICAgYnMucGxheVNvdW5kKGZhY3RvcnkuZ2V0UmFuZG9tRXhwbG9kZVNvdW5kKCkscG9zaXRpb249cCkKICAgICAgICAgICAgZGVmIF9leHRyYUJvb20oKToKICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChmYWN0b3J5LmdldFJhbmRvbUV4cGxvZGVTb3VuZCgpLHBvc2l0aW9uPXApCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyNTAsX2V4dHJhQm9vbSkKICAgICAgICAgICAgZGVmIF9leHRyYURlYnJpc1NvdW5kKCk6CiAgICAgICAgICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5kZWJyaXNGYWxsU291bmQscG9zaXRpb249cCkKICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChmYWN0b3J5Lndvb2REZWJyaXNGYWxsU291bmQscG9zaXRpb249cCkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDQwMCxfZXh0cmFEZWJyaXNTb3VuZCkKICAgICAgICAgICAgCiAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RudCc6CiAgICAgICAgICAgIGlmIGRvbi50bnRCbGFzdDoKICAgICAgICAgICAgICAgIGRlZiBfZXhwbG9kZVdpdGhQb3dlcnVwKCk6CiAgICAgICAgICAgICAgICAgICAgcFR5cGUxID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGUyID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGUzID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGU0ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGU1ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGU2ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGU3ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgcFR5cGU4ID0gYnMuUG93ZXJ1cEZhY3RvcnkoKS5nZXRSYW5kb21Qb3dlcnVwVHlwZSgpCiAgICAgICAgICAgICAgICAgICAgYnMuUG93ZXJ1cChwb3NpdGlvbixwVHlwZTEpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLlBvd2VydXAocG9zaXRpb24scFR5cGUyKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlMykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuUG93ZXJ1cChwb3NpdGlvbixwVHlwZTQpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLlBvd2VydXAocG9zaXRpb24scFR5cGU1KS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Qb3dlcnVwKHBvc2l0aW9uLHBUeXBlNikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuUG93ZXJ1cChwb3NpdGlvbixwVHlwZTcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLlBvd2VydXAocG9zaXRpb24scFR5cGU4KS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAsX2V4cGxvZGVXaXRoUG93ZXJ1cCkgIyBsb29rcyBiZXR0ZXIgaWYgd2UgZGVsYXkgYSBiaXQKCiAgICBkZWYgZ2V0RmFjdG9yeShjbHMpOgogICAgICAgIGFjdGl2aXR5ID0gYnMuZ2V0QWN0aXZpdHkoKQogICAgICAgIHRyeTogcmV0dXJuIGFjdGl2aXR5Ll9zaGFyZWRCb21iRmFjdG9yeQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIGYgPSBhY3Rpdml0eS5fc2hhcmVkQm9tYkZhY3RvcnkgPSBCb21iRmFjdG9yeSgpCiAgICAgICAgICAgIHJldHVybiBmCgogICAgZGVmIGhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKToKICAgICAgICBzZWxmLl9oYW5kbGVNZXNzYWdlU2FuaXR5Q2hlY2soKQoKICAgICAgICBpZiBpc2luc3RhbmNlKG1zZywgYnMuRGllTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYubm9kZS5kZWxldGUoKQoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBEaXJ0Qm9tYk91dE1lc3NhZ2UpOgogICAgICAgICAgICBub2RlID0gYnMuZ2V0Q29sbGlzaW9uSW5mbygib3Bwb3NpbmdOb2RlIikKICAgICAgICAgICAgaWYgbm9kZSBpcyBub3QgTm9uZSBhbmQgbm9kZS5leGlzdHMoKTogCiAgICAgICAgICAgICAgICBpZiBub2RlIGluIGdldGF0dHIoc2VsZiwgJ2RpcnRfbm9kZXMnLCBbXSk6IHNlbGYuZGlydF9ub2Rlcy5yZW1vdmUobm9kZSkKICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZShEaXJ0Qm9tYk91dE1lc3NhZ2UoKSkKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgRXhwbG9kZUhpdE1lc3NhZ2UpOgogICAgICAgICAgICBub2RlID0gYnMuZ2V0Q29sbGlzaW9uSW5mbygib3Bwb3NpbmdOb2RlIikKICAgICAgICAgICAgaWYgbm9kZSBpcyBub3QgTm9uZSBhbmQgbm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgIHQgPSBzZWxmLm5vZGUucG9zaXRpb24KCiAgICAgICAgICAgICAgICAjIG5ldwogICAgICAgICAgICAgICAgbWFnID0gMjAwMC4wCiAgICAgICAgICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaWNlJyBvciBzZWxmLmJsYXN0VHlwZSA9PSAnaWNlSW1wYWN0JyBvciBzZWxmLmJsYXN0VHlwZSA9PSAnc3RpY2t5SWNlJzogbWFnICo9IDAuNQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnbGFuZE1pbmUnOiBtYWcgKj0gMi41CiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdmaXJld29yayc6IG1hZyAqPSAwLjIKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RwJzogbWFnICo9IDAuNjUKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3FxJzogbWFnICo9IDAuNjUKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2tpbGxMYUtpbGwnOiBtYWcgKj0gMS43NQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAndG50JzogbWFnICo9IDIuMAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAncG9pc29uJzogbWFnICo9IDAuNAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnYm9zcyc6IG1hZyAqPSA1LjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3Rib21iJzogbWFnICo9IDAuMAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnZ2x1ZWJvbWInOiBtYWcgKj0gMC4wMQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnd2VlZGJvbWInOiBtYWcgKj0gMC4wCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdjdXJzZUJvbWInOiBtYWcqPSAwLjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2NoYXJhY3RlckJvbWInOiBtYWcqPSAwLjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ21qQm9tYic6IG1hZyo9IDAuMAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnaWN5VHJpbyc6IG1hZyo9IDAuMAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnYm9vbUJvbWInOiBtYWcqPSAwLjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ3RyaW9Cb21iJzogbWFnKj0gMC4wCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdzcGVlZEJvbWInOiBtYWcqPSAwLjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2hlYWxCb21iJzogbWFnKj0gMC4wCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICduaWdodEJvbWInOiBtYWcqPSA0LjAKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2JsYXN0Qm9tYic6IG1hZyo9IDAuNAogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAncmV2ZW5nZUJvbWInOiBtYWcqPSAwLjQKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gJ2tub2NrQm9tYic6IG1hZyo9IDAuNQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAnc3RpY2t5SWNlJzogbWFnKj0gMC4wCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdzdGlja3lJY2VUcmlvJzogbWFnKj0gMC4wCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICd1c2UnOiBtYWcgKj0gMC4yCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICdhbnRpR3Jhdic6IG1hZyAqPSAwLjEKCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHNlbGYuYmxhc3RUeXBlIG5vdCBpbiBbJ2RpcnQnXToKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoYnMuSGl0TWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgcG9zPXQsCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5PSgwLDAsMCksCiAgICAgICAgICAgICAgICAgICAgICAgIG1hZ25pdHVkZT1tYWcsCiAgICAgICAgICAgICAgICAgICAgICAgIGhpdFR5cGU9c2VsZi5oaXRUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICBoaXRTdWJUeXBlPXNlbGYuaGl0U3ViVHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzPXNlbGYucmFkaXVzLAogICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VQbGF5ZXI9c2VsZi5zb3VyY2VQbGF5ZXIsIAogICAgICAgICAgICAgICAgICAgICAgICBraWNrQmFjayA9IDApKQogICAgICAgICAgICAgICAgaWYgc2VsZi5ibGFzdFR5cGUgPT0gImljZSIgb3Igc2VsZi5ibGFzdFR5cGUgPT0gJ2ljZUltcGFjdCcgb3Igc2VsZi5ibGFzdFR5cGUgPT0gInN0aWNreUljZSI6CiAgICAgICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKEJvbWIuZ2V0RmFjdG9yeSgpLmZyZWV6ZVNvdW5kLCAxMCwgcG9zaXRpb249dCkKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoYnMuRnJlZXplTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgbm9kZSA9IGJzLmdldENvbGxpc2lvbkluZm8oIm9wcG9zaW5nTm9kZSIpCiAgICAgICAgICAgICAgICBpZiBzZWxmLmJsYXN0VHlwZSA9PSAid2VlZGJvbWIiIGFuZCBub3Qgbm9kZS5nZXROb2RlVHlwZSgpICE9ICdzcGF6JzoKICAgICAgICAgICAgICAgICAgICBicy5wbGF5U291bmQoQm9tYi5nZXRGYWN0b3J5KCkuaGlzc1NvdW5kLCA5LCBwb3NpdGlvbj10KQogICAgICAgICAgICAgICAgICAgIGRlZiB3ZWVkKCk6CiAgICAgICAgICAgICAgICAJICAgIG5vZGUuaGFuZGxlTWVzc2FnZSgia25vY2tvdXQiLDEwMDAwKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyMDAwLGJzLkNhbGwod2VlZCkpICNkZWxheSAoZm9yZ290IGFib3V0IHRoZSBlcGljKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1NTAwLGJzLkNhbGwod2VlZCkpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDg1MDAsYnMuQ2FsbCh3ZWVkKSkKICAgICAgICAgICAgICAgICAgICBkZWYgaGljY3VwcygpOgogICAgICAgICAgICAgICAgICAgIAlicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj0obm9kZS5wb3NpdGlvblswXSxub2RlLnBvc2l0aW9uWzFdLTEuMixub2RlLnBvc2l0aW9uWzJdKSwgdmVsb2NpdHk9KDAsMC4wNSwwKSwgY291bnQ9cmFuZG9tLnJhbmRyYW5nZSgxMDAsMjcwKSwgc2NhbGU9MStyYW5kb20ucmFuZG9tKCksIHNwcmVhZD0wLjcxLCBjaHVua1R5cGU9J3N3ZWF0JykgI3JlbWluZHMgbWUgb2YgdG9tIGFuZCBqZXJyeQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAwLGJzLkNhbGwoaGljY3VwcykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI1MDAsYnMuQ2FsbChoaWNjdXBzKSkgI3Nob3dpbmcgd2UgYXJlIGFsaXZlCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDUwMDAsYnMuQ2FsbChoaWNjdXBzKSkKICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNzUwMCxicy5DYWxsKGhpY2N1cHMpKQogICAgICAgICAgICAgICAgICAgIGRlZiBsb29rKCk6CiAgICAgICAgICAgICAgICAgICAgCXRleHQgPSBic1V0aWxzLlBvcHVwVGV4dCgiZ2V0dGluZyBoaWdoIixjb2xvcj0oMi41NSwxLjUzLDEuMDIpLCBzY2FsZT0wLjcsIHJhbmRvbU9mZnNldD0wLjIsIG9mZnNldD0oMCwtMSwwKSwgcG9zaXRpb249KG5vZGUucG9zaXRpb25bMF0sbm9kZS5wb3NpdGlvblsxXS0xLjIsbm9kZS5wb3NpdGlvblsyXSkpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxNTAwLGJzLkNhbGwobG9vaykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDMwMDAsYnMuQ2FsbChsb29rKSkKICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoODAwMCxicy5DYWxsKGxvb2spKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig5MDAwLGJzLkNhbGwobG9vaykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEwMDAwLGJzLkNhbGwobG9vaykpCiAgICAgICAgICAgICAgICAgICAgZGVmIGxvb2soKToKICAgICAgICAgICAgICAgICAgICAJdGV4dCA9IGJzVXRpbHMuUG9wdXBUZXh0KCJnZXR0aW5nIHRpcmVkIixjb2xvcj0oMi41NSwgMS40OCwgMC43NyksIHNjYWxlPTAuNzUsIHJhbmRvbU9mZnNldD0wLjIsIG9mZnNldD0oMCwtMSwwKSwgcG9zaXRpb249KG5vZGUucG9zaXRpb25bMF0sbm9kZS5wb3NpdGlvblsxXS0xLjIsbm9kZS5wb3NpdGlvblsyXSkpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxNDYwLGJzLkNhbGwobG9vaykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI5NjAsYnMuQ2FsbChsb29rKSkKICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNDAwMCxicy5DYWxsKGxvb2spKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1NDYwLGJzLkNhbGwobG9vaykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDYwMDAsYnMuQ2FsbChsb29rKSkKICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoNzk2MCxicy5DYWxsKGxvb2spKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAiZmlyZXdvcmsiOgogICAgICAgICAgICAgICAgICAgIG5vZGUucHVuY2hNYXRlcmlhbHMsIG5vZGUucm9sbGVyTWF0ZXJpYWxzLCBub2RlLmV4dHJhc01hdGVyaWFscyA9IFtdLCBbXSwgW10KICAgICAgICAgICAgICAgICAgICBub2RlLmhvbGRQb3NpdGlvblByZXNzZWQsIG5vZGUuanVtcFByZXNzZWQgPSBUcnVlLCBUcnVlCiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKCdrbm9ja291dCcsIDMwMC4wKQogICAgICAgICAgICAgICAgICAgIHNlbGYucGFyYWxpemVkX2NvdW50cyA9IGdldGF0dHIoc2VsZiwgInBhcmFsaXplZF9jb3VudHMiLCAwKSsxCiAgICAgICAgICAgICAgICAgICAjIG1hcEJvdW5kcyA9IHNlbGYuZ2V0QWN0aXZpdHkoKS5nZXRNYXAoKS5zcGF3blBvaW50cwogICAgICAgICAgICAgICAgICAgIyBub2RlLmhhbmRsZU1lc3NhZ2UoInN0YW5kIiwgcmFuZG9tLnVuaWZvcm0obWFwQm91bmRzWzBdWzBdLCBtYXBCb3VuZHNbMV1bMF0pLCByYW5kb20udW5pZm9ybShtYXBCb3VuZHNbMF1bMV0sIG1hcEJvdW5kc1sxXVsxXSksIHJhbmRvbS51bmlmb3JtKG1hcEJvdW5kc1swXVsyXSwgbWFwQm91bmRzWzFdWzJdKSwgcmFuZG9tLnJhbmRyYW5nZSgwLDM2MCkpCiAgICAgICAgICAgICAgICAgICAjIHNlbGYuX3RlbGVwb3J0ZWQgPSBUcnVlCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJwb2lzb24iOgogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZShQb2lzb25Cb21iSGl0TWVzc2FnZSgpKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAicXEiOgogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZSgia25vY2tvdXQiLCAxMTAuMCkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gInRwIjoKICAgICAgICAgICAgICAgICAgICBtYXBCb3VuZHMgPSBzZWxmLmdldEFjdGl2aXR5KCkuZ2V0TWFwKCkuc3Bhd25Qb2ludHMKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoInN0YW5kIiwgcmFuZG9tLnVuaWZvcm0obWFwQm91bmRzWzBdWzBdLCBtYXBCb3VuZHNbMV1bMF0pLCByYW5kb20udW5pZm9ybShtYXBCb3VuZHNbMF1bMV0sIG1hcEJvdW5kc1sxXVsxXSksIHJhbmRvbS51bmlmb3JtKG1hcEJvdW5kc1swXVsyXSwgbWFwQm91bmRzWzFdWzJdKSwgcmFuZG9tLnJhbmRyYW5nZSgwLDM2MCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fdGVsZXBvcnRlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoImtub2Nrb3V0IiwgNDUuMCkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gImN1cnNlQm9tYiI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ2N1cnNlJykpCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJjaGFyYWN0ZXJCb21iIjoKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGUgPSAncmFuZG9tQ2hhcmFjdGVyJykpCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJtakJvbWIiOgogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwTWVzc2FnZShwb3dlcnVwVHlwZSA9ICdtaicpKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAiaWN5VHJpbyI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ2ljeU1lc3MnKSkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gImJvb21Cb21iIjoKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGUgPSAnaWN5TWVzcycpKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAidHJpb0JvbWIiOgogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwTWVzc2FnZShwb3dlcnVwVHlwZSA9ICdpbXBhY3RNZXNzJykpCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJzcGVlZEJvbWIiOgogICAgICAgICAgICAgICAgICAgIGJzU29tZXRoaW5nLlNob2NrV2F2ZShwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJoZWFsQm9tYiI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ2hlYWx0aCcpKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAic3RpY2t5SWNlVHJpbyI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ3N0aWNreUljZU1lc3MnKSkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gIm5pZ2h0Qm9tYiI6CiAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykudGludCA9ICgwLjYsMC42LDAuOSkKICAgICAgICAgICAgICAgICAgICBsaWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsncG9zaXRpb24nOnNlbGYubm9kZS5wb3NpdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0QXR0ZW51YXRlZCc6RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb2xvcic6ICgwLDEsNil9KQogICAgICAgICAgICAgICAgICAgIGJzLmFuaW1hdGUobGlnaHQsJ3JhZGl1cycsezA6My4wLDMwMDo1LDYwMDowfSkgICAgICAgCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNOSUdIVFx1ZTAwYyIsY29sb3I9KDEsMiwxKSxzY2FsZT01LjIscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD04MDAsc3ByZWFkPTEuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJrbm9ja0JvbWIiOgogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZSgia25vY2tvdXQiLCAxMDAwLjcpCiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKCJrbm9ja291dCIsIDQwMC43KQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjS25vY2tlZCBPVXRcdWUwMGMiLGNvbG9yPSgxLDIsMSksc2NhbGU9MS4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJib3NzIjoKICAgICAgICAgICAgICAgICAgICBub2RlLmhhbmRsZU1lc3NhZ2UoImtub2Nrb3V0IiwgMTAwLjApCiAgICAgICAgICAgICAgICBlbGlmIHNlbGYuYmxhc3RUeXBlID09ICJyZXZlbmdlQm9tYiI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ3N0aWNreUljZU1lc3MnKSkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gImJsYXN0Qm9tYiI6CiAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKCJrbm9ja291dCIsIDEwMC4wKQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLmJsYXN0VHlwZSA9PSAiZGlydCIgYW5kIG5vZGUuZ2V0Tm9kZVR5cGUoKSA9PSAic3BheiI6CiAgICAgICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKEJvbWIuZ2V0RmFjdG9yeSgpLnNwbGF0dGVyU291bmQsIDEwLCBwb3NpdGlvbj10KQogICAgICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZShicy5TbG93TW92ZU1lc3NhZ2UoKSkKICAgICAgICAgICAgICAgICAgICBpZiBub3QgaGFzYXR0cihzZWxmLCAnZGlydF9ub2RlcycpOiBzZWxmLmRpcnRfbm9kZXM9W25vZGVdCiAgICAgICAgICAgICAgICAgICAgZWxpZiBub2RlIG5vdCBpbiBzZWxmLmRpcnRfbm9kZXM6IHNlbGYuZGlydF9ub2Rlcy5hcHBlbmQobm9kZSkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5ibGFzdFR5cGUgPT0gInVzZSI6CiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IGJzLmdldENvbGxpc2lvbkluZm8oJ29wcG9zaW5nTm9kZScpCiAgICAgICAgICAgICAgICAgICAgZGVmIHJhaXNlU3BheigpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBub2RlLmdldERlbGVnYXRlKCkuaXNBbGl2ZSgpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5oYW5kbGVNZXNzYWdlKCJpbXB1bHNlIiwgbm9kZS5wb3NpdGlvblswXSwgbm9kZS5wb3NpdGlvblsxXSArIDAuNSwgbm9kZS5wb3NpdGlvblsyXSwgMCwgNSwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAzLCAxMCwgMCwgMCwgMCwgNSwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCwgcmFpc2VTcGF6KQogICAgICAgICAgICAgICAgICAgIHJhaXNlU3BheigpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnMuQWN0b3IuaGFuZGxlTWVzc2FnZShzZWxmLCBtc2cpCgpjbGFzcyBCb21iKGJzLkFjdG9yKToKICAgICIiIgogICAgY2F0ZWdvcnk6IEdhbWUgRmxvdyBDbGFzc2VzCiAgICAKICAgIEEgYm9tYiBhbmQgaXRzIHZhcmlhbnRzIHN1Y2ggYXMgbGFuZC1taW5lcyBhbmQgdG50LWJveGVzLgogICAgIiIiCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBvc2l0aW9uPSgwLDEsMCksIHZlbG9jaXR5PSgwLDAsMCksIGJvbWJUeXBlPSdub3JtYWwnLAogICAgICAgICAgICAgICAgIGJsYXN0UmFkaXVzPTIuMCwgc291cmNlUGxheWVyPU5vbmUsIG93bmVyPU5vbmUpOgogICAgICAgIGJzLkFjdG9yLl9faW5pdF9fKHNlbGYpCgogICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQoKICAgICAgICBpZiBub3QgYm9tYlR5cGUgaW4gKCdpY2UnLCdpbXBhY3QnLCdsYW5kTWluZScsJ25vcm1hbCcsJ3N0aWNreScsJ3RudCcsICdmaXJld29yaycsICdraWxsTGFLaWxsJywgJ3FxJywgJ3RwJywgJ3BvaXNvbicsICdkaXJ0JywnYmFsbG9uJywnQmxvY2snLCdpY2VJbXBhY3QnLCdnb2xkZW5Cb21iJywndGJvbWInLCdnbHVlYm9tYicsJ3dlZWRib21iJywnc3BhekJvbWInLCdjdXJzZUJvbWInLCduaWdodEJvbWInLCdoZWFsQm9tYicsJ2tub2NrQm9tYicsJ3NwZWVkQm9tYicsJ2NoYXJhY3RlckJvbWInLCdtakJvbWInLCd0cmlvQm9tYicsJ3N0aWNreUljZScsJ2Jvb21Cb21iJywnaWN5VHJpbycsJ3N0aWNreUljZVRyaW8nLCdibGFzdEJvbWInLCdyZXZlbmdlQm9tYicsJ3VzZScsJ2FudGlHcmF2Jyk6CiAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigiaW52YWxpZCBib21iIHR5cGU6ICIgKyBib21iVHlwZSkKICAgICAgICBzZWxmLmJvbWJUeXBlID0gYm9tYlR5cGUKICAgICAgICBzZWxmLl9leHBsb2RlZCA9IEZhbHNlCgogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3N0aWNreScgb3Igc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5SWNlJzogc2VsZi5fbGFzdFN0aWNreVNvdW5kVGltZSA9IDAKCiAgICAgICAgc2VsZi5ibGFzdFJhZGl1cyA9IGJsYXN0UmFkaXVzCiAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnaWNlJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAxLjIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZUltcGFjdCc6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMC43ICMgQ2hhbmdlIGJsYXN0IHJhZGl1cyBmb3Igb3VyIGJvbWIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3FxJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ZpcmV3b3JrJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAxLjc1CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpbXBhY3QnOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuNwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna2lsbExhS2lsbCc6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMC45NDUKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2xhbmRNaW5lJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjcKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RudCc6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMS40NQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncG9pc29uJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAxLjIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2dvbGRlbkJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDQKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3Rib21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjEKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2dsdWVib21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjUKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3dlZWRib21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3NwYXpCb21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjc1CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdjdXJzZUJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuNwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMC43CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdtakJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuNwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaWN5VHJpbyc6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMC43CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdib29tQm9tYic6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMC43CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICd0cmlvQm9tYic6IHNlbGYuYmxhc3RSYWRpdXMgKj0gMS4yCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGVlZEJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuNwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaGVhbEJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuNwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbmlnaHRCb21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAyMC4wCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdibGFzdEJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDEuMAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncmV2ZW5nZUJvbWInOiBzZWxmLmJsYXN0UmFkaXVzICo9IDEuMAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna25vY2tCb21iJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjUKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3N0aWNreUljZVRyaW8nOiBzZWxmLmJsYXN0UmFkaXVzICo9IDAuOAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndXNlJzogc2VsZi5ibGFzdFJhZGl1cyAqPSAwLjcKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgaW4gKCdCbG9jaycpOiBzZWxmLmJsYXN0UmFkaXVzICo9IDEuMgoKICAgICAgICBzZWxmLl9leHBsb2RlQ2FsbGJhY2tzID0gW10KICAgICAgICAKICAgICAgICAjIHRoZSBwbGF5ZXIgdGhpcyBjYW1lIGZyb20KICAgICAgICBzZWxmLnNvdXJjZVBsYXllciA9IHNvdXJjZVBsYXllcgoKICAgICAgICAjIGJ5IGRlZmF1bHQgb3VyIGhpdCB0eXBlL3N1YnR5cGUgaXMgb3VyIG93biwgYnV0IHdlIHBpY2sgdXAgdHlwZXMgb2YKICAgICAgICAjIHdob2V2ZXIgc2V0cyB1cyBvZmYgc28gd2Uga25vdyB3aGF0IGNhdXNlZCBhIGNoYWluIHJlYWN0aW9uCiAgICAgICAgc2VsZi5oaXRUeXBlID0gJ2V4cGxvc2lvbicKICAgICAgICBzZWxmLmhpdFN1YlR5cGUgPSBzZWxmLmJvbWJUeXBlCgogICAgICAgICMgaWYgbm8gb3duZXIgd2FzIHByb3ZpZGVkLCB1c2UgYW4gdW5jb25uZWN0ZWQgbm9kZSByZWYKICAgICAgICBpZiBvd25lciBpcyBOb25lOiBvd25lciA9IGJzLk5vZGUoTm9uZSkKCiAgICAgICAgIyB0aGUgbm9kZSB0aGlzIGNhbWUgZnJvbQogICAgICAgIHNlbGYub3duZXIgPSBvd25lcgoKICAgICAgICAjIGFkZGluZyBmb290aW5nLW1hdGVyaWFscyB0byB0aGluZ3MgY2FuIHNjcmV3IHVwIGp1bXBpbmcgYW5kIGZseWluZwogICAgICAgICMgc2luY2UgcGxheWVycyBjYXJyeWluZyB0aG9zZSB0aGluZ3MKICAgICAgICAjIGFuZCB0aHVzIHRvdWNoaW5nIGZvb3Rpbmcgb2JqZWN0cyB3aWxsIHRoaW5rIHRoZXkncmUgb24gc29saWQgZ3JvdW5kLi4KICAgICAgICAjIHBlcmhhcHMgd2UgZG9uJ3Qgd2FubmEgYWRkIHRoaXMgZXZlbiBpbiB0aGUgdG50IGNhc2U/Li4KICAgICAgICBpZiBzZWxmLmJvbWJUeXBlID09ICd0bnQnIG9yIHNlbGYuYm9tYlR5cGUgPT0gJ0Jsb2NrJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gKGZhY3RvcnkuYm9tYk1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdmb290aW5nTWF0ZXJpYWwnKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBtYXRlcmlhbHMgPSAoZmFjdG9yeS5ib21iTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ29iamVjdE1hdGVyaWFsJykpCiAgICAgICAgICAgCiAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnaWNlSW1wYWN0JzogbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpICMgTWF0ZXJpYWxzIG9mIGltcGFjdCBib21iCiAgICAgICAgICAgIAogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ltcGFjdCc6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmltcGFjdEJsYXN0TWF0ZXJpYWwsKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndGJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2dsdWVib21iJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGF6Qm9tYic6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmltcGFjdEJsYXN0TWF0ZXJpYWwsKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnd2VlZGJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3FxJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdrbm9ja0JvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2NoYXJhY3RlckJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ21qQm9tYic6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmltcGFjdEJsYXN0TWF0ZXJpYWwsKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaWN5VHJpbyc6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmltcGFjdEJsYXN0TWF0ZXJpYWwsKSAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnYm9vbUJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RyaW9Cb21iJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2VUcmlvJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdjdXJzZUJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2hlYWxCb21iJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGVlZEJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5pbXBhY3RCbGFzdE1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2FudGlHcmF2JzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkuaW1wYWN0Qmxhc3RNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdsYW5kTWluZSc6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmxhbmRNaW5lTm9FeHBsb2RlTWF0ZXJpYWwsKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbmlnaHRCb21iJzoKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3RvcnkubGFuZE1pbmVOb0V4cGxvZGVNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICd1c2UnOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5sYW5kTWluZU5vRXhwbG9kZU1hdGVyaWFsLCkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2JsYXN0Qm9tYic6CiAgICAgICAgICAgIG1hdGVyaWFscyA9IG1hdGVyaWFscyArIChmYWN0b3J5LmxhbmRNaW5lTm9FeHBsb2RlTWF0ZXJpYWwsKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncmV2ZW5nZUJvbWInOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5sYW5kTWluZU5vRXhwbG9kZU1hdGVyaWFsLCkKCiAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5JyBvciBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2UnOgogICAgICAgICAgICBtYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAoZmFjdG9yeS5zdGlja3lNYXRlcmlhbCwpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlIG5vdCBpbiBbJ2RpcnQnXToKICAgICAgICAgICAgbWF0ZXJpYWxzID0gbWF0ZXJpYWxzICsgKGZhY3Rvcnkubm9ybWFsU291bmRNYXRlcmlhbCwpCgogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2xhbmRNaW5lJzoKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmxhbmRNaW5lTW9kZWwsCiAgICAgICAgICAgICAgICAnbGlnaHRNb2RlbCc6ZmFjdG9yeS5sYW5kTWluZU1vZGVsLAogICAgICAgICAgICAgICAgJ2JvZHknOidsYW5kTWluZScsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC40NCwKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkubGFuZE1pbmVUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2xhbmRNaW5lJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KQogICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZUltcGFjdCc6CiAgICAgICAgICAgICNwcmludCgiSXQncyB3b3JrcyEiKSAjIERlYnVnIG1lc3NhZ2UKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuaWNlSW1wYWN0TW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5pY2VJbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2ljZUltcGFjdCcgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkgIyBNYWtlIGEgYm9tYiBzZXR0aW5ncwogICAgICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdhbnRpR3Jhdic6CiAgICAgICAgICAgIGZ1c2VUaW1lID0gMzAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6IHBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5JzogdmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6ICdzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzogZmFjdG9yeS5pbXBhY3RCb21iTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6IDAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOiBmYWN0b3J5Lm5ld1RleCwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzogJ3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6IFtyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICdhbnRpR3JhdicgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6IG1hdGVyaWFsc30pCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2NoYXJhY3RlckJvbWInOgogICAgICAgICAgICAjcHJpbnQoIkl0J3Mgd29ya3MhIikgIyBEZWJ1ZyBtZXNzYWdlCiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmNoYXJhY3RlckJvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmNoYXJhY3RlckJvbWJUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2NoYXJhY3RlckJvbWInIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3BlZWRCb21iJzoKICAgICAgICAgICAgI3ByaW50KCJJdCdzIHdvcmtzISIpICMgRGVidWcgbWVzc2FnZQogICAgICAgICAgICBmdXNlVGltZSA9IDIwMDAwCiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdib2R5Jzonc3BoZXJlJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5zcGVlZEJvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LnNwZWVkQm9tYlRleCwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzoncG93ZXJ1cCcsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAnc3BlZWRCb21iJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KSAjIE1ha2UgYSBib21iIHNldHRpbmdzCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ21qQm9tYic6CiAgICAgICAgICAgICNwcmludCgiSXQncyB3b3JrcyEiKSAjIERlYnVnIG1lc3NhZ2UKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuY2hhcmFjdGVyQm9tYk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkuY2hhcmFjdGVyQm9tYlRleCwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzoncG93ZXJ1cCcsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAnbWpCb21iJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KSAjIE1ha2UgYSBib21iIHNldHRpbmdzCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljeVRyaW8nOgogICAgICAgICAgICAjcHJpbnQoIkl0J3Mgd29ya3MhIikgIyBEZWJ1ZyBtZXNzYWdlCiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmljeVRyaW9Nb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmljeVRyaW9UZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2ljeVRyaW8nIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnYm9vbUJvbWInOgogICAgICAgICAgICAjcHJpbnQoIkl0J3Mgd29ya3MhIikgIyBEZWJ1ZyBtZXNzYWdlCiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmJvb21Cb21iTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5ib29tQm9tYlRleCwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzoncG93ZXJ1cCcsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAnYm9vbUJvbWInIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHJpb0JvbWInOgogICAgICAgICAgICAjcHJpbnQoIkl0J3Mgd29ya3MhIikgIyBEZWJ1ZyBtZXNzYWdlCiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmNoYXJhY3RlckJvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmNoYXJhY3RlckJvbWJUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ3RyaW9Cb21iJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KSAjIE1ha2UgYSBib21iIHNldHRpbmdzCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2N1cnNlQm9tYic6CiAgICAgICAgICAgICNwcmludCgiSXQncyB3b3JrcyEiKSAjIERlYnVnIG1lc3NhZ2UKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuY3Vyc2VCb21iTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5jdXJzZUJvbWJUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2N1cnNlQm9tYicgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkgIyBNYWtlIGEgYm9tYiBzZXR0aW5ncwogICAgICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdoZWFsQm9tYic6CiAgICAgICAgICAgICNwcmludCgiSXQncyB3b3JrcyEiKSAjIERlYnVnIG1lc3NhZ2UKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuaGVhbEJvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmhlYWxCb21iVGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidwb3dlcnVwJywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOltyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICdoZWFsQm9tYicgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkgIyBNYWtlIGEgYm9tYiBzZXR0aW5ncwogICAgICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdrbm9ja0JvbWInOgogICAgICAgICAgICAjcHJpbnQoIkl0J3Mgd29ya3MhIikgIyBEZWJ1ZyBtZXNzYWdlCiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5Lmtub2NrQm9tYk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3Rvcnkua25vY2tCb21iVGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidwb3dlcnVwJywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOltyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICdrbm9ja0JvbWInIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5SWNlVHJpbyc6CiAgICAgICAgICAgICNwcmludCgiSXQncyB3b3JrcyEiKSAjIERlYnVnIG1lc3NhZ2UKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3Rvcnkuc3RpY2t5SWNlVHJpb0JvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LnN0aWNreUljZVRyaW9UZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ3N0aWNreUljZVRyaW8nIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3BhekJvbWInOgogICAgICAgICAgICBmdXNlVGltZSA9IDIwMDAwCiAgICAgICAgICAgIGJzLnBsYXlTb3VuZChicy5nZXRTb3VuZCgnc3BhekltcGFjdDAxJykpCiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdib2R5Jzonc3BoZXJlJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5zcGF6Qm9tYk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdtb2RlbFNjYWxlJzo0LjAyOCwKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkudGV4U3BhekJvbWIsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ3NwYXpCb21iJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCJtb2RlbFNjYWxlIix7MDowLCAyMDA6MS4zLCAyNjA6MX0pICAgIAogICAgICAgICAjICBic1V0aWxzLmFuaW1hdGVBcnJheShzZWxmLm5vZGUsInBvc2l0aW9uIiwzLHswOigxLjgzMDM3NzM2MywgNC4yMjg4NTA2ODUsIDMuODAzOTg4NjM2KSwxMDAwMDooNC4xNDg0OTMyNjcsIDQuNDI5MTY1MjQ0LCAtNi41ODg2MTg1NDkpLDIwMDAwOigtNS40MjI1NzIwODYsIDQuMjI4ODUwNjg1LCAyLjgwMzk4ODYzNiksMjUwMDA6KC02Ljg1OTQwNjczOSwgNC40MjkxNjUyNDQsIC02LjU4ODYxODU0OSksMzAwMDA6KC02Ljg1OTQwNjczOSwgNC40MjkxNjUyNDQsIC02LjU4ODYxODU0OSksMzUwMDA6KDMuMTQ4NDkzMjY3LCA0LjQyOTE2NTI0NCwgLTYuNTg4NjE4NTQ5KSw0MDAwMDooMS44MzAzNzczNjMsIDQuMjI4ODUwNjg1LCAyLjgwMzk4ODYzNiksNDUwMDA6KC01LjQyMjU3MjA4NiwgNC4yMjg4NTA2ODUsIDIuODAzOTg4NjM2KSw1MDAwMDooLTUuNDIyNTcyMDg2LCA0LjIyODg1MDY4NSwgMi44MDM5ODg2MzYpLDU1MDAwOigxLjgzMDM3NzM2MywgNC4yMjg4NTA2ODUsIDIuODAzOTg4NjM2KSw2MDAwMDooMy4xNDg0OTMyNjcsIDQuNDI5MTY1MjQ0LCAtNi41ODg2MTg1NDkpLDcwMDAwOigxLjgzMDM3NzM2MywgNC4yMjg4NTA2ODUsIDIuODAzOTg4NjM2KSw3NTAwMDooMy4xNDg0OTMyNjcsIDQuNDI5MTY1MjQ0LCAtNi41ODg2MTg1NDkpLDgwMDAwOigtNS40MjI1NzIwODYsIDQuMjI4ODUwNjg1LCAyLjgwMzk4ODYzNiksOTAwMDA6KC02Ljg1OTQwNjczOSwgNC40MjkxNjUyNDQsIC02LjU4ODYxODU0OSksOTUwMDA6KC02Ljg1OTQwNjczOSwgNC40MjkxNjUyNDQsIC02LjU4ODYxODU0OSl9LGxvb3AgPSBUcnVlKSAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICAKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3Rib21iJzoKICAgICAgICAgICAgZnVzZVRpbWUgPSAyMDAwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkudGJvbWJNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LnRib21iVGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidwb3dlcnVwJywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOltyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICd0Ym9tYicgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKHNlbGYubm9kZSwibW9kZWxTY2FsZSIsezA6MCwgMjAwOjEuMywgMjYwOjF9KSAgICAKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdnbHVlYm9tYic6CiAgICAgICAgICAgIGZ1c2VUaW1lID0gMjAwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgncHJvcCcsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidwdWNrJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5nbHVlYm9tYk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdtb2RlbFNjYWxlJzowLjAyOCwKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkuZ2x1ZWJvbWJUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAnZ2x1ZWJvbWInIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pICAgICAgICAgCgogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnd2VlZGJvbWInOgogICAgICAgICAgICBmdXNlVGltZSA9IDkwMDAwCiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdib2R5Jzonc3BoZXJlJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS53ZWVkYm9tYk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3Rvcnkud2VlZGJvbWJUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ3dlZWRib21iJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCJtb2RlbFNjYWxlIix7MDowLCAyMDA6MS4zLCAyNjA6MX0pICAgICAgICAgICAgICAgIAoKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RudCc6CiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS50bnRNb2RlbCwKICAgICAgICAgICAgICAgICdsaWdodE1vZGVsJzpmYWN0b3J5LnRudE1vZGVsLAogICAgICAgICAgICAgICAgJ2JvZHknOidjcmF0ZScsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC41LAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS50bnRUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3NvZnQnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ3RudCcgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnQmxvY2snOgogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuYmxvY2tNb2RlbCwKICAgICAgICAgICAgICAgICdsaWdodE1vZGVsJzpmYWN0b3J5LmJsb2NrTW9kZWwsCiAgICAgICAgICAgICAgICAnYm9keSc6J2NyYXRlJywKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjUsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmJsb2NrVGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidzb2Z0JywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOltyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICdCbG9jaycgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkgICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpbXBhY3QnOgogICAgICAgICAgICBmdXNlVGltZSA9IDIwMDAwCiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ3Byb3AnLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdib2R5Jzonc3BoZXJlJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5pbXBhY3RCb21iTW9kZWwsCiAgICAgICAgICAgICAgICAnbW9kZWxTY2FsZSc6MC4wLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkuaW1wYWN0VGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidwb3dlcnVwJywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOltyU2NhbGVdIGlmIGJvbWJUeXBlICE9ICdpbXBhY3QnIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pCiAgICAgICAgICAgIHNlbGYuYXJtVGltZXIgPSBicy5UaW1lcigyMDAsIGJzLldlYWtDYWxsKHNlbGYuaGFuZGxlTWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJtTWVzc2FnZSgpKSkKICAgICAgICAgICAgc2VsZi53YXJuVGltZXIgPSBicy5UaW1lcihmdXNlVGltZS0xNzAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuaGFuZGxlTWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXYXJuTWVzc2FnZSgpKSkKCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdkaXJ0JzoKICAgICAgICAgICAgZnVzZVRpbWUgPSA0NTAwCiAgICAgICAgICAgIHNlbGYubm9kZSA9IGJzLm5ld05vZGUoJ2JvbWInLCBkZWxlZ2F0ZT1zZWxmLCBhdHRycz17CiAgICAgICAgICAgICAgICAncG9zaXRpb24nOnBvc2l0aW9uLAogICAgICAgICAgICAgICAgJ3ZlbG9jaXR5Jzp2ZWxvY2l0eSwKICAgICAgICAgICAgICAgICdib2R5Jzonc3BoZXJlJywKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5zdGlja3lCb21iTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5wb2lzb25UZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3NvZnQnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2RpcnQnIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pCiAgICAgICAgICAgIHNvdW5kID0gYnMubmV3Tm9kZSgnc291bmQnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdzb3VuZCc6ZmFjdG9yeS5mdXNlU291bmQsCiAgICAgICAgICAgICAgICAndm9sdW1lJzowLjI1fSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNvdW5kLCAncG9zaXRpb24nKQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCAnZnVzZUxlbmd0aCcsIHswOjEuMCwgZnVzZVRpbWU6MC4wfSkKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdmaXJld29yayc6CiAgICAgICAgICAgIGZ1c2VUaW1lID0gNDUwMAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J2NyYXRlJywKICAgICAgICAgICAgICAgICdib2R5U2NhbGUnOjAuOSwKICAgICAgICAgICAgICAgICdtb2RlbCc6ZmFjdG9yeS5maXJld29ya01vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkuZmlyZXdvcmtUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3NvZnQnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2ZpcmV3b3JrJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KQoKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2tpbGxMYUtpbGwnOgogICAgICAgICAgICBmdXNlVGltZSA9IDMwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgnYm9tYicsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LmtpbGxMYUtpbGxNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LmtpbGxMYUtpbGxUZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3NoYXJwZXInLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2tpbGxMYUtpbGwnIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pCiAgICAgICAgICAgIHNvdW5kID0gYnMubmV3Tm9kZSgnc291bmQnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdzb3VuZCc6ZmFjdG9yeS5mdXNlU291bmQsCiAgICAgICAgICAgICAgICAndm9sdW1lJzowLjI1fSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNvdW5kLCAncG9zaXRpb24nKQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCAnZnVzZUxlbmd0aCcsIHswOjEuMCwgZnVzZVRpbWU6MC4wfSkKCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdwb2lzb24nOgogICAgICAgICAgICBmdXNlVGltZSA9IDQ1MDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgnYm9tYicsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LnBvaXNvbk1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOmZhY3RvcnkucG9pc29uVGV4LAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb24nOidzb2Z0JywKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uU2NhbGUnOlsxLjBdLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzfSkKICAgICAgICAgICAgc291bmQgPSBicy5uZXdOb2RlKCdzb3VuZCcsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3NvdW5kJzpmYWN0b3J5LmZ1c2VTb3VuZCwKICAgICAgICAgICAgICAgICd2b2x1bWUnOjAuMjV9KQogICAgICAgICAgICBzZWxmLm5vZGUuY29ubmVjdEF0dHIoJ3Bvc2l0aW9uJywgc291bmQsICdwb3NpdGlvbicpCiAgICAgICAgICAgIGJzVXRpbHMuYW5pbWF0ZShzZWxmLm5vZGUsICdmdXNlTGVuZ3RoJywgezA6MS4wLCBmdXNlVGltZTowLjB9KQogICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHAnOgogICAgICAgICAgICBmdXNlVGltZSA9IDMwMDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgnYm9tYicsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ21vZGVsJzpmYWN0b3J5LnRwTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS50cFRleCwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzonc2hhcnBlcicsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAndHAnIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pCiAgICAgICAgICAgIHNvdW5kID0gYnMubmV3Tm9kZSgnc291bmQnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdzb3VuZCc6ZmFjdG9yeS5mdXNlU291bmQsCiAgICAgICAgICAgICAgICAndm9sdW1lJzowLjI1fSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNvdW5kLCAncG9zaXRpb24nKQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCAnZnVzZUxlbmd0aCcsIHswOjEuMCwgZnVzZVRpbWU6MC4wfSkKCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdiYWxsb24nOgogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdwcm9wJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnYm9keSc6J3NwaGVyZScsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkuYmFsbG9uTW9kZWwsCiAgICAgICAgICAgICAgICAnc2hhZG93U2l6ZSc6MC4zLAogICAgICAgICAgICAgICAgJ2NvbG9yVGV4dHVyZSc6ZmFjdG9yeS5iYWxsb25UZXgsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6J3Bvd2VydXAnLAogICAgICAgICAgICAgICAgJ3JlZmxlY3Rpb25TY2FsZSc6W3JTY2FsZV0gaWYgYm9tYlR5cGUgIT0gJ2JhbGxvbicgZWxzZSAoKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCkpLAogICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzLAogICAgICAgICAgICAgICAgJ2V4dHJhQWNjZWxlcmF0aW9uJzooMCw3MCwwKX0pICMgTWFrZSBhIGJvbWIgc2V0dGluZ3MgCgogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncXEnOgogICAgICAgICAgICBmdXNlVGltZSA9IDQ1MDAKICAgICAgICAgICAgc2VsZi5ub2RlID0gYnMubmV3Tm9kZSgnYm9tYicsIGRlbGVnYXRlPXNlbGYsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdwb3NpdGlvbic6cG9zaXRpb24sCiAgICAgICAgICAgICAgICAndmVsb2NpdHknOnZlbG9jaXR5LAogICAgICAgICAgICAgICAgJ2JvZHknOidzcGhlcmUnLAogICAgICAgICAgICAgICAgJ2JvZHlTY2FsZSc6MC43NzUsCiAgICAgICAgICAgICAgICAnZGVuc2l0eSc6MS43NzIsCiAgICAgICAgICAgICAgICAnbW9kZWwnOmZhY3RvcnkucXFNb2RlbCwKICAgICAgICAgICAgICAgICdzaGFkb3dTaXplJzowLjMsCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpmYWN0b3J5LnFxVGV4LAogICAgICAgICAgICAgICAgJ293bmVyJzpvd25lciwKICAgICAgICAgICAgICAgICdyZWZsZWN0aW9uJzonc2hhcnBlcicsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAncXEnIGVsc2UgKCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSwoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApKSwKICAgICAgICAgICAgICAgICdtYXRlcmlhbHMnOm1hdGVyaWFsc30pCiAgICAgICAgICAgIHNvdW5kID0gYnMubmV3Tm9kZSgnc291bmQnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICdzb3VuZCc6ZmFjdG9yeS5mdXNlU291bmQsCiAgICAgICAgICAgICAgICAndm9sdW1lJzowLjI1fSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNvdW5kLCAncG9zaXRpb24nKQogICAgICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5ub2RlLCAnZnVzZUxlbmd0aCcsIHswOjEuMCwgZnVzZVRpbWU6MC4wfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDQzMjAsIGJzLldlYWtDYWxsKHNlbGYuaGFuZGxlTWVzc2FnZSwgYnMuRGllTWVzc2FnZSgpKSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDQzMTksIGJzLkNhbGwoc2VsZi5leHBsb2RlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBmdXNlVGltZSA9IDMwMDAKICAgICAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5JzoKICAgICAgICAgICAgICAgIHN0aWNreSA9IFRydWUKICAgICAgICAgICAgICAgIG1vZGVsID0gZmFjdG9yeS5zdGlja3lCb21iTW9kZWwKICAgICAgICAgICAgICAgIHJUeXBlID0gJ3NoYXJwZXInCiAgICAgICAgICAgICAgICByU2NhbGUgPSAxLjgKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2UnOgogICAgICAgICAgICAgICAgc3RpY2t5ID0gVHJ1ZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LnN0aWNreUJvbWJNb2RlbAogICAgICAgICAgICAgICAgclR5cGUgPSAnc2hhcnBlcicKICAgICAgICAgICAgICAgIHJTY2FsZSA9IDEuOAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZUltcGFjdCc6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LmljZUltcGFjdE1vZGVsCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY3Vyc2VCb21iJzoKICAgICAgICAgICAgICAgIHN0aWNreSA9IEZhbHNlCiAgICAgICAgICAgICAgICBtb2RlbCA9IGZhY3RvcnkuY3Vyc2VCb21iTW9kZWwKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2VUcmlvJzoKICAgICAgICAgICAgICAgIHN0aWNreSA9IEZhbHNlCiAgICAgICAgICAgICAgICBtb2RlbCA9IGZhY3Rvcnkuc3RpY2t5SWNlVHJpb0JvbWJNb2RlbAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2tub2NrQm9tYic6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5Lmtub2NrQm9tYk1vZGVsCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaGVhbEJvbWInOgogICAgICAgICAgICAgICAgc3RpY2t5ID0gRmFsc2UKICAgICAgICAgICAgICAgIG1vZGVsID0gZmFjdG9yeS5oZWFsQm9tYk1vZGVsCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LmNoYXJhY3RlckJvbWJNb2RlbAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ21qQm9tYic6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5Lm1qQm9tYk1vZGVsCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaWN5VHJpbyc6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LmljeVRyaW9Nb2RlbAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2Jvb21Cb21iJzoKICAgICAgICAgICAgICAgIHN0aWNreSA9IEZhbHNlCiAgICAgICAgICAgICAgICBtb2RlbCA9IGZhY3RvcnkuYm9vbUJvbWJNb2RlbAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RyaW9Cb21iJzoKICAgICAgICAgICAgICAgIHN0aWNreSA9IEZhbHNlCiAgICAgICAgICAgICAgICBtb2RlbCA9IGZhY3RvcnkudHJpb0JvbWJNb2RlbAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3NwZWVkQm9tYic6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LnNwZWVkQm9tYk1vZGVsCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3BhekJvbWInOgogICAgICAgICAgICAgICAgc3RpY2t5ID0gRmFsc2UKICAgICAgICAgICAgICAgIG1vZGVsID0gZmFjdG9yeS5zcGF6Qm9tYk1vZGVsCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzdGlja3kgPSBGYWxzZQogICAgICAgICAgICAgICAgbW9kZWwgPSBmYWN0b3J5LmJvbWJNb2RlbAogICAgICAgICAgICAgICAgclR5cGUgPSAnc2hhcnBlcicKICAgICAgICAgICAgICAgIHJTY2FsZSA9IDEuOAogICAgICAgICAgICBpZiBzZWxmLmJvbWJUeXBlID09ICdpY2UnIG9yIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZUltcGFjdCc6IHRleCA9IGZhY3RvcnkuaWNlVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY3Vyc2VCb21iJzogdGV4ID0gZmFjdG9yeS5jdXJzZUJvbWJUZXgKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2VUcmlvJzogdGV4ID0gZmFjdG9yeS5zdGlja3lJY2VUcmlvVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbWpCb21iJzogdGV4ID0gZmFjdG9yeS5takJvbWJUZXgKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpY3lUcmlvJzogdGV4ID0gZmFjdG9yeS5pY3lUcmlvVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnYm9vbUJvbWInOiB0ZXggPSBmYWN0b3J5LmJvb21Cb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHJpb0JvbWInOiB0ZXggPSBmYWN0b3J5LnRyaW9Cb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6IHRleCA9IGZhY3RvcnkuY2hhcmFjdGVyQm9tYlRleAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3NwZWVkQm9tYic6IHRleCA9IGZhY3Rvcnkuc3BlZWRCb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaGVhbEJvbWInOiB0ZXggPSBmYWN0b3J5LmhlYWxCb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbmlnaHRCb21iJzogdGV4ID0gZmFjdG9yeS5uaWdodEJvbWJUZXgKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICd1c2UnOiB0ZXggPSBmYWN0b3J5LnVzZVRleAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2JsYXN0Qm9tYic6IHRleCA9IGZhY3RvcnkuYmxhc3RCb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncmV2ZW5nZUJvbWInOiB0ZXggPSBmYWN0b3J5LnJldmVuZ2VCb21iVGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna25vY2tCb21iJzogdGV4ID0gZmFjdG9yeS5rbm9ja0JvbWJUZXgKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3knOiB0ZXggPSBmYWN0b3J5LnN0aWNreVRleAogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3N0aWNreUljZSc6IHRleCA9IGZhY3Rvcnkuc3RpY2t5VGV4CiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3BhekJvbWInOiB0ZXggPSBmYWN0b3J5LnRleFNwYXpCb21iCiAgICAgICAgICAgIGVsc2U6IHRleCA9IGZhY3RvcnkucmVndWxhclRleAogICAgICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKCdib21iJywgZGVsZWdhdGU9c2VsZiwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzpwb3NpdGlvbiwKICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6dmVsb2NpdHksCiAgICAgICAgICAgICAgICAnbW9kZWwnOm1vZGVsLAogICAgICAgICAgICAgICAgJ3NoYWRvd1NpemUnOjAuMywKICAgICAgICAgICAgICAgICdjb2xvclRleHR1cmUnOnRleCwKICAgICAgICAgICAgICAgICdzdGlja3knOnN0aWNreSwKICAgICAgICAgICAgICAgICdvd25lcic6b3duZXIsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvbic6clR5cGUsCiAgICAgICAgICAgICAgICAncmVmbGVjdGlvblNjYWxlJzpbclNjYWxlXSBpZiBib21iVHlwZSAhPSAnbm9ybWFsJyBlbHNlICgoMCtyYW5kb20ucmFuZG9tKCkqMjAuMCksKDArcmFuZG9tLnJhbmRvbSgpKjIwLjApLCgwK3JhbmRvbS5yYW5kb20oKSoyMC4wKSksCiAgICAgICAgICAgICAgICAnbWF0ZXJpYWxzJzptYXRlcmlhbHN9KQoKICAgICAgICAgICAgc291bmQgPSBicy5uZXdOb2RlKCdzb3VuZCcsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgJ3NvdW5kJzpmYWN0b3J5LmZ1c2VTb3VuZCwKICAgICAgICAgICAgICAgICd2b2x1bWUnOjAuMjV9KQogICAgICAgICAgICBzZWxmLm5vZGUuY29ubmVjdEF0dHIoJ3Bvc2l0aW9uJywgc291bmQsICdwb3NpdGlvbicpCiAgICAgICAgICAgIGJzVXRpbHMuYW5pbWF0ZShzZWxmLm5vZGUsICdmdXNlTGVuZ3RoJywgezA6MS4wLCBmdXNlVGltZTowLjB9KQogICAgICAgICAgICAKICAgICAgICAjIGxpZ2h0IHRoZSBmdXNlISEhCiAgICAgICAgaWYgKHNlbGYuYm9tYlR5cGUgbm90IGluICgnbGFuZE1pbmUnLCd0bnQnLCdCbG9jaycsJ2JhbGxvbicpKToKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKGZ1c2VUaW1lLCBicy5XZWFrQ2FsbChzZWxmLmhhbmRsZU1lc3NhZ2UsIEV4cGxvZGVNZXNzYWdlKCkpKQogICAgICAgICAgICBwcmVmaXhBbmltID0gezA6ICgxLCAwLCAwKSwgMjUwOiAoMSwgMSwgMCksIDI1MCAqIDI6ICgwLCAxLCAwKSwgMjUwICogMzogKDAsIDEsIDEpLCAyNTAgKiA0OiAoMSwgMCwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgMjUwICogNTogKDAsIDAsIDEpLCAyNTAgKiA2OiAoMSwgMCwgMCl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZSc6IG5hbWUgPSAnSWN5Qm9tYnMnCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaW1wYWN0JzogbmFtZSA9ICdpbXBhY3RCb21icycKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3knOiBuYW1lID0gJ3N0aWNreUJvbWJzJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RudCc6IG5hbWUgPSAndG50JwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2xhbmRNaW5lJzogbmFtZSA9ICdsYW5kTWluZXMnCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbm9ybWFsJzogbmFtZSA9ICdOb29iQm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpY2VJbXBhY3QnOiBuYW1lID0gJ2ljZUltcGFjdCcKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdjdXJzZUJvbWInOiBuYW1lID0gJ0N1cnNlQm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdtakJvbWInOiBuYW1lID0gJ01KQm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpY3lUcmlvJzogbmFtZSA9ICdJY3lUcmlvJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2Jvb21Cb21iJzogbmFtZSA9ICdLYWJvb20nCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHJpb0JvbWInOiBuYW1lID0gJ2ltcGFjdFRyaW8nCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6IG5hbWUgPSAnQ2hhcmFjdGVyJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3NwZWVkQm9tYic6IG5hbWUgPSAnU2hvY2tXYXZlJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2hlYWxCb21iJzogbmFtZSA9ICdoZWFsQm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICduaWdodEJvbWInOiBuYW1lID0gJ0F0b21Cb21iJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3VzZSc6IG5hbWUgPSAnRmx5Qm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdibGFzdEJvbWInOiBuYW1lID0gJ0JsYXN0Qm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdyZXZlbmdlQm9tYic6IG5hbWUgPSAnUmV2ZW5nZUJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna25vY2tCb21iJzogbmFtZSA9ICdLbm9ja0JvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5SWNlJzogbmFtZSA9ICdTdGlja3lJY2UnCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3BhekJvbWInOiBuYW1lID0gJ1NwYXpCb21iJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ZpcmV3b3JrJzogbmFtZSA9ICdGaXJlV29ya3MnCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAncXEnOiBuYW1lID0gJ0p1bXBpbkJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHAnOiBuYW1lID0gJ3RlbGVCb21iJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3dlZWRib21iJzogbmFtZSA9ICdXZWVkQm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdnbHVlYm9tYic6IG5hbWUgPSAnR2x1ZUJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndGJvbWInOiBuYW1lID0gJ1RlbGVwb3J0Qm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdwb2lzb24nOiBuYW1lID0gJ1Bvc2lvbkJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna2lsbExhS2lsbCc6IG5hbWUgPSAnS2lsbEJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnZGlydCc6IG5hbWUgPSAnRGlydEJvbWInCiAgICAgICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnZ29sZGVuQm9tYic6IG5hbWUgPSAnQmxhc3R5Qm9tYicKICAgICAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2VUcmlvJzogbmFtZSA9ICdTdGlja3lJY2VUcmlvJwogICAgICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2FudGlHcmF2JzogbmFtZSA9ICdhbnRpR3JhdicKICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgZG9uLnNoaWVsZEJvbWI6ICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLnNoaWVsZCA9IGJzLm5ld05vZGUoJ3NoaWVsZCcsIG93bmVyPXNlbGYubm9kZSwKICAgICAgICAgICAgICAgIGF0dHJzPXsnY29sb3InOigwLDAsMSksJ3JhZGl1cyc6MC45fSkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb24nLCBzZWxmLnNoaWVsZCwgJ3Bvc2l0aW9uJykgICAKICAgICAgICAgICAgICAgIGJzLmFuaW1hdGUoc2VsZi5zaGllbGQsJ3JhZGl1cycsezA6MC45LDIwMDoxLDQwMDowLjl9LFRydWUpCiAgICAgICAgICAgICAgICBic1V0aWxzLmFuaW1hdGVBcnJheShzZWxmLnNoaWVsZCwgJ2NvbG9yJywgMywgcHJlZml4QW5pbSwgVHJ1ZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiBkb24uYm9tYkxpZ2h0czoKICAgICAgICAgICAgICAgIHNlbGYubm9kZUxpZ2h0ID0gYnMubmV3Tm9kZSgnbGlnaHQnLAogICAgICAgICAgICAgICAgYXR0cnM9eydwb3NpdGlvbic6IHNlbGYubm9kZS5wb3NpdGlvbiwKICAgICAgICAgICAgICAgICdjb2xvcic6ICgwLDAsMSksJ3JhZGl1cyc6IDAuMSwndm9sdW1lSW50ZW5zaXR5U2NhbGUnOiAwLjJ9KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNlbGYubm9kZUxpZ2h0LCAncG9zaXRpb24nKQogICAgICAgICAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZUxpZ2h0LCdjb2xvcicsMyx7MDooMCwwLDIpLDUwMDooMCwyLDApLDEwMDA6KDIsMCwwKSwxNTAwOigyLDIsMCksMjAwMDooMiwwLDIpLDI1MDA6KDAsMSw2KSwzMDAwOigxLDIsMCl9LFRydWUpIAogICAgICAgICAgICAgICAgI2JzLmFuaW1hdGUoc2VsZi5ub2RlTGlnaHQsICJpbnRlbnNpdHkiLCB7MDoxLjAsIDEwMDA6MS44LCAyMDAwOjEuMH0sIGxvb3AgPSBUcnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiBkb24uYm9tYk5hbWU6CiAgICAgICAgICAgICAgICBtID0gYnMubmV3Tm9kZSgnbWF0aCcsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9eydpbnB1dDEnOiAoMCwgMC43LCAwKSwgJ29wZXJhdGlvbic6ICdhZGQnfSkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb24nLCBtLCAnaW5wdXQyJykKICAgICAgICAgICAgICAgIHNlbGYubm9kZVRleHQgPSBicy5uZXdOb2RlKCd0ZXh0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyPXNlbGYubm9kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsndGV4dCc6IHN0cihuYW1lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaW5Xb3JsZCc6IFRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NoYWRvdyc6IDEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmxhdG5lc3MnOiAxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbG9yJzogKDAsMCwxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2NhbGUnOiAwLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBbGlnbic6ICdjZW50ZXInfSkKICAgICAgICAgICAgICAgIG0uY29ubmVjdEF0dHIoJ291dHB1dCcsIHNlbGYubm9kZVRleHQsICdwb3NpdGlvbicpCiAgICAgICAgICAgICAgICBicy5hbmltYXRlKHNlbGYubm9kZVRleHQsICdzY2FsZScsIHswOiAwLCAxNDA6IDAuMDE2LCAyMDA6IDAuMDF9KQogICAgICAgICAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZVRleHQsJ2NvbG9yJywzLHswOigyLDIsMCksNjAwOigyLDAsMCksOTAwOigwLDIsMCksMTIwMDooMCwwLDIpLDE1MDA6KDIsMCwyKSwKICAgICAgICAxODAwOigyLDEsMCksMjEwMDooMCwyLDIpLDI0MDA6KDIsMiwwKX0sVHJ1ZSkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZVRleHQucG9zaXRpb24sIHZlbG9jaXR5PXNlbGYubm9kZS5wb3NpdGlvbiwgY291bnQ9MjAwLCBzY2FsZT0xLjQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJlYWQ9Mi4wMSwgY2h1bmtUeXBlPSdzcGFyaycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgZG9uLnBvd2VydXBUaW1lcjoKICAgICAgICAgICAgICAgIGRlZmF1bHRQb3dlcnVwSW50ZXJ2YWwgPSA0MDAwCiAgICAgICAgICAgICAgICBzZWxmLnBvd2VydXBIdXJ0ID0gYnMubmV3Tm9kZSgnc2hpZWxkJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17J2NvbG9yJzooMSwxLDEpLCAncmFkaXVzJzowLjEsICdodXJ0JzoxLCAnYWx3YXlzU2hvd0hlYWx0aEJhcic6VHJ1ZX0pCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29ubmVjdEF0dHIoJ3Bvc2l0aW9uJyxzZWxmLnBvd2VydXBIdXJ0LCAncG9zaXRpb24nKQogICAgICAgICAgICAgICAgYnMuYW5pbWF0ZShzZWxmLnBvd2VydXBIdXJ0LCAnaHVydCcsIHswOjAsIGRlZmF1bHRQb3dlcnVwSW50ZXJ2YWwtMTAwMDoxfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKGRlZmF1bHRQb3dlcnVwSW50ZXJ2YWwtMTAwMCwgYnMuQ2FsbChzZWxmLmRvX2RlbGV0ZSkpCiAgICAgICAgICAgIAogICAgICAgICAgICAnJycKICAgICAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnbm9ybWFsJzogCiAgICAgICAgICAgICAgICBjdXJ2ZSA9IGJzVXRpbHMuYW5pbWF0ZShzZWxmLm5vZGUsIm1vZGVsU2NhbGUiLHswOjAsIDIwMDoxLjMsIDI2MDoxfSkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyMDAsY3VydmUuZGVsZXRlKQogICAgICAgICAgICAnJycKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIGRvbi5ib21iU2l6ZTogICAgICAgIAogICAgICAgICAgICBjdXJ2ZSA9IGJzVXRpbHMuYW5pbWF0ZShzZWxmLm5vZGUsIm1vZGVsU2NhbGUiLHswOjAsIDIwMDoxLjMsIDI2MDoxfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDIwMCxjdXJ2ZS5kZWxldGUpCgogICAgZGVmIGdldFNvdXJjZVBsYXllcihzZWxmKToKICAgICAgICAiIiIKICAgICAgICBSZXR1cm5zIGEgYnMuUGxheWVyIHJlcHJlc2VudGluZyB0aGUgc291cmNlIG9mIHRoaXMgYm9tYi4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLnNvdXJjZVBsYXllciBpcyBOb25lOiByZXR1cm4gYnMuUGxheWVyKE5vbmUpICMgZW1wdHkgcGxheWVyIHJlZgogICAgICAgIHJldHVybiBzZWxmLnNvdXJjZVBsYXllcgogICAgICAgIAogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZ2V0RmFjdG9yeShjbHMpOgogICAgICAgICIiIgogICAgICAgIFJldHVybnMgYSBzaGFyZWQgYnMuQm9tYkZhY3Rvcnkgb2JqZWN0LCBjcmVhdGluZyBpdCBpZiBuZWNlc3NhcnkuCiAgICAgICAgIiIiCiAgICAgICAgYWN0aXZpdHkgPSBicy5nZXRBY3Rpdml0eSgpCiAgICAgICAgdHJ5OiByZXR1cm4gYWN0aXZpdHkuX3NoYXJlZEJvbWJGYWN0b3J5CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgZiA9IGFjdGl2aXR5Ll9zaGFyZWRCb21iRmFjdG9yeSA9IEJvbWJGYWN0b3J5KCkKICAgICAgICAgICAgcmV0dXJuIGYKICAgICAgICAgICAgCiAgICBkZWYgZG9fZGVsZXRlKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBoYXNhdHRyKHNlbGYsICJsaWdodCIpIGFuZCBzZWxmLmxpZ2h0LmV4aXN0cygpOiAKICAgICAgICAgICAgICAgIGJzLmFuaW1hdGUoc2VsZi5saWdodCwgInJhZGl1cyIsIHswOjAuMDc4LCAxMDA6MH0pCiAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIoMTAwLCBzZWxmLmxpZ2h0LmRlbGV0ZSkKICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAicG93ZXJ1cEh1cnQiKSBhbmQgc2VsZi5wb3dlcnVwSHVydC5leGlzdHMoKToKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAsIHNlbGYucG93ZXJ1cEh1cnQuZGVsZXRlKQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEwMCxzZWxmLm5vZGVMaWdodC5kZWxldGUpCgogICAgZGVmIG9uRmluYWxpemUoc2VsZik6CiAgICAgICAgYnMuQWN0b3Iub25GaW5hbGl6ZShzZWxmKQogICAgICAgICMgcmVsZWFzZSBjYWxsYmFja3MvcmVmcyBzbyB3ZSBkb24ndCB3aW5kIHVwIHdpdGggZGVwZW5kZW5jeSBsb29wcy4uCiAgICAgICAgc2VsZi5fZXhwbG9kZUNhbGxiYWNrcyA9IFtdCiAgICAgICAgCiAgICBkZWYgX2hhbmRsZURpZShzZWxmLG0pOgogICAgICAgIHNlbGYubm9kZS5kZWxldGUoKQogICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgIl90aW1lciIpIGFuZCBzZWxmLl90aW1lciBpcyBub3QgTm9uZSBhbmQgc2VsZi5fdGltZXIuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYuX3RpbWVyLmRlbGV0ZSgpCiAgICAgICAgICAgIHNlbGYuX3RpbWVyID0gTm9uZQogICAgICAgIAogICAgZGVmIF9oYW5kbGVPT0Ioc2VsZiwgbXNnKToKICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UoYnMuRGllTWVzc2FnZSgpKQoKICAgIGRlZiBfaGFuZGxlSW1wYWN0KHNlbGYsbSk6CiAgICAgICAgbm9kZSxib2R5ID0gYnMuZ2V0Q29sbGlzaW9uSW5mbygib3Bwb3NpbmdOb2RlIiwib3Bwb3NpbmdCb2R5IikKICAgICAgICAjIGlmIHdlJ3JlIGFuIGltcGFjdCBib21iIGFuZCB3ZSBjYW1lIGZyb20gdGhpcyBub2RlLCBkb24ndCBleHBsb2RlLi4uCiAgICAgICAgIyBhbHRlcm5hdGVseSBpZiB3ZSdyZSBoaXR0aW5nIGFub3RoZXIgaW1wYWN0LWJvbWIgZnJvbSB0aGUgc2FtZSBzb3VyY2UsCiAgICAgICAgIyBkb24ndCBleHBsb2RlLi4uCiAgICAgICAgdHJ5OiBub2RlRGVsZWdhdGUgPSBub2RlLmdldERlbGVnYXRlKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOiBub2RlRGVsZWdhdGUgPSBOb25lCiAgICAgICAgaWYgbm9kZSBpcyBub3QgTm9uZSBhbmQgbm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2ltcGFjdCcgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLmJvbWJUeXBlID09ICdpbXBhY3QnCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2ljZUltcGFjdCcgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5ib21iVHlwZSA9PSAnaWNlSW1wYWN0JwogICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICMgTG9vayBvbiBsYXN0IGNvbW1lbnQgICAKICAgICAgICAgICAgZWxpZiAoc2VsZi5ib21iVHlwZSA9PSAndGJvbWInIGFuZAogICAgICAgICAgICAgICAgKG5vZGUgaXMgc2VsZi5vd25lcgogICAgICAgICAgICAgICAgIG9yIChpc2luc3RhbmNlKG5vZGVEZWxlZ2F0ZSwgQm9tYikKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5ib21iVHlwZSA9PSAndGJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2dsdWVib21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ2dsdWVib21iJwogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLm93bmVyIGlzIHNlbGYub3duZXIpKSk6IHJldHVybiAgICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ3dlZWRib21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ3dlZWRib21iJwogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLm93bmVyIGlzIHNlbGYub3duZXIpKSk6IHJldHVybiAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2N1cnNlQm9tYicgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLmJvbWJUeXBlID09ICdjdXJzZUJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAKICAgICAgICAgICAgZWxpZiAoc2VsZi5ib21iVHlwZSA9PSAna25vY2tCb21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ2tub2NrQm9tYicKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5vd25lciBpcyBzZWxmLm93bmVyKSkpOiByZXR1cm4gICAgICAgIAogICAgICAgICAgICBlbGlmIChzZWxmLmJvbWJUeXBlID09ICdoZWFsQm9tYicgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLmJvbWJUeXBlID09ICdoZWFsQm9tYicKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5vd25lciBpcyBzZWxmLm93bmVyKSkpOiByZXR1cm4gICAgICAgICAgIAogICAgICAgICAgICBlbGlmIChzZWxmLmJvbWJUeXBlID09ICdjaGFyYWN0ZXJCb21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ2NoYXJhY3RlckJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ21qQm9tYicgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLmJvbWJUeXBlID09ICdtakJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2ljeVRyaW8nIGFuZAogICAgICAgICAgICAgICAgKG5vZGUgaXMgc2VsZi5vd25lcgogICAgICAgICAgICAgICAgIG9yIChpc2luc3RhbmNlKG5vZGVEZWxlZ2F0ZSwgQm9tYikKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5ib21iVHlwZSA9PSAnaWN5VHJpbycKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5vd25lciBpcyBzZWxmLm93bmVyKSkpOiByZXR1cm4gICAgICAgICAKICAgICAgICAgICAgZWxpZiAoc2VsZi5ib21iVHlwZSA9PSAnYm9vbUJvbWInIGFuZAogICAgICAgICAgICAgICAgKG5vZGUgaXMgc2VsZi5vd25lcgogICAgICAgICAgICAgICAgIG9yIChpc2luc3RhbmNlKG5vZGVEZWxlZ2F0ZSwgQm9tYikKICAgICAgICAgICAgICAgICAgICAgYW5kIG5vZGVEZWxlZ2F0ZS5ib21iVHlwZSA9PSAnYm9vbUJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ3RyaW9Cb21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ3RyaW9Cb21iJwogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLm93bmVyIGlzIHNlbGYub3duZXIpKSk6IHJldHVybiAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ3NwZWVkQm9tYicgYW5kCiAgICAgICAgICAgICAgICAobm9kZSBpcyBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLmJvbWJUeXBlID09ICdzcGVlZEJvbWInCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ3NwYXpCb21iJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ3NwYXpCb21iJwogICAgICAgICAgICAgICAgICAgICBhbmQgbm9kZURlbGVnYXRlLm93bmVyIGlzIHNlbGYub3duZXIpKSk6IHJldHVybiAgIAogICAgICAgICAgICBlbGlmIChzZWxmLmJvbWJUeXBlID09ICdzdGlja3lJY2VUcmlvJyBhbmQKICAgICAgICAgICAgICAgIChub2RlIGlzIHNlbGYub3duZXIKICAgICAgICAgICAgICAgICBvciAoaXNpbnN0YW5jZShub2RlRGVsZWdhdGUsIEJvbWIpCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ3N0aWNreUljZVRyaW8nCiAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuICAgCiAgICAgICAgICAgIGVsaWYgKHNlbGYuYm9tYlR5cGUgPT0gJ2FudGlHcmF2JyBhbmQKICAgICAgICAgICAgICAgICAgKG5vZGUgaXMgc2VsZi5vd25lcgogICAgICAgICAgICAgICAgICAgb3IgKGlzaW5zdGFuY2Uobm9kZURlbGVnYXRlLCBCb21iKQogICAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUuYm9tYlR5cGUgPT0gJ2FudGlHcmF2JwogICAgICAgICAgICAgICAgICAgICAgIGFuZCBub2RlRGVsZWdhdGUub3duZXIgaXMgc2VsZi5vd25lcikpKTogcmV0dXJuCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UoRXhwbG9kZU1lc3NhZ2UoKSkKICAgICAgICAgICAgICAgIAogICAgZGVmIF9oYW5kbGVEaWUoc2VsZiwgbXNnKToKICAgICAgICBpZiBzZWxmLmJvbWJUeXBlID09ICJhbnRpR3JhdiIgYW5kIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgYWdhID0gQW50aUdyYXZBcmVhKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbiwgcmFkaXVzPXNlbGYuYmxhc3RSYWRpdXMpCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcig3MDAwLCBhZ2EuZGVsZXRlKQogICAgICAgIHNlbGYubm9kZS5kZWxldGUoKQoKICAgIGRlZiBfaGFuZGxlRHJvcHBlZChzZWxmLG0pOgogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2JhbGxvbic6CiAgICAgICAgICAgIHNlbGYuaGFuZGxlTWVzc2FnZShicy5EaWVNZXNzYWdlKCkpCiAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAnbGFuZE1pbmUnOgogICAgICAgICAgICBzZWxmLmFybVRpbWVyID0gXAogICAgICAgICAgICAgICAgYnMuVGltZXIoMTI1MCwgYnMuV2Vha0NhbGwoc2VsZi5oYW5kbGVNZXNzYWdlLCBBcm1NZXNzYWdlKCkpKQoKICAgICAgICAjIG9uY2Ugd2UndmUgdGhyb3duIGEgc3RpY2t5IGJvbWIgd2UgY2FuIHN0aWNrIHRvIGl0Li4KICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3N0aWNreSc6CiAgICAgICAgICAgIGRlZiBfc2FmZVNldEF0dHIobm9kZSxhdHRyLHZhbHVlKToKICAgICAgICAgICAgICAgIGlmIG5vZGUuZXhpc3RzKCk6IHNldGF0dHIobm9kZSxhdHRyLHZhbHVlKQogICAgICAgICAgICBicy5nYW1lVGltZXIoCiAgICAgICAgICAgICAgICAyNTAsIGxhbWJkYTogX3NhZmVTZXRBdHRyKHNlbGYubm9kZSwgJ3N0aWNrVG9Pd25lcicsIFRydWUpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5SWNlJzoKICAgICAgICAgICAgZGVmIF9zYWZlU2V0QXR0cihub2RlLGF0dHIsdmFsdWUpOgogICAgICAgICAgICAgICAgaWYgbm9kZS5leGlzdHMoKTogc2V0YXR0cihub2RlLGF0dHIsdmFsdWUpCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigKICAgICAgICAgICAgICAgIDI1MCwgbGFtYmRhOiBfc2FmZVNldEF0dHIoc2VsZi5ub2RlLCAnc3RpY2tUb093bmVyJywgVHJ1ZSkpCgogICAgZGVmIF9oYW5kbGVTcGxhdChzZWxmLG0pOgogICAgICAgIG5vZGUgPSBicy5nZXRDb2xsaXNpb25JbmZvKCJvcHBvc2luZ05vZGUiKQogICAgICAgIGlmIChub2RlIGlzIG5vdCBzZWxmLm93bmVyCiAgICAgICAgICAgICAgICBhbmQgYnMuZ2V0R2FtZVRpbWUoKSAtIHNlbGYuX2xhc3RTdGlja3lTb3VuZFRpbWUgPiAxMDAwKToKICAgICAgICAgICAgc2VsZi5fbGFzdFN0aWNreVNvdW5kVGltZSA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnN0aWNreUltcGFjdFNvdW5kLCAyLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCgogICAgZGVmIGFkZEV4cGxvZGVDYWxsYmFjayhzZWxmLGNhbGwpOgogICAgICAgICIiIgogICAgICAgIEFkZCBhIGNhbGwgdG8gYmUgcnVuIHdoZW4gdGhlIGJvbWIgaGFzIGV4cGxvZGVkLgogICAgICAgIFRoZSBib21iIGFuZCB0aGUgbmV3IGJsYXN0IG9iamVjdCBhcmUgcGFzc2VkIGFzIGFyZ3VtZW50cy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9leHBsb2RlQ2FsbGJhY2tzLmFwcGVuZChjYWxsKQogICAgICAgIAogICAgZGVmIGV4cGxvZGUoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQmxvd3MgdXAgdGhlIGJvbWIgaWYgaXQgaGFzIG5vdCB5ZXQgZG9uZSBzby4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl9leHBsb2RlZCBhbmQgc2VsZi5ib21iVHlwZSBub3QgaW4gWydxcSddOiByZXR1cm4KICAgICAgICBzZWxmLl9leHBsb2RlZCA9IFRydWUKICAgICAgICBhY3Rpdml0eSA9IHNlbGYuZ2V0QWN0aXZpdHkoKQogICAgICAgIGlmIGFjdGl2aXR5IGlzIG5vdCBOb25lIGFuZCBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgCWlmIHNlbGYuYm9tYlR5cGUgPT0gJ3Rib21iJzoKICAgICAgICAJICAgIHNlbGYub3duZXIuaGFuZGxlTWVzc2FnZShicy5TdGFuZE1lc3NhZ2UoKHNlbGYubm9kZS5wb3NpdGlvblswXSxzZWxmLm5vZGUucG9zaXRpb25bMV0tMC45LHNlbGYubm9kZS5wb3NpdGlvblsyXSkpKQogICAgICAgIAlibGFzdCA9IEJsYXN0KHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT1zZWxmLm5vZGUudmVsb2NpdHksYmxhc3RSYWRpdXM9c2VsZi5ibGFzdFJhZGl1cyxibGFzdFR5cGU9c2VsZi5ib21iVHlwZSxzb3VyY2VQbGF5ZXI9c2VsZi5zb3VyY2VQbGF5ZXIsaGl0VHlwZT1zZWxmLmhpdFR5cGUsaGl0U3ViVHlwZT1zZWxmLmhpdFN1YlR5cGUpLmF1dG9SZXRhaW4oKQogICAgICAgIGZvciBjIGluIHNlbGYuX2V4cGxvZGVDYWxsYmFja3M6IGMoc2VsZixibGFzdCkKICAgICAgICAgICAgCiAgICAgICAgIyB3ZSBibGV3IHVwIHNvIHdlIG5lZWQgdG8gZ28gYXdheQogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgbm90IGluIFsncXEnXTogYnMuZ2FtZVRpbWVyKDEsIGJzLldlYWtDYWxsKHNlbGYuaGFuZGxlTWVzc2FnZSwgYnMuRGllTWVzc2FnZSgpKSkKICAgICAgICAgIAogICAgZGVmIF9oYW5kbGVXYXJuKHNlbGYsIG0pOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi50ZXh0dXJlU2VxdWVuY2UuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZS5yYXRlID0gMzAKICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChzZWxmLmdldEZhY3RvcnkoKS53YXJuU291bmQsIDAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgZWxzZTogcmV0dXJuCgogICAgZGVmIF9hZGRNYXRlcmlhbChzZWxmLCBtYXRlcmlhbCk6CiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgbWF0ZXJpYWxzID0gc2VsZi5ub2RlLm1hdGVyaWFscwogICAgICAgIGlmIG5vdCBtYXRlcmlhbCBpbiBtYXRlcmlhbHM6CiAgICAgICAgICAgIHNlbGYubm9kZS5tYXRlcmlhbHMgPSBtYXRlcmlhbHMgKyAobWF0ZXJpYWwsKQogICAgICAgIAogICAgZGVmIGFybShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBBcm1zIGxhbmQtbWluZXMgYW5kIGltcGFjdC1ib21icyBzbwogICAgICAgIHRoYXQgdGhleSB3aWxsIGV4cGxvZGUgb24gaW1wYWN0LgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQogICAgICAgIGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2xhbmRNaW5lJzoKICAgICAgICAgICAgc2VsZi50ZXh0dXJlU2VxdWVuY2UgPSBcCiAgICAgICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0dXJlU2VxdWVuY2UnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICAgICAncmF0ZSc6MzAsCiAgICAgICAgICAgICAgICAgICAgJ2lucHV0VGV4dHVyZXMnOihmYWN0b3J5LmxhbmRNaW5lTGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZVRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAwLHNlbGYudGV4dHVyZVNlcXVlbmNlLmRlbGV0ZSkKICAgICAgICAgICAgIyB3ZSBub3cgbWFrZSBpdCBleHBsb2RhYmxlLgogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLGJzLldlYWtDYWxsKHNlbGYuX2FkZE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubGFuZE1pbmVCbGFzdE1hdGVyaWFsKSkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ltcGFjdCc6CiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaWNlSW1wYWN0JzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnbWpCb21iJzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaWN5VHJpbyc6IyBTZXF1ZW5jZSBvZiB0ZXh0dXJlcwogICAgICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZSA9IFwKICAgICAgICAgICAgICAgIGJzLm5ld05vZGUoJ3RleHR1cmVTZXF1ZW5jZScsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgICAgICdyYXRlJzoxMDAsCiAgICAgICAgICAgICAgICAgICAgJ2lucHV0VGV4dHVyZXMnOihmYWN0b3J5LmltcGFjdExpdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgpfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI1MCwgYnMuV2Vha0NhbGwoc2VsZi5fYWRkTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubGFuZE1pbmVCbGFzdE1hdGVyaWFsKSkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2Jvb21Cb21iJzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnc3RpY2t5SWNlVHJpbyc6IyBTZXF1ZW5jZSBvZiB0ZXh0dXJlcwogICAgICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZSA9IFwKICAgICAgICAgICAgICAgIGJzLm5ld05vZGUoJ3RleHR1cmVTZXF1ZW5jZScsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgICAgICdyYXRlJzoxMDAsCiAgICAgICAgICAgICAgICAgICAgJ2lucHV0VGV4dHVyZXMnOihmYWN0b3J5LmltcGFjdExpdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgpfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI1MCwgYnMuV2Vha0NhbGwoc2VsZi5fYWRkTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubGFuZE1pbmVCbGFzdE1hdGVyaWFsKSkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RyaW9Cb21iJzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY3Vyc2VCb21iJzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaGVhbEJvbWInOiMgU2VxdWVuY2Ugb2YgdGV4dHVyZXMKICAgICAgICAgICAgc2VsZi50ZXh0dXJlU2VxdWVuY2UgPSBcCiAgICAgICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0dXJlU2VxdWVuY2UnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICAgICAncmF0ZSc6MTAwLAogICAgICAgICAgICAgICAgICAgICdpbnB1dFRleHR1cmVzJzooZmFjdG9yeS5pbXBhY3RMaXRUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4KX0pCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyNTAsIGJzLldlYWtDYWxsKHNlbGYuX2FkZE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmxhbmRNaW5lQmxhc3RNYXRlcmlhbCkpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdrbm9ja0JvbWInOiMgU2VxdWVuY2Ugb2YgdGV4dHVyZXMKICAgICAgICAgICAgc2VsZi50ZXh0dXJlU2VxdWVuY2UgPSBcCiAgICAgICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0dXJlU2VxdWVuY2UnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICAgICAncmF0ZSc6MTAwLAogICAgICAgICAgICAgICAgICAgICdpbnB1dFRleHR1cmVzJzooZmFjdG9yeS5pbXBhY3RMaXRUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4KX0pCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyNTAsIGJzLldlYWtDYWxsKHNlbGYuX2FkZE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmxhbmRNaW5lQmxhc3RNYXRlcmlhbCkpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdjaGFyYWN0ZXJCb21iJzojIFNlcXVlbmNlIG9mIHRleHR1cmVzCiAgICAgICAgICAgIHNlbGYudGV4dHVyZVNlcXVlbmNlID0gXAogICAgICAgICAgICAgICAgYnMubmV3Tm9kZSgndGV4dHVyZVNlcXVlbmNlJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17CiAgICAgICAgICAgICAgICAgICAgJ3JhdGUnOjEwMCwKICAgICAgICAgICAgICAgICAgICAnaW5wdXRUZXh0dXJlcyc6KGZhY3RvcnkuaW1wYWN0TGl0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCl9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMjUwLCBicy5XZWFrQ2FsbChzZWxmLl9hZGRNYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5sYW5kTWluZUJsYXN0TWF0ZXJpYWwpKQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnd2VlZGJvbWInOgogICAgICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZSA9IFwKICAgICAgICAgICAgICAgIGJzLm5ld05vZGUoJ3RleHR1cmVTZXF1ZW5jZScsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgICAgICdyYXRlJzoxMDAsCiAgICAgICAgICAgICAgICAgICAgJ2lucHV0VGV4dHVyZXMnOihmYWN0b3J5LmltcGFjdExpdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgpfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI1MCwgYnMuV2Vha0NhbGwoc2VsZi5fYWRkTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubGFuZE1pbmVCbGFzdE1hdGVyaWFsKSkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2dsdWVib21iJzoKICAgICAgICAgICAgc2VsZi50ZXh0dXJlU2VxdWVuY2UgPSBcCiAgICAgICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0dXJlU2VxdWVuY2UnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICAgICAncmF0ZSc6MTAwLAogICAgICAgICAgICAgICAgICAgICdpbnB1dFRleHR1cmVzJzooZmFjdG9yeS5pbXBhY3RMaXRUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4KX0pCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyNTAsIGJzLldlYWtDYWxsKHNlbGYuX2FkZE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmxhbmRNaW5lQmxhc3RNYXRlcmlhbCkpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGVlZEJvbWInOgogICAgICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZSA9IFwKICAgICAgICAgICAgICAgIGJzLm5ld05vZGUoJ3RleHR1cmVTZXF1ZW5jZScsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9ewogICAgICAgICAgICAgICAgICAgICdyYXRlJzoxMDAsCiAgICAgICAgICAgICAgICAgICAgJ2lucHV0VGV4dHVyZXMnOihmYWN0b3J5LmltcGFjdExpdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5pbXBhY3RUZXgpfSkKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDI1MCwgYnMuV2Vha0NhbGwoc2VsZi5fYWRkTWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubGFuZE1pbmVCbGFzdE1hdGVyaWFsKSkKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3NwYXpCb21iJzoKICAgICAgICAgICAgc2VsZi50ZXh0dXJlU2VxdWVuY2UgPSBcCiAgICAgICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0dXJlU2VxdWVuY2UnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsKICAgICAgICAgICAgICAgICAgICAncmF0ZSc6MTAwLAogICAgICAgICAgICAgICAgICAgICdpbnB1dFRleHR1cmVzJzooZmFjdG9yeS5pbXBhY3RMaXRUZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmltcGFjdFRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkuaW1wYWN0VGV4KX0pCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyNTAsIGJzLldlYWtDYWxsKHNlbGYuX2FkZE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5LmxhbmRNaW5lQmxhc3RNYXRlcmlhbCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCdhcm0oKSBzaG91bGQgb25seSBiZSBjYWxsZWQgJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29uIGxhbmQtbWluZXMgb3IgaW1wYWN0IGJvbWJzJykKICAgICAgICBzZWxmLnRleHR1cmVTZXF1ZW5jZS5jb25uZWN0QXR0cignb3V0cHV0VGV4dHVyZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLCAnY29sb3JUZXh0dXJlJykKICAgICAgICBicy5wbGF5U291bmQoZmFjdG9yeS5hY3RpdmF0ZVNvdW5kLCAwLjUsIHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICAKICAgIGRlZiBfaGFuZGxlSGl0KHNlbGYsIG1zZyk6CiAgICAgICAgaXNQdW5jaCA9IChtc2cuc3JjTm9kZS5leGlzdHMoKSBhbmQgbXNnLnNyY05vZGUuZ2V0Tm9kZVR5cGUoKSA9PSAnc3BheicpCiAgICAgICAgaWYgc2VsZi5ib21iVHlwZSA9PSAncXEnOgogICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1tc2cucG9zLCB2ZWxvY2l0eT0oMSArIHJhbmRvbS5yYW5kb20oKSwgMSArIHJhbmRvbS5yYW5kb20oKSwgMSArIHJhbmRvbS5yYW5kb20oKSksIGNvdW50ID0gNTAgKyByYW5kb20ucmFuZHJhbmdlKDEwLDEwMCksIHNwcmVhZD0wLjgsIHNjYWxlPTAuNiwgY2h1bmtUeXBlID0gJ3NwYXJrJyk7CiAgICAgICAgIyBub3JtYWwgYm9tYnMgYXJlIHRyaWdnZXJlZCBieSBub24tcHVuY2ggaW1wYWN0cy4uCiAgICAgICAgIyBpbXBhY3QtYm9tYnMgYnkgYWxsIGltcGFjdHMKICAgICAgICBpZiAobm90IHNlbGYuX2V4cGxvZGVkIGFuZCBub3QgaXNQdW5jaAogICAgICAgICAgICBvciBzZWxmLmJvbWJUeXBlIGluIFsnaW1wYWN0JywgJ2xhbmRNaW5lJywnaWNlSW1wYWN0JywnZ2x1ZWJvbWInLCd3ZWVkYm9tYicsJ2N1cnNlQm9tYicsJ2tub2NrQm9tYicsJ2hlYWxCb21iJywnY2hhcmFjdGVyQm9tYicsJ21qQm9tYicsJ3RyaW9Cb21iJywnc3BlZWRCb21iJywnc3BhekJvbWInLCdib29tQm9tYicsJ2ljeVRyaW8nLCdzdGlja3lJY2VUcmlvJywnYW50aUdyYXYnXSk6CiAgICAgICAgICAgICMgYWxzbyBsZXRzIGNoYW5nZSB0aGUgb3duZXIgb2YgdGhlIGJvbWIgdG8gd2hvZXZlciBpcyBzZXR0aW5nCiAgICAgICAgICAgICMgdXMgb2ZmLi4gKHRoaXMgd2F5IHBvaW50cyBmb3IgYmlnIGNoYWluIHJlYWN0aW9ucyBnbyB0byB0aGUKICAgICAgICAgICAgIyBwZXJzb24gY2F1c2luZyB0aGVtKQogICAgICAgICAgICBpZiBtc2cuc291cmNlUGxheWVyIG5vdCBpbiBbTm9uZV06CiAgICAgICAgICAgICAgICBzZWxmLnNvdXJjZVBsYXllciA9IG1zZy5zb3VyY2VQbGF5ZXIKCiAgICAgICAgICAgICAgICAjIGFsc28gaW5oZXJpdCB0aGUgaGl0IHR5cGUgKGlmIGEgbGFuZG1pbmUgc2V0cyBvZmYgYnkgYSBib21iLAogICAgICAgICAgICAgICAgIyB0aGUgY3JlZGl0IHNob3VsZCBnbyB0byB0aGUgbWluZSkKICAgICAgICAgICAgICAgICMgdGhlIGV4Y2VwdGlvbiBpcyBUTlQuICBUTlQgYWx3YXlzIGdldHMgY3JlZGl0LgogICAgICAgICAgICAgICAgaWYgc2VsZi5ib21iVHlwZSAhPSAndG50JzoKICAgICAgICAgICAgICAgICAgICBzZWxmLmhpdFR5cGUgPSBtc2cuaGl0VHlwZQogICAgICAgICAgICAgICAgICAgIHNlbGYuaGl0U3ViVHlwZSA9IG1zZy5oaXRTdWJUeXBlCgogICAgICAgICAgICBicy5nYW1lVGltZXIoMTAwK2ludChyYW5kb20ucmFuZG9tKCkqMTAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuaGFuZGxlTWVzc2FnZSwgRXhwbG9kZU1lc3NhZ2UoKSkpCiAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoCiAgICAgICAgICAgICJpbXB1bHNlIiwgbXNnLnBvc1swXSwgbXNnLnBvc1sxXSwgbXNnLnBvc1syXSwKICAgICAgICAgICAgbXNnLnZlbG9jaXR5WzBdLCBtc2cudmVsb2NpdHlbMV0sIG1zZy52ZWxvY2l0eVsyXSwKICAgICAgICAgICAgbXNnLm1hZ25pdHVkZSwgbXNnLnZlbG9jaXR5TWFnbml0dWRlLCBtc2cucmFkaXVzLCAwLAogICAgICAgICAgICBtc2cudmVsb2NpdHlbMF0sIG1zZy52ZWxvY2l0eVsxXSwgbXNnLnZlbG9jaXR5WzJdKQoKICAgICAgICBpZiBtc2cuc3JjTm9kZS5leGlzdHMoKToKICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgZGVmIGhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKToKICAgICAgICBpZiBpc2luc3RhbmNlKG1zZywgRXhwbG9kZU1lc3NhZ2UpOiBzZWxmLmV4cGxvZGUoKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIEltcGFjdE1lc3NhZ2UpOiBzZWxmLl9oYW5kbGVJbXBhY3QobXNnKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIGJzLlBpY2tlZFVwTWVzc2FnZSk6CiAgICAgICAgICAgICMgY2hhbmdlIG91ciBzb3VyY2UgdG8gd2hvZXZlciBqdXN0IHBpY2tlZCB1cyB1cCAqb25seSogaWYgaXRzIE5vbmUKICAgICAgICAgICAgIyB0aGlzIHdheSB3ZSBjYW4gZ2V0IHBvaW50cyBmb3Iga2lsbGluZyBib3RzIHdpdGggdGhlaXIgb3duIGJvbWJzCiAgICAgICAgICAgICMgaG1tIHdvdWxkIHRoZXJlIGJlIGEgZG93bnNpZGUgdG8gdGhpcz8uLi4KICAgICAgICAgICAgaWYgc2VsZi5zb3VyY2VQbGF5ZXIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBzZWxmLnNvdXJjZVBsYXllciA9IG1zZy5ub2RlLnNvdXJjZVBsYXllcgogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIFNwbGF0TWVzc2FnZSk6IHNlbGYuX2hhbmRsZVNwbGF0KG1zZykKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5Ecm9wcGVkTWVzc2FnZSk6IHNlbGYuX2hhbmRsZURyb3BwZWQobXNnKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIGJzLkhpdE1lc3NhZ2UpOiBzZWxmLl9oYW5kbGVIaXQobXNnKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIGJzLkRpZU1lc3NhZ2UpOiBzZWxmLl9oYW5kbGVEaWUobXNnKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIGJzLk91dE9mQm91bmRzTWVzc2FnZSk6IHNlbGYuX2hhbmRsZU9PQihtc2cpCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgQXJtTWVzc2FnZSk6IHNlbGYuYXJtKCkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBXYXJuTWVzc2FnZSk6IHNlbGYuX2hhbmRsZVdhcm4obXNnKQogICAgICAgIGVsc2U6IGJzLkFjdG9yLmhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKQoKY2xhc3MgVE5UU3Bhd25lcihvYmplY3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogR2FtZSBGbG93IENsYXNzZXMKCiAgICBSZWdlbmVyYXRlcyBUTlQgYXQgYSBnaXZlbiBwb2ludCBpbiBzcGFjZSBldmVyeSBub3cgYW5kIHRoZW4uCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLHBvc2l0aW9uLHJlc3Bhd25UaW1lPTMwMDAwKToKICAgICAgICAiIiIKICAgICAgICBJbnN0YW50aWF0ZSB3aXRoIGEgZ2l2ZW4gcG9zaXRpb24gYW5kIHJlc3Bhd25UaW1lIChpbiBtaWxsaXNlY29uZHMpLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX3Bvc2l0aW9uID0gcG9zaXRpb24KICAgICAgICBzZWxmLl90bnQgPSBOb25lCiAgICAgICAgc2VsZi5fdXBkYXRlKCkKICAgICAgICBzZWxmLl91cGRhdGVUaW1lciA9IGJzLlRpbWVyKDEwMDAsYnMuV2Vha0NhbGwoc2VsZi5fdXBkYXRlKSxyZXBlYXQ9VHJ1ZSkKICAgICAgICBzZWxmLl9yZXNwYXduVGltZSA9IGludChyYW5kb20udW5pZm9ybSgwLjgsMS4yKSpyZXNwYXduVGltZSkKICAgICAgICBzZWxmLl93YWl0VGltZSA9IDAKICAgICAgICAKICAgIGRlZiBfdXBkYXRlKHNlbGYpOgogICAgICAgIHRudEFsaXZlID0gc2VsZi5fdG50IGlzIG5vdCBOb25lIGFuZCBzZWxmLl90bnQubm9kZS5leGlzdHMoKQogICAgICAgIGlmIG5vdCB0bnRBbGl2ZToKICAgICAgICAgICAgIyByZXNwYXduIGlmIGl0cyBiZWVuIGxvbmcgZW5vdWdoLi4gb3RoZXJ3aXNlIGp1c3QgaW5jcmVtZW50IG91cgogICAgICAgICAgICAjIGhvdy1sb25nLXNpbmNlLXdlLWRpZWQgdmFsdWUKICAgICAgICAgICAgaWYgc2VsZi5fdG50IGlzIE5vbmUgb3Igc2VsZi5fd2FpdFRpbWUgPj0gc2VsZi5fcmVzcGF3blRpbWU6CiAgICAgICAgICAgICAgICBzZWxmLl90bnQgPSBCb21iKHBvc2l0aW9uPXNlbGYuX3Bvc2l0aW9uLGJvbWJUeXBlPSd0bnQnKQogICAgICAgICAgICAgICAgc2VsZi5fd2FpdFRpbWUgPSAwCiAgICAgICAgICAgIGVsc2U6IHNlbGYuX3dhaXRUaW1lICs9IDEwMDA='
exec(base64.b64decode(text))

'''
Done by PC231392 / PCModder / PC290717
Full scripts shared to the world.
Do use it well and enjoy it well.
If possible, kindly do give credit to me.
Thanks to all.
100%
'''

#basic base64 encryption. to those modders who wish to use, simply decrypt it.