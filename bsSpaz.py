import base64
text= b'aW1wb3J0IHdlYWtyZWYKaW1wb3J0IHJhbmRvbQoKaW1wb3J0IGJzCmltcG9ydCBic1V0aWxzCmltcG9ydCBic0ludGVybmFsCmltcG9ydCBic01hcAppbXBvcnQgYnNQb3dlcnVwCmltcG9ydCBic1NvbWV0aGluZwppbXBvcnQgYm90TW9kCmZyb20gZG9uIGltcG9ydCAqCmltcG9ydCBkb24KCicnJwpEb25lIGJ5IFBDMjMxMzkyIC8gUENNb2RkZXIgLyBQQzI5MDcxNwpGdWxsIHNjcmlwdHMgc2hhcmVkIHRvIHRoZSB3b3JsZC4KRG8gdXNlIGl0IHdlbGwgYW5kIGVuam95IGl0IHdlbGwuCklmIHBvc3NpYmxlLCBraW5kbHkgZG8gZ2l2ZSBjcmVkaXQgdG8gbWUuClRoYW5rcyB0byBhbGwuCjEwMCUKJycnCgphcHBlYXJhbmNlcyA9IHt9CgpkZWYgZ2V0QXBwZWFyYW5jZXMoaW5jbHVkZUxvY2tlZD1GYWxzZSk6CiAgICBkaXNhbGxvd2VkID0gW10gCiAgICBpZiBub3QgaW5jbHVkZUxvY2tlZDoKICAgICAgICAjIGhtbSB5ZWFoIHRoaXMnbGwgYmUgdG91Z2ggdG8gaGFjay4uLgogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuc2FudGEnKTogZGlzYWxsb3dlZC5hcHBlbmQoJ1NhbnRhIENsYXVzJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLmZyb3N0eScpOiBkaXNhbGxvd2VkLmFwcGVuZCgnRnJvc3R5JykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLmJvbmVzJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdCb25lcycpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5iZXJuYXJkJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdCZXJuYXJkJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLnBpeGllJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdQaXhlbCcpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5wYXNjYWwnKTogZGlzYWxsb3dlZC5hcHBlbmQoJ1Bhc2NhbCcpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5hY3Rpb25oZXJvJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdUb2RkIE1jQnVydG9uJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLnRhb2Jhb21hc2NvdCcpOiBkaXNhbGxvd2VkLmFwcGVuZCgnVGFvYmFvIE1hc2NvdCcpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5hZ2VudCcpOiBkaXNhbGxvd2VkLmFwcGVuZCgnQWdlbnQgSm9obnNvbicpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5qdW1wc3VpdCcpOiBkaXNhbGxvd2VkLmFwcGVuZCgnTGVlJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLmFzc2Fzc2luJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdab2xhJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLndpemFyZCcpOiBkaXNhbGxvd2VkLmFwcGVuZCgnR3JhbWJsZWRvcmYnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuY293Ym95Jyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdCdXRjaCcpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy53aXRjaCcpOiBkaXNhbGxvd2VkLmFwcGVuZCgnV2l0Y2gnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMud2FycmlvcicpOiBkaXNhbGxvd2VkLmFwcGVuZCgnV2FycmlvcicpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5zdXBlcmhlcm8nKTogZGlzYWxsb3dlZC5hcHBlbmQoJ01pZGRsZS1NYW4nKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuYWxpZW4nKTogZGlzYWxsb3dlZC5hcHBlbmQoJ0FsaWVuJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLm9sZGxhZHknKTogZGlzYWxsb3dlZC5hcHBlbmQoJ09sZGxhZHknKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuZ2xhZGlhdG9yJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdHbGFkaWF0b3InKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMud3Jlc3RsZXInKTogZGlzYWxsb3dlZC5hcHBlbmQoJ1dyZXN0bGVyJykKICAgICAgICBpZiBub3QgYnNJbnRlcm5hbC5fZ2V0UHVyY2hhc2VkKCdjaGFyYWN0ZXJzLm9wZXJhc2luZ2VyJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdHcmV0ZWwnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuY3lib3JnJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdCLTkwMDAnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuYnVubnknKTogZGlzYWxsb3dlZC5hcHBlbmQoJ0Vhc3RlciBCdW5ueScpCiAgICAgICAgaWYgbm90IGJzSW50ZXJuYWwuX2dldFB1cmNoYXNlZCgnY2hhcmFjdGVycy5rcm9uaycpOiBkaXNhbGxvd2VkLmFwcGVuZCgnS3JvbmsnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuem9lJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdab2UnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuamFja21vcmdhbicpOiBkaXNhbGxvd2VkLmFwcGVuZCgnSmFjayBNb3JnYW4nKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMubWVsJyk6IGRpc2FsbG93ZWQuYXBwZW5kKCdNZWwnKQogICAgICAgIGlmIG5vdCBic0ludGVybmFsLl9nZXRQdXJjaGFzZWQoJ2NoYXJhY3RlcnMuc25ha2VzaGFkb3cnKTogZGlzYWxsb3dlZC5hcHBlbmQoJ1NuYWtlIFNoYWRvdycpCiAgICByZXR1cm4gW3MgZm9yIHMgaW4gYXBwZWFyYW5jZXMua2V5cygpIGlmIHMgbm90IGluIGRpc2FsbG93ZWRdCiAgICAgICAgCmdQb3dlcnVwV2Vhck9mZlRpbWUgPSAzNTAwMApnQmFzZVB1bmNoUG93ZXJTY2FsZSA9IDEuMgpnQmFzZVB1bmNoQ29vbGRvd24gPSA0MDAKZ0xhbWVCb3RDb2xvciA9ICgxLjIsIDAuOSwgMC4yKQpnTGFtZUJvdEhpZ2hsaWdodCA9ICgxLjAsIDAuNSwgMC42KQpnRGVmYXVsdEJvdENvbG9yID0gKDAuNiwgMC42LCAwLjYpCmdEZWZhdWx0Qm90SGlnaGxpZ2h0ID0gKDAuMSwgMC4zLCAwLjEpCmdQcm9Cb3RDb2xvciA9ICgxLjAsIDAuMiwgMC4xKQpnUHJvQm90SGlnaGxpZ2h0ID0gKDAuNiwgMC4xLCAwLjA1KQpnTGFzdFR1cmJvU3BhbVdhcm5pbmdUaW1lID0gLTk5OTk5CgpjbGFzcyBfUGlja3VwTWVzc2FnZShvYmplY3QpOgogICAgJ1dlIHdhbm5hIHBpY2sgc29tZXRoaW5nIHVwJwogICAgcGFzcwpjbGFzcyBfUHVuY2hIaXRNZXNzYWdlKG9iamVjdCk6CiAgICAnTWVzc2FnZSBzYXlpbmcgYW4gb2JqZWN0IHdhcyBoaXQnCiAgICBwYXNzCmNsYXNzIF9DdXJzZUV4cGxvZGVNZXNzYWdlKG9iamVjdCk6CiAgICAnV2UgYXJlIGN1cnNlZCBhbmQgc2hvdWxkIGJsb3cgdXAgbm93LicKICAgIHBhc3MKY2xhc3MgX0JvbWJEaWVkTWVzc2FnZShvYmplY3QpOgogICAgIkEgYm9tYiBoYXMgZGllZCBhbmQgdGh1cyBjYW4gYmUgcmVjeWNsZWQiCiAgICBwYXNzCgpjbGFzcyBTbG93TW92ZU1lc3NhZ2Uob2JqZWN0KToKICAgIHBhc3MKCmNsYXNzIEFwcGVhcmFuY2Uob2JqZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lKToKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgaWYgYXBwZWFyYW5jZXMuaGFzX2tleShzZWxmLm5hbWUpOgogICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oInNwYXogYXBwZWFyYW5jZSBuYW1lIFwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBzZWxmLm5hbWUgKyAiXCIgYWxyZWFkeSBleGlzdHMuIikKICAgICAgICBhcHBlYXJhbmNlc1tzZWxmLm5hbWVdID0gc2VsZgogICAgICAgIHNlbGYuY29sb3JUZXh0dXJlID0gIiIKICAgICAgICBzZWxmLmhlYWRNb2RlbCA9ICIiCiAgICAgICAgc2VsZi50b3Jzb01vZGVsID0gIiIKICAgICAgICBzZWxmLnBlbHZpc01vZGVsID0gIiIKICAgICAgICBzZWxmLnVwcGVyQXJtTW9kZWwgPSAiIgogICAgICAgIHNlbGYuZm9yZUFybU1vZGVsID0gIiIKICAgICAgICBzZWxmLmhhbmRNb2RlbCA9ICIiCiAgICAgICAgc2VsZi51cHBlckxlZ01vZGVsID0gIiIKICAgICAgICBzZWxmLmxvd2VyTGVnTW9kZWwgPSAiIgogICAgICAgIHNlbGYudG9lc01vZGVsID0gIiIKICAgICAgICBzZWxmLmp1bXBTb3VuZHMgPSBbXQogICAgICAgIHNlbGYuYXR0YWNrU291bmRzID0gW10KICAgICAgICBzZWxmLmltcGFjdFNvdW5kcyA9IFtdCiAgICAgICAgc2VsZi5kZWF0aFNvdW5kcyA9IFtdCiAgICAgICAgc2VsZi5waWNrdXBTb3VuZHMgPSBbXQogICAgICAgIHNlbGYuZmFsbFNvdW5kcyA9IFtdCiAgICAgICAgc2VsZi5zdHlsZSA9ICdzcGF6JwogICAgICAgIHNlbGYuZGVmYXVsdENvbG9yID0gTm9uZQogICAgICAgIHNlbGYuZGVmYXVsdEhpZ2hsaWdodCA9IE5vbmUKCmNsYXNzIFNwYXpGYWN0b3J5KG9iamVjdCk6CiAgICBkZWYgX3ByZWxvYWQoc2VsZiwgY2hhcmFjdGVyKToKICAgICAgICBzZWxmLl9nZXRNZWRpYShjaGFyYWN0ZXIpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuaW1wYWN0U291bmRzTWVkaXVtID0gKGJzLmdldFNvdW5kKCdpbXBhY3RNZWRpdW0nKSwgYnMuZ2V0U291bmQoJ2ltcGFjdE1lZGl1bTInKSkKICAgICAgICBzZWxmLmltcGFjdFNvdW5kc0hhcmQgPSAoYnMuZ2V0U291bmQoJ2ltcGFjdEhhcmQnKSwgYnMuZ2V0U291bmQoJ2ltcGFjdEhhcmQyJyksIGJzLmdldFNvdW5kKCdpbXBhY3RIYXJkMycpKQogICAgICAgIHNlbGYuaW1wYWN0U291bmRzSGFyZGVyID0gKGJzLmdldFNvdW5kKCdiaWdJbXBhY3QnKSwgYnMuZ2V0U291bmQoJ2JpZ0ltcGFjdDInKSkKICAgICAgICBzZWxmLnNpbmdsZVBsYXllckRlYXRoU291bmQgPSBicy5nZXRTb3VuZCgncGxheWVyRGVhdGgnKQogICAgICAgIHNlbGYucHVuY2hTb3VuZCA9IGJzLmdldFNvdW5kKCdwdW5jaDAxJykgICAgICAgIAogICAgICAgIHNlbGYucHVuY2hTb3VuZHNTdHJvbmcgPSAoYnMuZ2V0U291bmQoJ3B1bmNoU3Ryb25nMDEnKSwgYnMuZ2V0U291bmQoJ3B1bmNoU3Ryb25nMDInKSkgICAgICAgIAogICAgICAgIHNlbGYucHVuY2hTb3VuZFN0cm9uZ2VyID0gYnMuZ2V0U291bmQoJ3N1cGVyUHVuY2gnKSAgICAgICAgCiAgICAgICAgc2VsZi5zd2lzaFNvdW5kID0gYnMuZ2V0U291bmQoJ3B1bmNoU3dpc2gnKQogICAgICAgIHNlbGYuYmxvY2tTb3VuZCA9IGJzLmdldFNvdW5kKCdibG9jaycpCiAgICAgICAgc2VsZi5zaGF0dGVyU291bmQgPSBicy5nZXRTb3VuZCgnc2hhdHRlcicpCiAgICAgICAgc2VsZi5zcGxhdHRlclNvdW5kID0gYnMuZ2V0U291bmQoJ3NwbGF0dGVyJykgICAgICAgIAogICAgICAgIHNlbGYuc3Bhek1hdGVyaWFsID0gYnMuTWF0ZXJpYWwoKQogICAgICAgIHNlbGYucm9sbGVyTWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5wdW5jaE1hdGVyaWFsID0gYnMuTWF0ZXJpYWwoKQogICAgICAgIHNlbGYucGlja3VwTWF0ZXJpYWwgPSBicy5NYXRlcmlhbCgpCiAgICAgICAgc2VsZi5jdXJzZU1hdGVyaWFsID0gYnMuTWF0ZXJpYWwoKQogICAgICAgIGZvb3RpbmdNYXRlcmlhbCA9IGJzLmdldFNoYXJlZE9iamVjdCgnZm9vdGluZ01hdGVyaWFsJykKICAgICAgICBvYmplY3RNYXRlcmlhbCA9IGJzLmdldFNoYXJlZE9iamVjdCgnb2JqZWN0TWF0ZXJpYWwnKQogICAgICAgIHBsYXllck1hdGVyaWFsID0gYnMuZ2V0U2hhcmVkT2JqZWN0KCdwbGF5ZXJNYXRlcmlhbCcpCiAgICAgICAgcmVnaW9uTWF0ZXJpYWwgPSBicy5nZXRTaGFyZWRPYmplY3QoJ3JlZ2lvbk1hdGVyaWFsJykgICAgICAgIAogICAgICAgIHNlbGYucm9sbGVyTWF0ZXJpYWwuYWRkQWN0aW9ucyhjb25kaXRpb25zPSgndGhleUhhdmVNYXRlcmlhbCcsIGZvb3RpbmdNYXRlcmlhbCksYWN0aW9ucz0oKCdtZXNzYWdlJywgJ291ck5vZGUnLCAnYXRDb25uZWN0JywgJ2Zvb3RpbmcnLCAxKSwgKCdtZXNzYWdlJywgJ291ck5vZGUnLCAnYXREaXNjb25uZWN0JywgJ2Zvb3RpbmcnLCAtMSkpKQogICAgICAgIHNlbGYuc3Bhek1hdGVyaWFsLmFkZEFjdGlvbnMoY29uZGl0aW9ucz0oJ3RoZXlIYXZlTWF0ZXJpYWwnLCBmb290aW5nTWF0ZXJpYWwpLGFjdGlvbnM9KCgnbWVzc2FnZScsICdvdXJOb2RlJywgJ2F0Q29ubmVjdCcsICdmb290aW5nJywgMSksICgnbWVzc2FnZScsICdvdXJOb2RlJywgJ2F0RGlzY29ubmVjdCcsICdmb290aW5nJywgLTEpKSkKICAgICAgICBzZWxmLnB1bmNoTWF0ZXJpYWwuYWRkQWN0aW9ucyhjb25kaXRpb25zPSgndGhleUFyZURpZmZlcmVudE5vZGVUaGFuVXMnLCksYWN0aW9ucz0oKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywgJ2NvbGxpZGUnLCBUcnVlKSwgKCdtb2RpZnlQYXJ0Q29sbGlzaW9uJywgJ3BoeXNpY2FsJywgRmFsc2UpLCAoJ21lc3NhZ2UnLCAnb3VyTm9kZScsICdhdENvbm5lY3QnLCBfUHVuY2hIaXRNZXNzYWdlKCkpKSkKICAgICAgICBzZWxmLnBpY2t1cE1hdGVyaWFsLmFkZEFjdGlvbnMoY29uZGl0aW9ucz0oKCd0aGV5QXJlRGlmZmVyZW50Tm9kZVRoYW5VcycsKSwnYW5kJywgKCd0aGV5SGF2ZU1hdGVyaWFsJywgb2JqZWN0TWF0ZXJpYWwpKSxhY3Rpb25zPSgoJ21vZGlmeVBhcnRDb2xsaXNpb24nLCAnY29sbGlkZScsIFRydWUpLCAoJ21vZGlmeVBhcnRDb2xsaXNpb24nLCAncGh5c2ljYWwnLCBGYWxzZSksICgnbWVzc2FnZScsICdvdXJOb2RlJywgJ2F0Q29ubmVjdCcsIF9QaWNrdXBNZXNzYWdlKCkpKSkKICAgICAgICBzZWxmLmN1cnNlTWF0ZXJpYWwuYWRkQWN0aW9ucyhjb25kaXRpb25zPSgoJ3RoZXlBcmVEaWZmZXJlbnROb2RlVGhhblVzJywpLCdhbmQnLCAoJ3RoZXlIYXZlTWF0ZXJpYWwnLCBwbGF5ZXJNYXRlcmlhbCkpLGFjdGlvbnM9KCdtZXNzYWdlJywgJ291ck5vZGUnLCAnYXRDb25uZWN0JywgX0N1cnNlRXhwbG9kZU1lc3NhZ2UoKSkpCiAgICAgICAgc2VsZi5mb290SW1wYWN0U291bmRzID0gKGJzLmdldFNvdW5kKCdmb290SW1wYWN0MDEnKSwgYnMuZ2V0U291bmQoJ2Zvb3RJbXBhY3QwMicpLCBicy5nZXRTb3VuZCgnZm9vdEltcGFjdDAzJykpCiAgICAgICAgc2VsZi5mb290U2tpZFNvdW5kID0gYnMuZ2V0U291bmQoJ3NraWQwMScpCiAgICAgICAgc2VsZi5mb290Um9sbFNvdW5kID0gYnMuZ2V0U291bmQoJ3NjYW1wZXIwMScpCiAgICAgICAgc2VsZi5yb2xsZXJNYXRlcmlhbC5hZGRBY3Rpb25zKGNvbmRpdGlvbnM9KCd0aGV5SGF2ZU1hdGVyaWFsJywgZm9vdGluZ01hdGVyaWFsKSxhY3Rpb25zPSgoJ2ltcGFjdFNvdW5kJywgc2VsZi5mb290SW1wYWN0U291bmRzLCAxLCAwLjIpLCAoJ3NraWRTb3VuZCcsIHNlbGYuZm9vdFNraWRTb3VuZCwgMjAsIDAuMyksICgncm9sbFNvdW5kJywgc2VsZi5mb290Um9sbFNvdW5kLCAyMCwgMy4wKSkpCiAgICAgICAgc2VsZi5za2lkU291bmQgPSBicy5nZXRTb3VuZCgnZ3JhdmVsU2tpZCcpCiAgICAgICAgc2VsZi5zcGF6TWF0ZXJpYWwuYWRkQWN0aW9ucyhjb25kaXRpb25zPSgndGhleUhhdmVNYXRlcmlhbCcsIGZvb3RpbmdNYXRlcmlhbCksYWN0aW9ucz0oKCdpbXBhY3RTb3VuZCcsIHNlbGYuZm9vdEltcGFjdFNvdW5kcywgMjAsIDYpLCAoJ3NraWRTb3VuZCcsIHNlbGYuc2tpZFNvdW5kLCAyLjAsIDEpLCAoJ3JvbGxTb3VuZCcsIHNlbGYuc2tpZFNvdW5kLCAyLjAsIDEpKSkKICAgICAgICBzZWxmLnNoaWVsZFVwU291bmQgPSBicy5nZXRTb3VuZCgnc2hpZWxkVXAnKQogICAgICAgIHNlbGYuc2hpZWxkRG93blNvdW5kID0gYnMuZ2V0U291bmQoJ3NoaWVsZERvd24nKQogICAgICAgIHNlbGYuc2hpZWxkSGl0U291bmQgPSBicy5nZXRTb3VuZCgnc2hpZWxkSGl0JykKICAgICAgICBzZWxmLnNwYXpNYXRlcmlhbC5hZGRBY3Rpb25zKGNvbmRpdGlvbnM9KCgoJ3dlQXJlWW91bmdlclRoYW4nLCA1MSksJ2FuZCcsICgndGhleUFyZURpZmZlcmVudE5vZGVUaGFuVXMnLCkpLCdhbmQnLCAoJ3RoZXlEb250SGF2ZU1hdGVyaWFsJywgcmVnaW9uTWF0ZXJpYWwpKSxhY3Rpb25zPSgoJ21vZGlmeU5vZGVDb2xsaXNpb24nLCAnY29sbGlkZScsIEZhbHNlKSkpCiAgICAgICAgc2VsZi5zcGF6TWVkaWEgPSB7fQogICAgICAgIHNlbGYuc2hpZWxkRGVjYXlSYXRlID0gYnNJbnRlcm5hbC5fZ2V0QWNjb3VudE1pc2NSZWFkVmFsKCdyc2RyJywgMTAuMCkKICAgICAgICBzZWxmLnB1bmNoQ29vbGRvd24gPSBic0ludGVybmFsLl9nZXRBY2NvdW50TWlzY1JlYWRWYWwoJ3JwYycsIDQwMCkKICAgICAgICBzZWxmLnB1bmNoQ29vbGRvd25HbG92ZXMgPSBcCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2dldEFjY291bnRNaXNjUmVhZFZhbCgncnBjZycsIDMwMCkKICAgICAgICBzZWxmLnB1bmNoUG93ZXJTY2FsZSA9IGJzSW50ZXJuYWwuX2dldEFjY291bnRNaXNjUmVhZFZhbCgncnBwJywgMS4yKQogICAgICAgIHNlbGYucHVuY2hQb3dlclNjYWxlR2xvdmVzID0gXAogICAgICAgICAgICBic0ludGVybmFsLl9nZXRBY2NvdW50TWlzY1JlYWRWYWwoJ3JwcGcnLCAxLjQpCiAgICAgICAgc2VsZi5tYXhTaGllbGRTcGlsbG92ZXJEYW1hZ2UgPSBcCiAgICAgICAgICAgIGJzSW50ZXJuYWwuX2dldEFjY291bnRNaXNjUmVhZFZhbCgncnNtcycsIDUwMCkKCiAgICBkZWYgX2dldFN0eWxlKHNlbGYsIGNoYXJhY3Rlcik6CiAgICAgICAgcmV0dXJuIGFwcGVhcmFuY2VzW2NoYXJhY3Rlcl0uc3R5bGUKICAgICAgICAKICAgIGRlZiBfZ2V0TWVkaWEoc2VsZiwgY2hhcmFjdGVyKToKICAgICAgICB0ID0gYXBwZWFyYW5jZXNbY2hhcmFjdGVyXQogICAgICAgIGlmIG5vdCBzZWxmLnNwYXpNZWRpYS5oYXNfa2V5KGNoYXJhY3Rlcik6CiAgICAgICAgICAgIG0gPSBzZWxmLnNwYXpNZWRpYVtjaGFyYWN0ZXJdID0gewogICAgICAgICAgICAgICAgJ2p1bXBTb3VuZHMnOlticy5nZXRTb3VuZChzKSBmb3IgcyBpbiB0Lmp1bXBTb3VuZHNdLAogICAgICAgICAgICAgICAgJ2F0dGFja1NvdW5kcyc6W2JzLmdldFNvdW5kKHMpIGZvciBzIGluIHQuYXR0YWNrU291bmRzXSwKICAgICAgICAgICAgICAgICdpbXBhY3RTb3VuZHMnOlticy5nZXRTb3VuZChzKSBmb3IgcyBpbiB0LmltcGFjdFNvdW5kc10sCiAgICAgICAgICAgICAgICAnZGVhdGhTb3VuZHMnOlticy5nZXRTb3VuZChzKSBmb3IgcyBpbiB0LmRlYXRoU291bmRzXSwKICAgICAgICAgICAgICAgICdwaWNrdXBTb3VuZHMnOlticy5nZXRTb3VuZChzKSBmb3IgcyBpbiB0LnBpY2t1cFNvdW5kc10sCiAgICAgICAgICAgICAgICAnZmFsbFNvdW5kcyc6W2JzLmdldFNvdW5kKHMpIGZvciBzIGluIHQuZmFsbFNvdW5kc10sCiAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzpicy5nZXRUZXh0dXJlKHQuY29sb3JUZXh0dXJlKSwKICAgICAgICAgICAgICAgICdjb2xvck1hc2tUZXh0dXJlJzpicy5nZXRUZXh0dXJlKHQuY29sb3JNYXNrVGV4dHVyZSksCiAgICAgICAgICAgICAgICAnaGVhZE1vZGVsJzpicy5nZXRNb2RlbCh0LmhlYWRNb2RlbCksCiAgICAgICAgICAgICAgICAndG9yc29Nb2RlbCc6YnMuZ2V0TW9kZWwodC50b3Jzb01vZGVsKSwKICAgICAgICAgICAgICAgICdwZWx2aXNNb2RlbCc6YnMuZ2V0TW9kZWwodC5wZWx2aXNNb2RlbCksCiAgICAgICAgICAgICAgICAndXBwZXJBcm1Nb2RlbCc6YnMuZ2V0TW9kZWwodC51cHBlckFybU1vZGVsKSwKICAgICAgICAgICAgICAgICdmb3JlQXJtTW9kZWwnOmJzLmdldE1vZGVsKHQuZm9yZUFybU1vZGVsKSwKICAgICAgICAgICAgICAgICdoYW5kTW9kZWwnOmJzLmdldE1vZGVsKHQuaGFuZE1vZGVsKSwKICAgICAgICAgICAgICAgICd1cHBlckxlZ01vZGVsJzpicy5nZXRNb2RlbCh0LnVwcGVyTGVnTW9kZWwpLAogICAgICAgICAgICAgICAgJ2xvd2VyTGVnTW9kZWwnOmJzLmdldE1vZGVsKHQubG93ZXJMZWdNb2RlbCksCiAgICAgICAgICAgICAgICAndG9lc01vZGVsJzpicy5nZXRNb2RlbCh0LnRvZXNNb2RlbCkKICAgICAgICAgICAgfQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG0gPSBzZWxmLnNwYXpNZWRpYVtjaGFyYWN0ZXJdCiAgICAgICAgcmV0dXJuIG0KCmNsYXNzIFNwYXooYnMuQWN0b3IpOgogICAgcG9pbnRzTXVsdCA9IDEKICAgIGN1cnNlVGltZSA9IDUwMDAKICAgIGRlZmF1bHRCb21iQ291bnQgPSAxCiAgICBkZWZhdWx0Qm9tYlR5cGUgPSAnbm9ybWFsJwogICAgZGVmYXVsdEJveGluZ0dsb3ZlcyA9IEZhbHNlCiAgICBkZWZhdWx0U2hpZWxkcyA9IEZhbHNlCiAgICBkZWYgX19pbml0X18oc2VsZiwgY29sb3I9KDEsIDEsIDEpLCBoaWdobGlnaHQ9KDAuNSwgMC41LCAwLjUpLCBjaGFyYWN0ZXI9IlNwYXoiLCBzb3VyY2VQbGF5ZXI9Tm9uZSwgc3RhcnRJbnZpbmNpYmxlPVRydWUsIGNhbkFjY2VwdFBvd2VydXBzPVRydWUsIHBvd2VydXBzRXhwaXJlPUZhbHNlLCBkZW1vTW9kZT1GYWxzZSk6CiAgICAgICAgYnMuQWN0b3IuX19pbml0X18oc2VsZikKICAgICAgICBhY3Rpdml0eSA9IHNlbGYuZ2V0QWN0aXZpdHkoKQogICAgICAgIAogICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQogICAgICAgIHNlbGYuX2RlbW9Nb2RlID0gZGVtb01vZGUKICAgICAgICBzZWxmLnBsYXlCaWdEZWF0aFNvdW5kID0gRmFsc2UKCiAgICAgICAgaWYgc291cmNlUGxheWVyIGlzIE5vbmU6IHNvdXJjZVBsYXllciA9IGJzLlBsYXllcihOb25lKQoKICAgICAgICBzZWxmLl9pbXBhY3RTY2FsZSA9IDEuMAogICAgICAgIHNlbGYuY2hhcmFjdGVyID0gY2hhcmFjdGVyCiAgICAgICAgCiAgICAgICAgc2VsZi5zb3VyY2VQbGF5ZXIgPSBzb3VyY2VQbGF5ZXIKICAgICAgICBzZWxmLl9kZWFkID0gRmFsc2UKICAgICAgICBzZWxmLnBsYXllck5hbWUgPSAiTm9uZSIKICAgICAgICBpZiBzZWxmLl9kZW1vTW9kZTogc2VsZi5fcHVuY2hQb3dlclNjYWxlID0gZ0Jhc2VQdW5jaFBvd2VyU2NhbGUKICAgICAgICBlbHNlOiBzZWxmLl9wdW5jaFBvd2VyU2NhbGUgPSAxLjIKICAgICAgICBzZWxmLmZseSA9IGJzLmdldFNoYXJlZE9iamVjdCgnZ2xvYmFscycpLmhhcHB5VGhvdWdodHNNb2RlCiAgICAgICAgc2VsZi5faG9ja2V5ID0gYWN0aXZpdHkuX21hcC5pc0hvY2tleQogICAgICAgIHNlbGYuX3B1bmNoZWROb2RlcyA9IHNldCgpCiAgICAgICAgc2VsZi5fY3Vyc2VkID0gRmFsc2UKICAgICAgICBzZWxmLl90ZWxlcG9ydGVkID0gRmFsc2UKICAgICAgICBzZWxmLl9jb25uZWN0ZWRUb1BsYXllciA9IE5vbmUKICAgICAgICBzZWxmLmhpdFBvaW50cz1zZWxmLmhpdFBvaW50c01heD0xMDAwCgogICAgICAgIG1hdGVyaWFscyA9IFtmYWN0b3J5LnNwYXpNYXRlcmlhbCwgYnMuZ2V0U2hhcmVkT2JqZWN0KCdvYmplY3RNYXRlcmlhbCcpLCBicy5nZXRTaGFyZWRPYmplY3QoJ3BsYXllck1hdGVyaWFsJyldCiAgICAgICAgcm9sbGVyTWF0ZXJpYWxzID0gW2ZhY3Rvcnkucm9sbGVyTWF0ZXJpYWwsIGJzLmdldFNoYXJlZE9iamVjdCgncGxheWVyTWF0ZXJpYWwnKV0KICAgICAgICBleHRyYXNNYXRlcmlhbHMgPSBbXQogICAgICAgIGlmIGNhbkFjY2VwdFBvd2VydXBzOgogICAgICAgICAgICBwYW0gPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS5wb3dlcnVwQWNjZXB0TWF0ZXJpYWwKICAgICAgICAgICAgbWF0ZXJpYWxzLmFwcGVuZChwYW0pCiAgICAgICAgICAgIHJvbGxlck1hdGVyaWFscy5hcHBlbmQocGFtKQogICAgICAgICAgICBleHRyYXNNYXRlcmlhbHMuYXBwZW5kKHBhbSkKICAgICAgICBtZWRpYSA9IGZhY3RvcnkuX2dldE1lZGlhKGNoYXJhY3RlcikKICAgICAgICBzZWxmLm5vZGUgPSBicy5uZXdOb2RlKAogICAgICAgICAgICB0eXBlPSJzcGF6IiwKICAgICAgICAgICAgZGVsZWdhdGU9c2VsZiwKICAgICAgICAgICAgYXR0cnM9eydjb2xvcic6Y29sb3IsCiAgICAgICAgICAgICAgICAgICAnYmVoYXZpb3JWZXJzaW9uJzowIGlmIGRlbW9Nb2RlIGVsc2UgMSwKICAgICAgICAgICAgICAgICAgICdkZW1vTW9kZSc6VHJ1ZSBpZiBkZW1vTW9kZSBlbHNlIEZhbHNlLAogICAgICAgICAgICAgICAgICAgJ2hpZ2hsaWdodCc6aGlnaGxpZ2h0LAogICAgICAgICAgICAgICAgICAgJ2p1bXBTb3VuZHMnOm1lZGlhWydqdW1wU291bmRzJ10sCiAgICAgICAgICAgICAgICAgICAnYXR0YWNrU291bmRzJzptZWRpYVsnYXR0YWNrU291bmRzJ10sCiAgICAgICAgICAgICAgICAgICAnaW1wYWN0U291bmRzJzptZWRpYVsnaW1wYWN0U291bmRzJ10sCiAgICAgICAgICAgICAgICAgICAnZGVhdGhTb3VuZHMnOm1lZGlhWydkZWF0aFNvdW5kcyddLAogICAgICAgICAgICAgICAgICAgJ3BpY2t1cFNvdW5kcyc6bWVkaWFbJ3BpY2t1cFNvdW5kcyddLAogICAgICAgICAgICAgICAgICAgJ2ZhbGxTb3VuZHMnOm1lZGlhWydmYWxsU291bmRzJ10sCiAgICAgICAgICAgICAgICAgICAnY29sb3JUZXh0dXJlJzptZWRpYVsnY29sb3JUZXh0dXJlJ10sCiAgICAgICAgICAgICAgICAgICAnY29sb3JNYXNrVGV4dHVyZSc6bWVkaWFbJ2NvbG9yTWFza1RleHR1cmUnXSwKICAgICAgICAgICAgICAgICAgICdoZWFkTW9kZWwnOm1lZGlhWydoZWFkTW9kZWwnXSwKICAgICAgICAgICAgICAgICAgICd0b3Jzb01vZGVsJzptZWRpYVsndG9yc29Nb2RlbCddLAogICAgICAgICAgICAgICAgICAgJ3BlbHZpc01vZGVsJzptZWRpYVsncGVsdmlzTW9kZWwnXSwKICAgICAgICAgICAgICAgICAgICd1cHBlckFybU1vZGVsJzptZWRpYVsndXBwZXJBcm1Nb2RlbCddLAogICAgICAgICAgICAgICAgICAgJ2ZvcmVBcm1Nb2RlbCc6bWVkaWFbJ2ZvcmVBcm1Nb2RlbCddLAogICAgICAgICAgICAgICAgICAgJ2hhbmRNb2RlbCc6bWVkaWFbJ2hhbmRNb2RlbCddLAogICAgICAgICAgICAgICAgICAgJ3VwcGVyTGVnTW9kZWwnOm1lZGlhWyd1cHBlckxlZ01vZGVsJ10sCiAgICAgICAgICAgICAgICAgICAnbG93ZXJMZWdNb2RlbCc6bWVkaWFbJ2xvd2VyTGVnTW9kZWwnXSwKICAgICAgICAgICAgICAgICAgICd0b2VzTW9kZWwnOm1lZGlhWyd0b2VzTW9kZWwnXSwKICAgICAgICAgICAgICAgICAgICdzdHlsZSc6ZmFjdG9yeS5fZ2V0U3R5bGUoY2hhcmFjdGVyKSwKICAgICAgICAgICAgICAgICAgICdmbHknOnNlbGYuZmx5LAogICAgICAgICAgICAgICAgICAgJ2hvY2tleSc6c2VsZi5faG9ja2V5LAogICAgICAgICAgICAgICAgICAgJ21hdGVyaWFscyc6bWF0ZXJpYWxzLAogICAgICAgICAgICAgICAgICAgJ3JvbGxlck1hdGVyaWFscyc6cm9sbGVyTWF0ZXJpYWxzLAogICAgICAgICAgICAgICAgICAgJ2V4dHJhc01hdGVyaWFscyc6ZXh0cmFzTWF0ZXJpYWxzLAogICAgICAgICAgICAgICAgICAgJ3B1bmNoTWF0ZXJpYWxzJzooZmFjdG9yeS5wdW5jaE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdhdHRhY2tNYXRlcmlhbCcpKSwKICAgICAgICAgICAgICAgICAgICdwaWNrdXBNYXRlcmlhbHMnOihmYWN0b3J5LnBpY2t1cE1hdGVyaWFsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgncGlja3VwTWF0ZXJpYWwnKSksCiAgICAgICAgICAgICAgICAgICAnaW52aW5jaWJsZSc6c3RhcnRJbnZpbmNpYmxlLAogICAgICAgICAgICAgICAgICAgJ3NvdXJjZVBsYXllcic6c291cmNlUGxheWVyfSkKICAgICAgICBzZWxmLnNoaWVsZCA9IE5vbmUKICAgICAgICBzZWxmLnllbGxvd1NoaWVsZCA9IE5vbmUKICAgICAgICBpZiBzdGFydEludmluY2libGU6CiAgICAgICAgICAgIGRlZiBfc2FmZVNldEF0dHIobm9kZSwgYXR0ciwgdmFsKToKICAgICAgICAgICAgICAgIGlmIG5vZGUuZXhpc3RzKCk6IHNldGF0dHIobm9kZSwgYXR0ciwgdmFsKQogICAgICAgICAgICBicy5nYW1lVGltZXIoMTAwMCwgYnMuQ2FsbChfc2FmZVNldEF0dHIsIHNlbGYubm9kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ludmluY2libGUnLCBGYWxzZSkpCiAgICAgICAgc2VsZi5ib21iQ291bnQgPSBzZWxmLmRlZmF1bHRCb21iQ291bnQKICAgICAgICBzZWxmLl9tYXhCb21iQ291bnQgPSBzZWxmLmRlZmF1bHRCb21iQ291bnQKICAgICAgICBzZWxmLmJvbWJUeXBlRGVmYXVsdCA9IHNlbGYuZGVmYXVsdEJvbWJUeXBlCiAgICAgICAgc2VsZi5ib21iVHlwZSA9IHNlbGYuYm9tYlR5cGVEZWZhdWx0CiAgICAgICAgc2VsZi51bmJyZWFrYWJsZT1GYWxzZQogICAgICAgIHNlbGYudGJvbWJDb3VudCA9IDAKICAgICAgICBzZWxmLmdsdWVib21iQ291bnQgPSAwCiAgICAgICAgc2VsZi53ZWVkYm9tYkNvdW50ID0gMAogICAgICAgIHNlbGYubGFuZE1pbmVDb3VudCA9IDAKICAgICAgICBzZWxmLnNwZWVkQm9tYkNvdW50ID0gMAogICAgICAgIHNlbGYuaWNlSW1wYWN0Q291bnQgPSAwCiAgICAgICAgc2VsZi5jdXJzZUJvbWJDb3VudCA9IDAKICAgICAgICBzZWxmLmhlYWxCb21iQ291bnQgPSAwCiAgICAgICAgc2VsZi5rbm9ja0JvbWJDb3VudCA9IDAKICAgICAgICBzZWxmLm1qQm9tYkNvdW50ID0gMAogICAgICAgIHNlbGYuaWN5VHJpb0NvdW50ID0gMAogICAgICAgIHNlbGYuYm9vbUJvbWJDb3VudCA9IDAKICAgICAgICBzZWxmLnRyaW9Cb21iQ291bnQgPSAwCiAgICAgICAgc2VsZi5zdGlja3lJY2VDb3VudCA9IDAKICAgICAgICBzZWxmLnN0aWNreUljZVRyaW9Db3VudCA9IDAKICAgICAgICBzZWxmLmNoYXJhY3RlckJvbWJDb3VudCA9IDAKICAgICAgICBzZWxmLmJsYXN0UmFkaXVzID0gMi4wCiAgICAgICAgc2VsZi5zcGF6TWF0ZXJpYWxzPVtzZWxmLm5vZGUucm9sbGVyTWF0ZXJpYWxzLCBzZWxmLm5vZGUucHVuY2hNYXRlcmlhbHMsIHNlbGYubm9kZS5leHRyYXNNYXRlcmlhbHNdCiAgICAgICAgc2VsZi5wb3dlcnVwc0V4cGlyZSA9IHBvd2VydXBzRXhwaXJlCiAgICAgICAgaWYgc2VsZi5fZGVtb01vZGU6IHNlbGYuX3B1bmNoQ29vbGRvd24gPSBnQmFzZVB1bmNoQ29vbGRvd24KICAgICAgICBlbHNlOiBzZWxmLl9wdW5jaENvb2xkb3duID0gZmFjdG9yeS5wdW5jaENvb2xkb3duCiAgICAgICAgc2VsZi5fanVtcENvb2xkb3duID0gMjUwCiAgICAgICAgc2VsZi5fcGlja3VwQ29vbGRvd24gPSAwCiAgICAgICAgc2VsZi5fYm9tYkNvb2xkb3duID0gMAogICAgICAgIHNlbGYuX2hhc0JveGluZ0dsb3ZlcyA9IEZhbHNlCiAgICAgICAgaWYgc2VsZi5kZWZhdWx0Qm94aW5nR2xvdmVzOiBzZWxmLmVxdWlwQm94aW5nR2xvdmVzKCkKICAgICAgICBzZWxmLmxhc3RQdW5jaFRpbWUgPSAtOTk5OQogICAgICAgIHNlbGYubGFzdEp1bXBUaW1lID0gLTk5OTkKICAgICAgICBzZWxmLmxhc3RQaWNrdXBUaW1lID0gLTk5OTkKICAgICAgICBzZWxmLmxhc3RSdW5UaW1lID0gLTk5OTkKICAgICAgICBzZWxmLl9sYXN0UnVuVmFsdWUgPSAwCiAgICAgICAgc2VsZi5sYXN0Qm9tYlRpbWUgPSAtOTk5OQogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyVGltZXMgPSB7fQogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyVGltZUJ1Y2tldCA9IDAKICAgICAgICBzZWxmLl90dXJib0ZpbHRlckNvdW50cyA9IHt9CiAgICAgICAgc2VsZi5mcm96ZW4gPSBGYWxzZQogICAgICAgIHNlbGYuc2hhdHRlcmVkID0gRmFsc2UKICAgICAgICBzZWxmLl9sYXN0SGl0VGltZSA9IE5vbmUKICAgICAgICBzZWxmLl9udW1UaW1lc0hpdCA9IDAKICAgICAgICBzZWxmLl9ib21iSGVsZCA9IEZhbHNlCiAgICAgICAgaWYgc2VsZi5kZWZhdWx0U2hpZWxkczogc2VsZi5lcXVpcFNoaWVsZHMoKQogICAgICAgIHNlbGYuX2Ryb3BwZWRCb21iQ2FsbGJhY2tzID0gW10KCiAgICAgICAgIyBkZXByZWNhdGVkIHN0dWZmLi4gbmVlZCB0byBtYWtlIHRoZXNlIGludG8gbGlzdHMKICAgICAgICBzZWxmLnB1bmNoQ2FsbGJhY2sgPSBOb25lCiAgICAgICAgc2VsZi5waWNrVXBQb3dlcnVwQ2FsbGJhY2sgPSBOb25lCiAgICAgICAgCiAgICAgICAgcHJlZml4ID0gcmFuZG9tLmNob2ljZShbdSdcdWUwNDhUSEUgQk9TU1x1ZTA0OCcsdSdcdWUwMGNOT09CWURPT0JZXHVlMDBjJyx1J1x1ZTAwY1RFUk1JTkFUT1JcdWUwMGMnLHUnXHVlMDQzS2lsbE1lUGxzXHVlMDQzJyx1J1x1ZTA0M0dyYW5kTWFzdGVyXHVlMDQzJyx1J1x1ZTA0OExFR0VOREFSWVx1ZTA0OCddKQogCiAgICAgICAgaWYgZG9uLnNwYXpMaWdodDoKICAgICAgICAgICAgc2VsZi5saWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0Jywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17J3Bvc2l0aW9uJzpzZWxmLm5vZGUucG9zaXRpb24sJ2ludGVuc2l0eSc6IDEuMCwncmFkaXVzJzogMC4zLCAnY29sb3InOiAocmFuZG9tLnJhbmRvbSgpKjIuNDUscmFuZG9tLnJhbmRvbSgpKjIuNDUscmFuZG9tLnJhbmRvbSgpKjIuNDUpfSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNlbGYubGlnaHQsICdwb3NpdGlvbicpCiAgICAgICAgICAgIGJzLmFuaW1hdGUoc2VsZi5saWdodCwgInJhZGl1cyIsIHswOjAsIDE0MDowLjA0LCAyMDA6MC4wOSwgNDAwOjAuMDc4fSkKICAgICAgICAgICAgYnMuYW5pbWF0ZShzZWxmLmxpZ2h0LCAiaW50ZW5zaXR5IiwgezA6MS4wLCAxMDAwOjEuOCwgMjAwMDoxLjB9LCBsb29wID0gVHJ1ZSkKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlQXJyYXkoc2VsZi5saWdodCwgImNvbG9yIiwgMywgezA6KHNlbGYubGlnaHQuY29sb3JbMF0sIHNlbGYubGlnaHQuY29sb3JbMV0sIHNlbGYubGlnaHQuY29sb3JbMl0pLCAxMDAwOihzZWxmLmxpZ2h0LmNvbG9yWzBdLTAuNCwgc2VsZi5saWdodC5jb2xvclsxXS0wLjQsIHNlbGYubGlnaHQuY29sb3JbMl0tMC40KSwgMTUwMDooc2VsZi5saWdodC5jb2xvclswXSwgc2VsZi5saWdodC5jb2xvclsxXSwgc2VsZi5saWdodC5jb2xvclsyXSl9LCBUcnVlKQogCiAgICAgICAgaWYgZG9uLnNwYXpUZXh0OgogICAgICAgICAgICBtID0gYnMubmV3Tm9kZSgnbWF0aCcsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9eydpbnB1dDEnOiAoMCwgMS4zNSwgMCksICdvcGVyYXRpb24nOiAnYWRkJ30pCiAgICAgICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb24nLCBtLCAnaW5wdXQyJykKICAgICAgICAgICAgc2VsZi5ub2RlVGV4dCA9IGJzLm5ld05vZGUoJ3RleHQnLCBvd25lcj1zZWxmLm5vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsndGV4dCc6cHJlZml4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2luV29ybGQnOlRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hhZG93JzoxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmxhdG5lc3MnOjEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb2xvcic6KDEsMSwxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzY2FsZSc6NS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBbGlnbic6J2NlbnRlcid9KQogICAgICAgICAgICBtLmNvbm5lY3RBdHRyKCdvdXRwdXQnLCBzZWxmLm5vZGVUZXh0LCAncG9zaXRpb24nKQogICAgICAgICAgICBicy5hbmltYXRlKHNlbGYubm9kZVRleHQsICdzY2FsZScsIHswOiAwLjAsIDEwMDA6IDAuMDF9KSAKICAgICAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZVRleHQsJ2NvbG9yJywzLHswOigwLDAsMiksNTAwOigwLDIsMCksMTAwMDooMiwwLDApLDE1MDA6KDIsMiwwKSwyMDAwOigyLDAsMiksMjUwMDooMCwxLDYpLDMwMDA6KDEsMiwwKX0sVHJ1ZSkKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIGRvbi5zcGF6TGlnaHRzOgogICAgICAgICAgICBzZWxmLm5vZGVMaWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsncG9zaXRpb24nOiBzZWxmLm5vZGUucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbG9yJzogKDAsMCwxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzogMC4xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2b2x1bWVJbnRlbnNpdHlTY2FsZSc6IDAuNX0pCiAgICAgICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb24nLCBzZWxmLm5vZGVMaWdodCwgJ3Bvc2l0aW9uJykKICAgICAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZUxpZ2h0LCdjb2xvcicsMyx7MDooMCwwLDIpLDUwMDooMCwyLDApLDEwMDA6KDIsMCwwKSwxNTAwOigyLDIsMCksMjAwMDooMiwwLDIpLDI1MDA6KDAsMSw2KSwzMDAwOigxLDIsMCl9LFRydWUpCiAgICAgICAgICAgIGJzLmFuaW1hdGUoc2VsZi5ub2RlTGlnaHQsICJpbnRlbnNpdHkiLCB7MDoxLjAsIDEwMDA6MS44LCAyMDAwOjEuMH0sIGxvb3AgPSBUcnVlKQogICAgICAgIAogICAgICAgIG0gPSBicy5uZXdOb2RlKCdtYXRoJywgb3duZXI9c2VsZi5ub2RlLCBhdHRycz17J2lucHV0MSc6ICgwLCAwLjgsIDApLCAnb3BlcmF0aW9uJzogJ2FkZCd9KQogICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb24nLCBtLCAnaW5wdXQyJykKICAgICAgICBzZWxmLl9ocFRleHQgPSBicy5uZXdOb2RlKCd0ZXh0Jywgb3duZXI9c2VsZi5ub2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsndGV4dCc6JycsICdpbldvcmxkJzpUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hhZG93JzoxLjAsJ2ZsYXRuZXNzJzoxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb2xvcic6KDEsMSwxKSwnc2NhbGUnOjAuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBbGlnbic6J2NlbnRlcid9KQogICAgICAgIG0uY29ubmVjdEF0dHIoJ291dHB1dCcsIHNlbGYuX2hwVGV4dCwgJ3Bvc2l0aW9uJykKICAgICAgICBicy5hbmltYXRlKHNlbGYuX2hwVGV4dCwgJ3NjYWxlJywgezA6IDAuMCwgMTAwOiAwLjAwOH0pCiAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYuX2hwVGV4dCwnY29sb3InLDMsezA6KDAsMCwyKSw1MDA6KDAsMiwwKSwxMDAwOigyLDAsMCksMTUwMDooMiwyLDApLDIwMDA6KDIsMCwyKSwyNTAwOigwLDEsNiksMzAwMDooMSwyLDApfSxUcnVlKQogICAgICAgIGlmIGRvbi5zaG93SFA6IHNlbGYuX2hwVGV4dC50ZXh0ID0gJ0hQOiAnICsgc3RyKGludChzZWxmLmhpdFBvaW50cykpCiAgICAgICAgZWxzZTogc2VsZi5faHBUZXh0LnRleHQgPSAnJwogICAgICAgICAgICAKICAgIGRlZiBvbkZpbmFsaXplKHNlbGYpOgogICAgICAgIGJzLkFjdG9yLm9uRmluYWxpemUoc2VsZikKCiAgICAgICAgIyByZWxlYXNlIGNhbGxiYWNrcy9yZWZzIHNvIHdlIGRvbid0IHdpbmQgdXAgd2l0aCBkZXBlbmRlbmN5IGxvb3BzLi4KICAgICAgICBzZWxmLl9kcm9wcGVkQm9tYkNhbGxiYWNrcyA9IFtdCiAgICAgICAgc2VsZi5wdW5jaENhbGxiYWNrID0gTm9uZQogICAgICAgIHNlbGYucGlja1VwUG93ZXJ1cENhbGxiYWNrID0gTm9uZQoKICAgIGRlZiBhZGREcm9wcGVkQm9tYkNhbGxiYWNrKHNlbGYsIGNhbGwpOgogICAgICAgICIiIgogICAgICAgIEFkZCBhIGNhbGwgdG8gYmUgcnVuIHdoZW5ldmVyIHRoaXMgU3BheiBkcm9wcyBhIGJvbWIuCiAgICAgICAgVGhlIHNwYXogYW5kIHRoZSBuZXdseS1kcm9wcGVkIGJvbWIgYXJlIHBhc3NlZCBhcyBhcmd1bWVudHMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fZHJvcHBlZEJvbWJDYWxsYmFja3MuYXBwZW5kKGNhbGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGRlZiBpc0FsaXZlKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIE1ldGhvZCBvdmVycmlkZTsgcmV0dXJucyB3aGV0aGVyIG9sJyBzcGF6IGlzIHN0aWxsIGtpY2tpbicuCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIG5vdCBzZWxmLl9kZWFkCgogICAgQGNsYXNzbWV0aG9kCiAgICBkZWYgZ2V0RmFjdG9yeShjbHMpOgogICAgICAgICIiIgogICAgICAgIFJldHVybnMgdGhlIHNoYXJlZCBicy5TcGF6RmFjdG9yeSBvYmplY3QsIGNyZWF0aW5nIGl0IGlmIG5lY2Vzc2FyeS4KICAgICAgICAiIiIKICAgICAgICBhY3Rpdml0eSA9IGJzLmdldEFjdGl2aXR5KCkKICAgICAgICBpZiBhY3Rpdml0eSBpcyBOb25lOiByYWlzZSBFeGNlcHRpb24oIm5vIGN1cnJlbnQgYWN0aXZpdHkiKQogICAgICAgIHRyeTogcmV0dXJuIGFjdGl2aXR5Ll9zaGFyZWRTcGF6RmFjdG9yeQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIGYgPSBhY3Rpdml0eS5fc2hhcmVkU3BhekZhY3RvcnkgPSBTcGF6RmFjdG9yeSgpCiAgICAgICAgICAgIHJldHVybiBmCgogICAgZGVmIGV4aXN0cyhzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5ub2RlLmV4aXN0cygpCgogICAgZGVmIF9oaWRlU2NvcmVUZXh0KHNlbGYpOgogICAgICAgIGlmIHNlbGYuX3Njb3JlVGV4dC5leGlzdHMoKToKICAgICAgICAgICAgYnMuYW5pbWF0ZShzZWxmLl9zY29yZVRleHQsICdzY2FsZScsCiAgICAgICAgICAgICAgICAgICAgICAgezA6c2VsZi5fc2NvcmVUZXh0LnNjYWxlLCAyMDA6MH0pCgogICAgZGVmIF90dXJib0ZpbHRlckFkZFByZXNzKHNlbGYsIHNvdXJjZSk6CiAgICAgICAgdCA9IGJzLmdldE5ldFRpbWUoKQogICAgICAgIHRCdWNrZXQgPSBpbnQodC8xMDAwKQogICAgICAgIGlmIHRCdWNrZXQgPT0gc2VsZi5fdHVyYm9GaWx0ZXJUaW1lQnVja2V0OgogICAgICAgICAgICBpZiB0ICE9IHNlbGYuX3R1cmJvRmlsdGVyVGltZXMuZ2V0KHNvdXJjZSwgMCk6CiAgICAgICAgICAgICAgICBzZWxmLl90dXJib0ZpbHRlckNvdW50c1tzb3VyY2VdID0gXAogICAgICAgICAgICAgICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyQ291bnRzLmdldChzb3VyY2UsIDApICsgMQogICAgICAgICAgICAgICAgc2VsZi5fdHVyYm9GaWx0ZXJUaW1lc1tzb3VyY2VdID0gdAogICAgICAgICAgICAgICAgaWYgc2VsZi5fdHVyYm9GaWx0ZXJDb3VudHNbc291cmNlXSA9PSAxNToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgia25vY2tvdXQiLCA1MDAuMCkKICAgICAgICAgICAgICAgICAgICByZWFsVGltZSA9IGJzLmdldFJlYWxUaW1lKCkKICAgICAgICAgICAgICAgICAgICBnbG9iYWwgZ0xhc3RUdXJib1NwYW1XYXJuaW5nVGltZQogICAgICAgICAgICAgICAgICAgIGlmIHJlYWxUaW1lID4gZ0xhc3RUdXJib1NwYW1XYXJuaW5nVGltZSArIDMwMDAwOgogICAgICAgICAgICAgICAgICAgICAgICBnTGFzdFR1cmJvU3BhbVdhcm5pbmdUaW1lID0gcmVhbFRpbWUKICAgICAgICAgICAgICAgICAgICAgICAgYnMuc2NyZWVuTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLkxzdHIodHJhbnNsYXRlPSgnc3RhdGVtZW50cycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKCdXYXJuaW5nIHRvICR7TkFNRX06ICAnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0dXJibyAvIGJ1dHRvbi1zcGFtbWluZyBrbm9ja3MnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgeW91IG91dC4nKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnM9WygnJHtOQU1FfScsIHNlbGYubm9kZS5uYW1lKV0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I9KDEsIDAuNSwgMCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChicy5nZXRTb3VuZCgnZXJyb3InKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLl90dXJib0ZpbHRlclRpbWVzID0ge30KICAgICAgICAgICAgc2VsZi5fdHVyYm9GaWx0ZXJUaW1lQnVja2V0ID0gdEJ1Y2tldAogICAgICAgICAgICBzZWxmLl90dXJib0ZpbHRlckNvdW50cyA9IHtzb3VyY2U6MX0KICAgICAgICAKICAgIGRlZiBzZXRTY29yZVRleHQoc2VsZiwgdCwgY29sb3I9KDEsIDEsIDAuNCksIGZsYXNoPUZhbHNlKToKICAgICAgICBjb2xvckZpbiA9IGJzLmdldFNhZmVDb2xvcihjb2xvcilbOjNdCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgdHJ5OiBleGlzdHMgPSBzZWxmLl9zY29yZVRleHQuZXhpc3RzKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOiBleGlzdHMgPSBGYWxzZQogICAgICAgIGlmIG5vdCBleGlzdHM6CiAgICAgICAgICAgIHN0YXJ0U2NhbGUgPSAwLjAKICAgICAgICAgICAgbSA9IGJzLm5ld05vZGUoJ21hdGgnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsgJ2lucHV0MSc6KDAsIDEuNCwgMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcGVyYXRpb24nOidhZGQnIH0pCiAgICAgICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigndG9yc29Qb3NpdGlvbicsIG0sICdpbnB1dDInKQogICAgICAgICAgICBzZWxmLl9zY29yZVRleHQgPSBicy5uZXdOb2RlKCd0ZXh0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3duZXI9c2VsZi5ub2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3RleHQnOnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaW5Xb3JsZCc6VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzaGFkb3cnOjEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmbGF0bmVzcyc6MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbG9yJzpjb2xvckZpbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzY2FsZSc6MC4wMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoQWxpZ24nOidjZW50ZXInfSkKICAgICAgICAgICAgbS5jb25uZWN0QXR0cignb3V0cHV0Jywgc2VsZi5fc2NvcmVUZXh0LCAncG9zaXRpb24nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuX3Njb3JlVGV4dC5jb2xvciA9IGNvbG9yRmluCiAgICAgICAgICAgIHN0YXJ0U2NhbGUgPSBzZWxmLl9zY29yZVRleHQuc2NhbGUKICAgICAgICAgICAgc2VsZi5fc2NvcmVUZXh0LnRleHQgPSB0CiAgICAgICAgaWYgZmxhc2g6CiAgICAgICAgICAgIGNvbWJpbmUgPSBicy5uZXdOb2RlKCJjb21iaW5lIiwgb3duZXI9c2VsZi5fc2NvcmVUZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3NpemUnOjN9KQogICAgICAgICAgICBzYyA9IDEuOAogICAgICAgICAgICBvZmZzID0gMC41CiAgICAgICAgICAgIHQgPSAzMDAKICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoMyk6CiAgICAgICAgICAgICAgICBjMSA9IG9mZnMrc2MqY29sb3JGaW5baV0KICAgICAgICAgICAgICAgIGMyID0gY29sb3JGaW5baV0KICAgICAgICAgICAgICAgIGJzLmFuaW1hdGUoY29tYmluZSwgJ2lucHV0JytzdHIoaSksIHswLjUqdDpjMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMC43NSp0OmMxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxLjAqdDpjMn0pCiAgICAgICAgICAgIGNvbWJpbmUuY29ubmVjdEF0dHIoJ291dHB1dCcsIHNlbGYuX3Njb3JlVGV4dCwgJ2NvbG9yJykKICAgICAgICAgICAgCiAgICAgICAgYnMuYW5pbWF0ZShzZWxmLl9zY29yZVRleHQsICdzY2FsZScsIHswOnN0YXJ0U2NhbGUsIDIwMDowLjAyfSkKICAgICAgICBzZWxmLl9zY29yZVRleHRIaWRlVGltZXIgPSBicy5UaW1lcigxMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2hpZGVTY29yZVRleHQpKQogICAgICAgIAogICAgZGVmIG9uSnVtcFByZXNzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byAncHJlc3MganVtcCcgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgYnkgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgaWYgdCAtIHNlbGYubGFzdEp1bXBUaW1lID49IHNlbGYuX2p1bXBDb29sZG93bjoKICAgICAgICAgICAgc2VsZi5ub2RlLmp1bXBQcmVzc2VkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmxhc3RKdW1wVGltZSA9IHQKICAgICAgICBzZWxmLl90dXJib0ZpbHRlckFkZFByZXNzKCdqdW1wJykKICAgICAgICAKICAgIGRlZiBvbkp1bXBmbHkoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdwcmVzcyBqdW1wJyBvbiB0aGlzIHNwYXo7CiAgICAgICAgdXNlZCBieSBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICBpZiB0IC0gc2VsZi5sYXN0SnVtcFRpbWUgPj0gc2VsZi5fanVtcENvb2xkb3duOgogICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgiaW1wdWxzZSIsc2VsZi5ub2RlLnBvc2l0aW9uWzBdLHNlbGYubm9kZS5wb3NpdGlvblsxXS0yLHNlbGYubm9kZS5wb3NpdGlvblsyXSxzZWxmLm5vZGUudmVsb2NpdHlbMF0qMCwyMCArMC4wMSoodCAtIHNlbGYubGFzdEp1bXBUaW1lKSxzZWxmLm5vZGUudmVsb2NpdHlbMl0qMCwxMCw1LDAsMCxzZWxmLm5vZGUudmVsb2NpdHlbMF0qLTAuMSwyMCArIDAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjApCiAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJpbXB1bHNlIixzZWxmLm5vZGUucG9zaXRpb25bMF0sc2VsZi5ub2RlLnBvc2l0aW9uWzFdLHNlbGYubm9kZS5wb3NpdGlvblsyXSxzZWxmLm5vZGUudmVsb2NpdHlbMF0qMCwyMCArMC4wMSoodCAtIHNlbGYubGFzdEp1bXBUaW1lKSxzZWxmLm5vZGUudmVsb2NpdHlbMl0qMCwxMCw1LDAsMCxzZWxmLm5vZGUudmVsb2NpdHlbMF0qLTAuMSwyMCArIDAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjApCiAgICAgICAgICAgIHNlbGYubm9kZS5qdW1wUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgc2VsZi5sYXN0SnVtcFRpbWUgPSB0CiAgICAgICAgc2VsZi5fdHVyYm9GaWx0ZXJBZGRQcmVzcygnanVtcCcpCgogICAgZGVmIG9uSnVtcFJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdyZWxlYXNlIGp1bXAnIG9uIHRoaXMgc3BhejsKICAgICAgICB1c2VkIGJ5IHBsYXllciBvciBBSSBjb25uZWN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KICAgICAgICBzZWxmLm5vZGUuanVtcFByZXNzZWQgPSBGYWxzZQoKICAgIGRlZiBvblBpY2tVcFByZXNzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byAncHJlc3MgcGljay11cCcgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgYnkgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgaWYgdCAtIHNlbGYubGFzdFBpY2t1cFRpbWUgPj0gc2VsZi5fcGlja3VwQ29vbGRvd246CiAgICAgICAgICAgIHNlbGYubm9kZS5waWNrVXBQcmVzc2VkID0gVHJ1ZQogICAgICAgICAgICBzZWxmLmxhc3RQaWNrdXBUaW1lID0gdAogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyQWRkUHJlc3MoJ3BpY2t1cCcpCgogICAgZGVmIG9uUGlja1VwUmVsZWFzZShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gJ3JlbGVhc2UgcGljay11cCcgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgYnkgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYubm9kZS5waWNrVXBQcmVzc2VkID0gRmFsc2UKCiAgICBkZWYgX29uSG9sZFBvc2l0aW9uUHJlc3Moc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdwcmVzcyBob2xkLXBvc2l0aW9uJyBvbiB0aGlzIHNwYXo7CiAgICAgICAgdXNlZCBmb3IgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYubm9kZS5ob2xkUG9zaXRpb25QcmVzc2VkID0gVHJ1ZQogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyQWRkUHJlc3MoJ2hvbGRwb3NpdGlvbicpCgogICAgZGVmIF9vbkhvbGRQb3NpdGlvblJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdyZWxlYXNlIGhvbGQtcG9zaXRpb24nIG9uIHRoaXMgc3BhejsKICAgICAgICB1c2VkIGZvciBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgc2VsZi5ub2RlLmhvbGRQb3NpdGlvblByZXNzZWQgPSBGYWxzZQoKICAgIGRlZiBvblB1bmNoUHJlc3Moc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdwcmVzcyBwdW5jaCcgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgZm9yIHBsYXllciBvciBBSSBjb25uZWN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBpZiAobm90IHNlbGYubm9kZS5leGlzdHMoKQogICAgICAgICAgICBvciBzZWxmLmZyb3plbgogICAgICAgICAgICBvciBzZWxmLm5vZGUua25vY2tvdXQgPiAwLjApOiByZXR1cm4KICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgIGlmIHQgLSBzZWxmLmxhc3RQdW5jaFRpbWUgPj0gc2VsZi5fcHVuY2hDb29sZG93bjoKICAgICAgICAgICAgaWYgc2VsZi5wdW5jaENhbGxiYWNrIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5wdW5jaENhbGxiYWNrKHNlbGYpCiAgICAgICAgICAgIHNlbGYuX3B1bmNoZWROb2RlcyA9IHNldCgpICMgcmVzZXQgdGhpcy4uCiAgICAgICAgICAgIHNlbGYubGFzdFB1bmNoVGltZSA9IHQKICAgICAgICAgICAgc2VsZi5ub2RlLnB1bmNoUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgaWYgbm90IHNlbGYubm9kZS5ob2xkTm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAsIGJzLldlYWtDYWxsKHNlbGYuX3NhZmVQbGF5U291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmdldEZhY3RvcnkoKS5zd2lzaFNvdW5kLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMC44KSkKICAgICAgICBzZWxmLl90dXJib0ZpbHRlckFkZFByZXNzKCdwdW5jaCcpCgogICAgZGVmIF9zYWZlUGxheVNvdW5kKHNlbGYsIHNvdW5kLCB2b2x1bWUpOgogICAgICAgICIiIgogICAgICAgIFBsYXlzIGEgc291bmQgYXQgb3VyIHBvc2l0aW9uIGlmIHdlIGV4aXN0LgogICAgICAgICIiIgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgYnMucGxheVNvdW5kKHNvdW5kLCB2b2x1bWUsIHNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICAKICAgIGRlZiBvblB1bmNoUmVsZWFzZShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gJ3JlbGVhc2UgcHVuY2gnIG9uIHRoaXMgc3BhejsKICAgICAgICB1c2VkIGZvciBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgc2VsZi5ub2RlLnB1bmNoUHJlc3NlZCA9IEZhbHNlCgogICAgZGVmIG9uQm9tYlByZXNzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byAncHJlc3MgYm9tYicgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgZm9yIHBsYXllciBvciBBSSBjb25uZWN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KICAgICAgICAKICAgICAgICBpZiBzZWxmLl9kZWFkIG9yIHNlbGYuZnJvemVuOiByZXR1cm4KICAgICAgICBpZiBzZWxmLm5vZGUua25vY2tvdXQgPiAwLjA6IHJldHVybgogICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgaWYgdCAtIHNlbGYubGFzdEJvbWJUaW1lID49IHNlbGYuX2JvbWJDb29sZG93bjoKICAgICAgICAgICAgc2VsZi5sYXN0Qm9tYlRpbWUgPSB0CiAgICAgICAgICAgIHNlbGYubm9kZS5ib21iUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgaWYgbm90IHNlbGYubm9kZS5ob2xkTm9kZS5leGlzdHMoKTogc2VsZi5kcm9wQm9tYigpCiAgICAgICAgc2VsZi5fdHVyYm9GaWx0ZXJBZGRQcmVzcygnYm9tYicpCgogICAgZGVmIG9uQm9tYlJlbGVhc2Uoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdyZWxlYXNlIGJvbWInIG9uIHRoaXMgc3BhejsgCiAgICAgICAgdXNlZCBmb3IgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYubm9kZS5ib21iUHJlc3NlZCA9IEZhbHNlCgogICAgZGVmIG9uUnVuKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gJ3ByZXNzIHJ1bicgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgZm9yIHBsYXllciBvciBBSSBjb25uZWN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KCiAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICBzZWxmLmxhc3RSdW5UaW1lID0gdAogICAgICAgIHNlbGYubm9kZS5ydW4gPSB2YWx1ZQoKICAgICAgICAjIGZpbHRlcmluZyB0aGVzZSBldmVudHMgd291bGQgYmUgdG91Z2ggc2luY2UgaXRzIGFuIGFuYWxvZwogICAgICAgICMgdmFsdWUsIGJ1dCBsZXRzIHN0aWxsIHBhc3MgZnVsbCAwLXRvLTEgcHJlc3NlcyBhbG9uZyB0bwogICAgICAgICMgdGhlIHR1cmJvIGZpbHRlciB0byBwdW5pc2ggcGxheWVycyBpZiBpdCBsb29rcyBsaWtlIHRoZXkncmUgdHVyYm8taW5nCiAgICAgICAgaWYgc2VsZi5fbGFzdFJ1blZhbHVlIDwgMC4wMSBhbmQgdmFsdWUgPiAwLjk5OgogICAgICAgICAgICBzZWxmLl90dXJib0ZpbHRlckFkZFByZXNzKCdydW4nKQogICAgICAgICAgICAKICAgICAgICBzZWxmLl9sYXN0UnVuVmFsdWUgPSB2YWx1ZQoKICAgIGRlZiBvblNsb3dSdW4oc2VsZiwgdmFsdWUpOgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYubm9kZS5ydW4gPSAtMS4wCgogICAgZGVmIG9uU2xvd01vdmUwKHNlbGYsIHZhbHVlKToKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KICAgICAgICBzZWxmLm5vZGUubW92ZVVwRG93biA9IHZhbHVlKjAuMgoKICAgIGRlZiBvblNsb3dNb3ZlMShzZWxmLCB2YWx1ZSk6CiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuIAogICAgICAgIHNlbGYubm9kZS5tb3ZlTGVmdFJpZ2h0ID0gdmFsdWUqMC4yCgogICAgZGVmIG9uRmx5UHJlc3Moc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ2FsbGVkIHRvICdwcmVzcyBmbHknIG9uIHRoaXMgc3BhejsKICAgICAgICB1c2VkIGZvciBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgIyBub3QgYWRkaW5nIGEgY29vbGRvd24gdGltZSBoZXJlIGZvciBub3c7IHNsaWdodGx5IHdvcnJpZWQKICAgICAgICAjIGlucHV0IGV2ZW50cyBnZXQgY2x1c3RlcmVkIHVwIGR1cmluZyBuZXQtZ2FtZXMgYW5kIHdlJ2Qgd2luZCB1cAogICAgICAgICMga2lsbGluZyBhIGxvdCBhbmQgbWFraW5nIGl0IGhhcmQgdG8gZmx5Li4gc2hvdWxkIGxvb2sgaW50byB0aGlzLgogICAgICAgIHNlbGYubm9kZS5mbHlQcmVzc2VkID0gVHJ1ZQogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyQWRkUHJlc3MoJ2ZseScpCgogICAgZGVmIG9uRmx5UmVsZWFzZShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gJ3JlbGVhc2UgZmx5JyBvbiB0aGlzIHNwYXo7CiAgICAgICAgdXNlZCBmb3IgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYubm9kZS5mbHlQcmVzc2VkID0gRmFsc2UKCiAgICBkZWYgb25Nb3ZlKHNlbGYsIHgsIHkpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byBzZXQgdGhlIGpveXN0aWNrIGFtb3VudCBmb3IgdGhpcyBzcGF6OwogICAgICAgIHVzZWQgZm9yIHBsYXllciBvciBBSSBjb25uZWN0aW9ucy4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgibW92ZSIsIHgsIHkpCiAgICAgICAgCiAgICBkZWYgb25Nb3ZlVXBEb3duKHNlbGYsIHZhbHVlKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gc2V0IHRoZSB1cC9kb3duIGpveXN0aWNrIGFtb3VudCBvbiB0aGlzIHNwYXo7CiAgICAgICAgdXNlZCBmb3IgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgIHZhbHVlIHdpbGwgYmUgYmV0d2VlbiAtMzI3NjggdG8gMzI3NjcKICAgICAgICBXQVJOSU5HOiBkZXByZWNhdGVkOyB1c2Ugb25Nb3ZlIGluc3RlYWQuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgc2VsZi5ub2RlLm1vdmVVcERvd24gPSB2YWx1ZQoKICAgIGRlZiBvbk1vdmVMZWZ0UmlnaHQoc2VsZiwgdmFsdWUpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byBzZXQgdGhlIGxlZnQvcmlnaHQgam95c3RpY2sgYW1vdW50IG9uIHRoaXMgc3BhejsKICAgICAgICB1c2VkIGZvciBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgdmFsdWUgd2lsbCBiZSBiZXR3ZWVuIC0zMjc2OCB0byAzMjc2NwogICAgICAgIFdBUk5JTkc6IGRlcHJlY2F0ZWQ7IHVzZSBvbk1vdmUgaW5zdGVhZC4KICAgICAgICAiIiIKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOiByZXR1cm4KICAgICAgICBzZWxmLm5vZGUubW92ZUxlZnRSaWdodCA9IHZhbHVlCgogICAgZGVmIG9uUHVuY2hlZChzZWxmLCBkYW1hZ2UpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB3aGVuIHRoaXMgc3BheiBnZXRzIHB1bmNoZWQuCiAgICAgICAgIiIiCiAgICAgICAgcGFzcwoKICAgIGRlZiBnZXREZWF0aFBvaW50cyhzZWxmLCBob3cpOgogICAgICAgICdHZXQgdGhlIHBvaW50cyBhd2FyZGVkIGZvciBraWxsaW5nIHRoaXMgc3BheicKICAgICAgICBudW1IaXRzID0gZmxvYXQobWF4KDEsIHNlbGYuX251bVRpbWVzSGl0KSkKICAgICAgICAjIGJhc2UgcG9pbnRzIGlzIHNpbXBseSAxMCBmb3IgMS1oaXQta2lsbHMgYW5kIDUgb3RoZXJ3aXNlCiAgICAgICAgaW1wb3J0YW5jZSA9IDIgaWYgbnVtSGl0cyA8IDIgZWxzZSAxCiAgICAgICAgcmV0dXJuICgoMTAgaWYgbnVtSGl0cyA8IDIgZWxzZSA1KSAqIHNlbGYucG9pbnRzTXVsdCwgaW1wb3J0YW5jZSkKCiAgICBkZWYgY3Vyc2Uoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgR2l2ZSB0aGlzIHBvb3Igc3BheiBhIGN1cnNlOwogICAgICAgIGhlIHdpbGwgZXhwbG9kZSBpbiA1IHNlY29uZHMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgbm90IHNlbGYuX2N1cnNlZDoKICAgICAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgICAgIHNlbGYuX2N1cnNlZCA9IFRydWUKICAgICAgICAgICAgIyBhZGQgdGhlIGN1cnNlIG1hdGVyaWFsLi4KICAgICAgICAgICAgZm9yIGF0dHIgaW4gWydtYXRlcmlhbHMnLCAncm9sbGVyTWF0ZXJpYWxzJ106CiAgICAgICAgICAgICAgICBtYXRlcmlhbHMgPSBnZXRhdHRyKHNlbGYubm9kZSwgYXR0cikKICAgICAgICAgICAgICAgIGlmIG5vdCBmYWN0b3J5LmN1cnNlTWF0ZXJpYWwgaW4gbWF0ZXJpYWxzOgogICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZi5ub2RlLCBhdHRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0ZXJpYWxzICsgKGZhY3RvcnkuY3Vyc2VNYXRlcmlhbCwpKQoKICAgICAgICAgICAgIyAtMSBzcGVjaWZpZXMgbm8gdGltZSBsaW1pdAogICAgICAgICAgICBpZiBzZWxmLmN1cnNlVGltZSA9PSAtMToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jdXJzZURlYXRoVGltZSA9IC0xCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY3Vyc2VEZWF0aFRpbWUgPSBicy5nZXRHYW1lVGltZSgpKzUwMDAKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MDAwLCBicy5XZWFrQ2FsbChzZWxmLmN1cnNlRXhwbG9kZSkpCiAgICAgICAgICAgICAgICAKICAgIGRlZiBzZXRJbnZpc2liaWxpdHkoc2VsZik6CiAgICAgICAgbGlnaHQgPSBicy5uZXdOb2RlKCdsaWdodCcsCiAgICAgICAgICAgICAgICAgIGF0dHJzPXsncG9zaXRpb24nOihzZWxmLm5vZGUucG9zaXRpb24pLAogICAgICAgICAgICAgICAgICAgICdjb2xvcic6c2VsZi5ub2RlLmNvbG9yLAogICAgICAgICAgICAgICAgICAgICd2b2x1bWVJbnRlbnNpdHlTY2FsZSc6MS4wLAogICAgICAgICAgICAgICAgICAgICdyYWRpdXMnOjAuMX0pCiAgICAgICAgYnNVdGlscy5hbmltYXRlKGxpZ2h0LCJpbnRlbnNpdHkiLHswOjAsNTA6NSw1MDA6MH0pCiAgICAgICAgYnMucGxheVNvdW5kKGJzLmdldFNvdW5kKCdsaWdodG9mZicpKQogICAgICAgIHNlbGYubm9kZS5jb25uZWN0QXR0cigncG9zaXRpb25DZW50ZXInLGxpZ2h0LCdwb3NpdGlvbicpCgogICAgICAgIHNlbGYubm9kZS5uYW1lID0gJyAnCiAgICAgICAgc2VsZi5ub2RlLnN0eWxlID0gJ2FnZW50JwogICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLnRvcnNvTW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLnBlbHZpc01vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS51cHBlckFybU1vZGVsID0gTm9uZQogICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBOb25lCiAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUudXBwZXJMZWdNb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUubG93ZXJMZWdNb2RlbCA9IE5vbmUKICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gTm9uZSAgICAgCiAgICAgICAgCiAgICBkZWYgc2V0TmFtZShzZWxmKToKICAgICAgICBzZWxmLm5vZGUubmFtZSArPSByYW5kb20uY2hvaWNlKFsnXG5USEUgQk9TUycsJ1xuTk9PQicsJ1xuUFJPJywnXG5LaWxsIE1lJywnXG5Ob29ieSddKQogICAgICAgIAogICAgZGVmIG9uSGlKdW1wKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENhbGxlZCB0byAncHJlc3MganVtcCcgb24gdGhpcyBzcGF6OwogICAgICAgIHVzZWQgYnkgcGxheWVyIG9yIEFJIGNvbm5lY3Rpb25zLgogICAgICAgICIiIgogICAgICAgIGlmIChub3Qgc2VsZi5ub2RlLmV4aXN0cygpCiAgICAgICAgICAgIG9yIHNlbGYuZnJvemVuCiAgICAgICAgICAgIG9yIHNlbGYubm9kZS5rbm9ja291dCA+IDAuMCk6IHJldHVybgogICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgaWYgdCAtIHNlbGYubGFzdEp1bXBUaW1lID49IDA6CiAgICAgICAgICAgIHNlbGYubm9kZS5qdW1wUHJlc3NlZCA9IEZhbHNlCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuanVtcFByZXNzZWQgYW5kIGJzLmdldEdhbWVUaW1lKCkgLSBzZWxmLmxhc3RKdW1wVGltZT49NTAwOgogICAgICAgICAgICAJYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNoaWVsZERvd25Tb3VuZCwxLjAsIHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICAgICAgCXQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgiaW1wdWxzZSIsc2VsZi5ub2RlLnBvc2l0aW9uWzBdLHNlbGYubm9kZS5wb3NpdGlvblsxXS0yLHNlbGYubm9kZS5wb3NpdGlvblsyXSxzZWxmLm5vZGUudmVsb2NpdHlbMF0qMCwyMCArMC4wMSoodCAtIHNlbGYubGFzdEp1bXBUaW1lKSxzZWxmLm5vZGUudmVsb2NpdHlbMl0qMCwxMCw1LDAsMCxzZWxmLm5vZGUudmVsb2NpdHlbMF0qLTAuMSwyMCArIDAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjApCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgiaW1wdWxzZSIsc2VsZi5ub2RlLnBvc2l0aW9uWzBdLHNlbGYubm9kZS5wb3NpdGlvblsxXSxzZWxmLm5vZGUucG9zaXRpb25bMl0sc2VsZi5ub2RlLnZlbG9jaXR5WzBdKjAsMjAgKzAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjAsMTAsNSwwLDAsc2VsZi5ub2RlLnZlbG9jaXR5WzBdKi0wLjEsMjAgKyAwLjAxKih0IC0gc2VsZi5sYXN0SnVtcFRpbWUpLHNlbGYubm9kZS52ZWxvY2l0eVsyXSowKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImltcHVsc2UiLHNlbGYubm9kZS5wb3NpdGlvblswXSxzZWxmLm5vZGUucG9zaXRpb25bMV0rMixzZWxmLm5vZGUucG9zaXRpb25bMl0sc2VsZi5ub2RlLnZlbG9jaXR5WzBdKjAsMjAgKzAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjAsMTAsNSwwLDAsc2VsZi5ub2RlLnZlbG9jaXR5WzBdKi0wLjEsMjAgKyAwLjAxKih0IC0gc2VsZi5sYXN0SnVtcFRpbWUpLHNlbGYubm9kZS52ZWxvY2l0eVsyXSowKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249KHNlbGYubm9kZS5wb3NpdGlvblswXSxzZWxmLm5vZGUucG9zaXRpb25bMV0tMC4yLHNlbGYubm9kZS5wb3NpdGlvblsyXSksIHZlbG9jaXR5PSgwLDAsMCksIGNvdW50PXJhbmRvbS5yYW5kcmFuZ2UoMTAsMjApLCBzY2FsZT0wLjM1LCBzcHJlYWQ9MC4zMSwgY2h1bmtUeXBlPSdzcGFyaycpCiAgICAgICAgICAgIHNlbGYubGFzdEp1bXBUaW1lID0gdAogICAgICAgICAgICBpZiBzZWxmLm5vZGUuanVtcFByZXNzZWQgYW5kIHQgLSBzZWxmLmxhc3RKdW1wVGltZSA+PSAxMDAwOgogICAgICAgICAgICAJYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNoaWVsZFVwU291bmQsIDEuMCwgcG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKQoKICAgIGRlZiBvbkhpSnVtcENoYXJnZShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBDYWxsZWQgdG8gJ3JlbGVhc2UgYm9tYicgb24gdGhpcyBzcGF6OyAKICAgICAgICB1c2VkIGZvciBwbGF5ZXIgb3IgQUkgY29ubmVjdGlvbnMuCiAgICAgICAgIiIiCiAgICAgICAgaWYgKG5vdCBzZWxmLm5vZGUuZXhpc3RzKCkKICAgICAgICAgICAgb3Igc2VsZi5mcm96ZW4KICAgICAgICAgICAgb3Igc2VsZi5ub2RlLmtub2Nrb3V0ID4gMC4wKTogcmV0dXJuCiAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICBpZiB0IC0gc2VsZi5sYXN0SnVtcFRpbWUgPj0gc2VsZi5fanVtcENvb2xkb3duOgogICAgICAgICAgICBzZWxmLm5vZGUuanVtcFByZXNzZWQgPSBUcnVlCiAgICAgICAgICAgIGlmIHNlbGYubm9kZS5qdW1wUHJlc3NlZCBhbmQgYnMuZ2V0R2FtZVRpbWUoKSAtIHNlbGYubGFzdEp1bXBUaW1lPj01MDA6CiAgICAgICAgICAgIAlicy5wbGF5U291bmQoc2VsZi5nZXRGYWN0b3J5KCkuc2hpZWxkVXBTb3VuZCwgMS4wLCBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgIHNlbGYubGFzdEp1bXBUaW1lID0gdAogICAgICAgIHNlbGYuX3R1cmJvRmlsdGVyQWRkUHJlc3MoJ2p1bXAnKSAgICAgIAoKICAgIGRlZiBlcXVpcEJveGluZ0dsb3ZlcyhzZWxmKToKICAgICAgICAiIiIKICAgICAgICBHaXZlIHRoaXMgc3BheiBzb21lIGJveGluZyBnbG92ZXMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5ub2RlLmJveGluZ0dsb3ZlcyA9IDEKICAgICAgICBpZiBzZWxmLl9kZW1vTW9kZTogIyBwcmVzZXJ2ZSBvbGQgYmVoYXZpb3IKICAgICAgICAgICAgc2VsZi5fcHVuY2hQb3dlclNjYWxlID0gMS43CiAgICAgICAgICAgIHNlbGYuX3B1bmNoQ29vbGRvd24gPSAzMDAKICAgICAgICBlbHNlOgogICAgICAgICAgICBmYWN0b3J5ID0gc2VsZi5nZXRGYWN0b3J5KCkKICAgICAgICAgICAgc2VsZi5fcHVuY2hQb3dlclNjYWxlID0gZmFjdG9yeS5wdW5jaFBvd2VyU2NhbGVHbG92ZXMKICAgICAgICAgICAgc2VsZi5fcHVuY2hDb29sZG93biA9IGZhY3RvcnkucHVuY2hDb29sZG93bkdsb3ZlcwoKICAgIGRlZiBlcXVpcFNoaWVsZHMoc2VsZiwgZGVjYXk9RmFsc2UsIGNvbG9yID0gKDAuMywgMC4yLCAyLjApKToKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBicy5wcmludEVycm9yKCdDYW5cJ3QgZXF1aXAgc2hpZWxkczsgbm8gbm9kZS4nKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBmYWN0b3J5ID0gc2VsZi5nZXRGYWN0b3J5KCkKICAgICAgICBpZiBzZWxmLnNoaWVsZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5zaGllbGRIaXRQb2ludHMgPSAwCiAgICAgICAgICAgIHNlbGYuc2hpZWxkLmRlbGV0ZSgpCiAgICAgICAgICAgIHNlbGYuc2hpZWxkID0gTm9uZQogICAgICAgICAgICBzZWxmLnNoaWVsZERlY2F5VGltZXIgPSBOb25lCiAgICAgICAgICAgIHNlbGYuZXF1aXBZZWxsb3dTaGllbGRzKGRlY2F5ID0gVHJ1ZSwgaHAgPSA2NTAgKyBzZWxmLnNoaWVsZEhpdFBvaW50cywgaHBNYXggPSA5MDApCiAgICAgICAgaWYgc2VsZi5zaGllbGQgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5zaGllbGQgPSBicy5uZXdOb2RlKCdzaGllbGQnLCBvd25lcj1zZWxmLm5vZGUsIGF0dHJzPXsnY29sb3InOihtaW4oc2VsZi5ub2RlLmNvbG9yWzBdICsgcmFuZG9tLnVuaWZvcm0oMCwwLjUpLCAwLjUpLCBtaW4oc2VsZi5ub2RlLmNvbG9yWzFdICsgcmFuZG9tLnVuaWZvcm0oMCwwLjUpLCAwLjUpLCBtaW4oc2VsZi5ub2RlLmNvbG9yWzJdICsgcmFuZG9tLnVuaWZvcm0oMCwwLjUpLCAwLjUpKSwgJ3JhZGl1cyc6MS4zfSkKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCdwb3NpdGlvbkNlbnRlcicsIHNlbGYuc2hpZWxkLCAncG9zaXRpb24nKQogICAgICAgIHNlbGYuc2hpZWxkSGl0UG9pbnRzID0gc2VsZi5zaGllbGRIaXRQb2ludHNNYXggPSA2NTAKICAgICAgICBzZWxmLnNoaWVsZERlY2F5UmF0ZSA9IGZhY3Rvcnkuc2hpZWxkRGVjYXlSYXRlIGlmIGRlY2F5IGVsc2UgMAogICAgICAgIHNlbGYuc2hpZWxkLmh1cnQgPSAwCiAgICAgICAgYnMucGxheVNvdW5kKGZhY3Rvcnkuc2hpZWxkVXBTb3VuZCwgMS4wLCBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCgogICAgICAgIGlmIHNlbGYuc2hpZWxkRGVjYXlSYXRlID4gMDoKICAgICAgICAgICAgc2VsZi5zaGllbGREZWNheVRpbWVyID0gYnMuVGltZXIoNTAwLCBicy5XZWFrQ2FsbChzZWxmLnNoaWVsZERlY2F5KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0PVRydWUpCiAgICAgICAgICAgIHNlbGYuc2hpZWxkLmFsd2F5c1Nob3dIZWFsdGhCYXIgPSBUcnVlICMgc28gdXNlciBjYW4gc2VlIHRoZSBkZWNheQogICAgICAgIGlmIHNlbGYueWVsbG93U2hpZWxkIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnNoaWVsZEhpdFBvaW50cyA9IDAKICAgICAgICAgICAgc2VsZi5zaGllbGQuZGVsZXRlKCkKICAgICAgICAgICAgc2VsZi5zaGllbGQgPSBOb25lCiAgICAgICAgICAgIHNlbGYuc2hpZWxkRGVjYXlUaW1lciA9IE5vbmUKICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgPSBtaW4oc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgKyBzZWxmLnNoaWVsZEhpdFBvaW50cywgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHNNYXgpCiAgICAgICAgICAgICAgICAKICAgIGRlZiBzaGllbGREZWNheShzZWxmKToKICAgICAgICBpZiBzZWxmLnNoaWVsZCBpcyBub3QgTm9uZSBhbmQgc2VsZi5zaGllbGQuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYuc2hpZWxkSGl0UG9pbnRzID0gXAogICAgICAgICAgICAgICAgbWF4KDAsIHNlbGYuc2hpZWxkSGl0UG9pbnRzIC0gc2VsZi5zaGllbGREZWNheVJhdGUpCiAgICAgICAgICAgIHNlbGYuc2hpZWxkLmh1cnQgPSBcCiAgICAgICAgICAgICAgICAxLjAgLSBmbG9hdChzZWxmLnNoaWVsZEhpdFBvaW50cykvc2VsZi5zaGllbGRIaXRQb2ludHNNYXgKICAgICAgICAgICAgaWYgc2VsZi5zaGllbGRIaXRQb2ludHMgPD0gMDoKICAgICAgICAgICAgICAgIHNlbGYuc2hpZWxkLmRlbGV0ZSgpCiAgICAgICAgICAgICAgICBzZWxmLnNoaWVsZCA9IE5vbmUKICAgICAgICAgICAgICAgIHNlbGYuc2hpZWxkRGVjYXlUaW1lciA9IE5vbmUKICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChzZWxmLmdldEZhY3RvcnkoKS5zaGllbGREb3duU291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMS4wLCBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5zaGllbGREZWNheVRpbWVyID0gTm9uZQoKICAgIGRlZiBlcXVpcFllbGxvd1NoaWVsZHMoc2VsZiwgZGVjYXk9RmFsc2UsIGhwID0gOTAwLCBocE1heCA9IDkwMCwgY29sb3IgPSAoNSwxLDApKToKICAgICAgICBpZiBub3Qgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBmYWN0b3J5ID0gc2VsZi5nZXRGYWN0b3J5KCkKICAgICAgICBpZiBzZWxmLnNoaWVsZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgYnNVdGlscy5hbmltYXRlKHNlbGYuc2hpZWxkLCAicmFkaXVzIiwgezA6c2VsZi5zaGllbGQucmFkaXVzLCAxMDA6MH0pCiAgICAgICAgICAgIHNlbGYuc2hpZWxkSGl0UG9pbnRzID0gMAogICAgICAgICAgICBzZWxmLnNoaWVsZC5kZWxldGUoKQogICAgICAgICAgICBzZWxmLnNoaWVsZCA9IE5vbmUKICAgICAgICAgICAgc2VsZi5zaGllbGREZWNheVRpbWVyID0gTm9uZQoKICAgICAgICBpZiBzZWxmLnllbGxvd1NoaWVsZCBpcyBOb25lOgogICAgICAgICAgICBzZWxmLnllbGxvd1NoaWVsZCA9IGJzLm5ld05vZGUoJ3NoaWVsZCcsIG93bmVyPXNlbGYubm9kZSwgYXR0cnM9eydjb2xvcic6KG1pbihzZWxmLm5vZGUuY29sb3JbMF0sIDMpLCBtaW4oc2VsZi5ub2RlLmNvbG9yWzFdLCAzKSwgbWluKHNlbGYubm9kZS5jb2xvclsyXSwgMykpLCdyYWRpdXMnOjEuMzV9KQogICAgICAgICAgICBzZWxmLm5vZGUuY29ubmVjdEF0dHIoJ3Bvc2l0aW9uQ2VudGVyJywgc2VsZi55ZWxsb3dTaGllbGQsICdwb3NpdGlvbicpCiAgICAgICAgCiAgICAgICAgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgPSBocAogICAgICAgIHNlbGYueWVsbG93U2hpZWxkSGl0UG9pbnRzTWF4ID0gaHBNYXgKICAgICAgICBzZWxmLnllbGxvd1NoaWVsZERlY2F5UmF0ZSA9IGZhY3Rvcnkuc2hpZWxkRGVjYXlSYXRlIGlmIGRlY2F5IGVsc2UgMAogICAgICAgIHNlbGYueWVsbG93U2hpZWxkLmh1cnQgPSAwCiAgICAgICAgYnMucGxheVNvdW5kKGZhY3Rvcnkuc2hpZWxkVXBTb3VuZCwgMS4wLCBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCgogICAgICAgIGlmIHNlbGYueWVsbG93U2hpZWxkRGVjYXlSYXRlID4gMDoKICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGREZWNheVRpbWVyID0gYnMuVGltZXIoNTAwLCBicy5XZWFrQ2FsbChzZWxmLnllbGxvd1NoaWVsZERlY2F5KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwZWF0PVRydWUpCiAgICAgICAgICAgIHNlbGYueWVsbG93U2hpZWxkLmFsd2F5c1Nob3dIZWFsdGhCYXIgPSBUcnVlCgogICAgZGVmIHllbGxvd1NoaWVsZERlY2F5KHNlbGYpOiAgICAgIAogICAgICAgIGlmIHNlbGYueWVsbG93U2hpZWxkIGlzIG5vdCBOb25lIGFuZCBzZWxmLnllbGxvd1NoaWVsZC5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgPSBcCiAgICAgICAgICAgICAgICBtYXgoMCwgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgLSBzZWxmLnllbGxvd1NoaWVsZERlY2F5UmF0ZSkKICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGQuaHVydCA9IFwKICAgICAgICAgICAgICAgIDEuMCAtIGZsb2F0KHNlbGYueWVsbG93U2hpZWxkSGl0UG9pbnRzKS9zZWxmLnllbGxvd1NoaWVsZEhpdFBvaW50c01heAogICAgICAgICAgICBpZiBzZWxmLnllbGxvd1NoaWVsZEhpdFBvaW50cyA8PSAwOgogICAgICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGQuZGVsZXRlKCkKICAgICAgICAgICAgICAgIHNlbGYueWVsbG93U2hpZWxkID0gTm9uZQogICAgICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGREZWNheVRpbWVyID0gTm9uZQogICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNoaWVsZERvd25Tb3VuZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxLjAsIHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLnllbGxvd1NoaWVsZERlY2F5VGltZXIgPSBOb25lCgogICAgZGVmIF91bnBhcmFsaXplKHNlbGYpOgogICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgIHNlbGYucGFyYWxpemVkX2NvdW50cyA9IGdldGF0dHIoc2VsZiwgInBhcmFsaXplZF9jb3VudHMiLCAxKS0xCiAgICAgICAgaWYgc2VsZi5wYXJhbGl6ZWRfY291bnRzIDwgMToKICAgICAgICAgICAgc2VsZi5ub2RlLnJvbGxlck1hdGVyaWFscywgc2VsZi5ub2RlLnB1bmNoTWF0ZXJpYWxzLCBzZWxmLm5vZGUuZXh0cmFzTWF0ZXJpYWxzID0gc2VsZi5zcGF6TWF0ZXJpYWxzWzBdLCBzZWxmLnNwYXpNYXRlcmlhbHNbMV0sIHNlbGYuc3Bhek1hdGVyaWFsc1syXQogICAgICAgICAgICBzZWxmLm5vZGUuaG9sZFBvc2l0aW9uUHJlc3NlZCwgc2VsZi5ub2RlLmp1bXBQcmVzc2VkID0gRmFsc2UsIEZhbHNlCiAgICAgICAgCiAgICBkZWYgaGFuZGxlTWVzc2FnZShzZWxmLCBtc2cpOgogICAgICAgIHNlbGYuX2hhbmRsZU1lc3NhZ2VTYW5pdHlDaGVjaygpCiAgICAgICAgCiAgICAgICAgaWYgaXNpbnN0YW5jZShtc2csIGJzLlBpY2tlZFVwTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJodXJ0U291bmQiKQogICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgicGlja2VkVXAiKQogICAgICAgICAgICAjIHRoaXMgY291bnRzIGFzIGEgaGl0CiAgICAgICAgICAgIHNlbGYuX251bVRpbWVzSGl0ICs9IDEKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuU2hvdWxkU2hhdHRlck1lc3NhZ2UpOgogICAgICAgICAgICBicy5nYW1lVGltZXIoMSwgYnMuV2Vha0NhbGwoc2VsZi5zaGF0dGVyKSkKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgU2xvd01vdmVNZXNzYWdlKToKICAgICAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgICAgIHNlbGYuc2xvdyA9IFRydWUKICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAiZ2V0UGxheWVyIik6IAogICAgICAgICAgICAgICAgcGxheWVyID0gc2VsZi5nZXRQbGF5ZXIoKQogICAgICAgICAgICAgICAgcGxheWVyLmFzc2lnbklucHV0Q2FsbCgncnVuJywgc2VsZi5vblNsb3dSdW4pCiAgICAgICAgICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCd1cERvd24nLCBzZWxmLm9uU2xvd01vdmUwKQogICAgICAgICAgICAgICAgcGxheWVyLmFzc2lnbklucHV0Q2FsbCgnbGVmdFJpZ2h0Jywgc2VsZi5vblNsb3dNb3ZlMSkKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuSW1wYWN0RGFtYWdlTWVzc2FnZSk6CiAgICAgICAgICAgICMgZXd3OyBzZWVtcyB3ZSBoYXZlIHRvIGRvIHRoaXMgaW4gYSB0aW1lciBvciBpdCB3b250IHdvcmsgcmlnaHQKICAgICAgICAgICAgIyAoc2luY2Ugd2UncmUgZ2V0dGluZyBjYWxsZWQgZnJvbSB3aXRoaW4gdXBkYXRlKCkgcGVyaGFwcz8uLikKICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDEsIGJzLldlYWtDYWxsKHNlbGYuX2hpdFNlbGYsIG1zZy5pbnRlbnNpdHkpKQoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5Qb3dlcnVwTWVzc2FnZSk6CiAgICAgICAgICAgIGlmIHNlbGYuX2RlYWQ6IHJldHVybiBUcnVlCiAgICAgICAgICAgIGlmIHNlbGYucGlja1VwUG93ZXJ1cENhbGxiYWNrIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgc2VsZi5waWNrVXBQb3dlcnVwQ2FsbGJhY2soc2VsZikKCiAgICAgICAgICAgIGlmIChtc2cucG93ZXJ1cFR5cGUgPT0gJ3RyaXBsZUJvbWJzJyk6CiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhCb21iCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY1RyaXBsZSBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgc2VsZi5zZXRCb21iQ291bnQoMykgICAgCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMVRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMVN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDFFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fbXVsdGlCb21iV2Vhck9mZkZsYXNoVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUtMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fbXVsdGlCb21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9tdWx0aUJvbWJXZWFyT2ZmVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX211bHRpQm9tYldlYXJPZmYpKQoKICAgICAgICAgICAgZWxpZiAobXNnLnBvd2VydXBUeXBlID09ICdtdWx0aUJvbWJzJyk6CiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhNdWx0aUJvbWJzCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY011bHRpIEJPTUJTXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBzZWxmLnNldEJvbWJDb3VudCg5OTkpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMVRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMVN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDFFbmRUaW1lID0gdCsoZ1Bvd2VydXBXZWFyT2ZmVGltZSowLjEpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fbXVsdGlCb21iV2Vhck9mZkZsYXNoVGltZXIgPSBicy5UaW1lcihpbnQoZ1Bvd2VydXBXZWFyT2ZmVGltZSowLjEpLTIwMDAsIGJzLldlYWtDYWxsKHNlbGYuX211bHRpQm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fbXVsdGlCb21iV2Vhck9mZlRpbWVyID0gYnMuVGltZXIoaW50KGdQb3dlcnVwV2Vhck9mZlRpbWUqMC4xKSwgYnMuV2Vha0NhbGwoc2VsZi5fbXVsdGlCb21iV2Vhck9mZikpCgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnbGFuZE1pbmVzJzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0TGFuZE1pbmVDb3VudChtaW4oc2VsZi5sYW5kTWluZUNvdW50KzMsIDk5OSkpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwYyBMYW5kTWluZXMgXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAncGFuZG9yYUJveCc6CiAgICAgICAgICAgICAgICBtc2cucG93ZXJ1cFR5cGUgPSByYW5kb20uY2hvaWNlKFsncHVuY2gnLCdoZWFsdGgnLCdjdXJzZScsJ21lZ2FCb21icycsJ3B1bmNoJywnY3Vyc2UnLCd0cEJvbWJzJ10pCiAgICAgICAgICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UobXNnPW1zZykKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjUGFuZG9yYUJveFx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwoKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ2ltcGFjdEJvbWJzJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnaW1wYWN0JwogICAgICAgICAgICAgICAgdGV4ID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNJbXBhY3QgQk9NQlNcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIHNlbGYuX2ZsYXNoQmlsbGJvYXJkKHRleCkKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMkVuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZkZsYXNoVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKCBnUG93ZXJ1cFdlYXJPZmZUaW1lLTIwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdzcGVlZCc6CiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhTcGVlZAogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNCb290c1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgZGVmIHNldFNwZWVkKHZhbCk6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOiBzZXRhdHRyKHNlbGYubm9kZSwnaG9ja2V5Jyx2YWwpCiAgICAgICAgICAgICAgICBzZXRTcGVlZChUcnVlKQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZTogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMkVuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zcGVlZFdlYXJPZmZUaW1lciA9IGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsYnMuQ2FsbChzZXRTcGVlZCxGYWxzZSkpICAgICAgICAKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiQm9vdHMiLGNvbG9yPSgxLDEsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09J2FsYW4nOiAgICAKICAgICAgICAgICAgICAgIGJzLnNjcmVlbk1lc3NhZ2UodSdcdWUwNDhCT1NTIFRJTUVcdWUwNDgnKSAgICAgICAgICAgIAogICAgICAgICAgICAJc2VsZi5lcXVpcFNoaWVsZHMoKQogICAgICAgICAgICAgICAgc2VsZi5lcXVpcEJveGluZ0dsb3ZlcygpCiAgICAgICAgICAgICAgICBic1V0aWxzLmFuaW1hdGVBcnJheShzZWxmLnNoaWVsZCwnY29sb3InLDMsezA6KDAsMCwyKSw1MDA6KDAsMiwwKSwxMDAwOigyLDAsMCksMTUwMDooMiwyLDApLDIwMDA6KDIsMCwyKSwyNTAwOigwLDEsNiksMzAwMDooMSwyLDApfSxUcnVlKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gKDIsMiwyKQogICAgICAgICAgICAgICAgc2VsZi5fcHVuY2hDb29sZG93biA9IDEKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnaWNlJyAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGlnaGxpZ2h0ID0gKDIsMiwyKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhvY2tleSA9IFRydWUgICAgCiAgICAgICAgICAgICAgICBicy5wbGF5U291bmQoYnMuZ2V0U291bmQoJ3VsdHJhSScpLHZvbHVtZSA9IDEwLHBvc2l0aW9uID0gKDAsMTAsMCkpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7ICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3JkbSc6ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gcmFuZG9tLmNob2ljZShbJ2ljZScsJ3N0aWNreScsJ2ltcGFjdCddKQogICAgICAgICAgICAgICAgdGV4ID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKSAjIGlzIGZvciB1c2UgdGhlIHJhbmRvbSBjaG9pY2UsIHRoZSBkaWZlcmVudCBib21iICdpY2VJbXBhY3QnLCdiYWxsb24nLCdpY2UnLCdzdGlja3knLCdpbXBhY3QnCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmKSkgICAgCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNSQU5ET00gQk9NQlNcdWUwMGMiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09J3JhbmRvbUNoYXJhY3Rlcic6IAogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gKDIsMiwyKQogICAgICAgICAgICAgICAgc2VsZi5fcHVuY2hDb29sZG93biA9IDEKICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnZ2xvYmFscycpLnRpbnQgPSAoMC42LDAuNiwwLjkpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB0ZXN0aW5nRXZlbnQgPSAwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXZlbnQgPSByYW5kb20ucmFuZGludCgxLDExKSBpZiB0ZXN0aW5nRXZlbnQgPT0gMCBlbHNlIHRlc3RpbmdFdmVudAogICAgICAgICAgICAgICAgcHJpbnQgJ1BhdHJvbiBBbmQgT29yZTI4MiA8MzogJyArIHN0cihldmVudCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgZXZlbnQgaW4gWzFdOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb2xvclRleHR1cmUgPSBicy5nZXRUZXh0dXJlKCdmcm9zdHlDb2xvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yTWFza1RleHR1cmUgPSBicy5nZXRUZXh0dXJlKCdmcm9zdHlDb2xvck1hc2snKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5SGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtVcHBlckFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvcnNvTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5VG9yc28nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5wZWx2aXNNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5Rm9yZUFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlIYW5kJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJMZWdNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5TG93ZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b2VzTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5VG9lcycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnN0eWxlID0gJ2Zyb3N0eScgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ib21iVHlwZSA9ICdpY2UnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkZyb3N0eSBUaGUgU25vd21hbiIsY29sb3I9KDEsMiwxKSxzY2FsZT0yLjIscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSAyOiAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ3NhbnRhQ29sb3InKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb2xvck1hc2tUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgnc2FudGFDb2xvck1hc2snKSAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnc2FudGFIZWFkJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdzYW50YVVwcGVyQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9yc29Nb2RlbCA9IGJzLmdldE1vZGVsKCdzYW50YVRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnc2FudGFGb3JlQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ3NhbnRhSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnc2FudGFVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnc2FudGFMb3dlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvZXNNb2RlbCA9IGJzLmdldE1vZGVsKCdzYW50YVRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdzYW50YScKICAgICAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ2ljZScKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiU0FOVEEiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCgogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSAzOiAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2JvbmVzQ29sb3InKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb2xvck1hc2tUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgnYm9uZXNDb2xvck1hc2snKSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGVhZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbmVzSGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnYm9uZXNVcHBlckFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvcnNvTW9kZWwgPSBicy5nZXRNb2RlbCgnYm9uZXNUb3JzbycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBlbHZpc01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbmVzUGVsdmlzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZm9yZUFybU1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbmVzRm9yZUFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IGJzLmdldE1vZGVsKCdib25lc0hhbmQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS51cHBlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbmVzVXBwZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5sb3dlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JvbmVzTG93ZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b2VzTW9kZWwgPSBicy5nZXRNb2RlbCgnYm9uZXNUb2VzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuc3R5bGUgPSAnYm9uZXMnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIlNwb29reSBTcG9va3kgU2tlbGV0b24iLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDQ6ICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ21lbENvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ21lbENvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnbWVsSGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnbWVsVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ21lbFRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnbWVsRm9yZUFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IGJzLmdldE1vZGVsKCdtZWxIYW5kJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJMZWdNb2RlbCA9IGJzLmdldE1vZGVsKCdtZWxVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnbWVsTG93ZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b2VzTW9kZWwgPSBicy5nZXRNb2RlbCgnbWVsVG9lcycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnN0eWxlID0gJ21lbCcKICAgICAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ3N0aWNreScKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiTWVsIHRoZSBDaGVmIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA1OiAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgnbmluamFDb2xvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yTWFza1RleHR1cmUgPSBicy5nZXRUZXh0dXJlKCduaW5qYUNvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnbmluamFIZWFkJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCduaW5qYVVwcGVyQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9yc29Nb2RlbCA9IGJzLmdldE1vZGVsKCduaW5qYVRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgnbmluamFQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnbmluamFGb3JlQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ25pbmphSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnbmluamFVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnbmluamFMb3dlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvZXNNb2RlbCA9IGJzLmdldE1vZGVsKCduaW5qYVRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICduaW5qYScKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiU3RlYWx0aCBCb2kiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCgogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA2OiAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2FsaUNvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2FsaUNvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnYWxpSGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnYWxpVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ2FsaVRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgnYWxpUGVsdmlzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZm9yZUFybU1vZGVsID0gYnMuZ2V0TW9kZWwoJ2FsaUZvcmVBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kTW9kZWwgPSBicy5nZXRNb2RlbCgnYWxpSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnYWxpVXBwZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5sb3dlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ2FsaUxvd2VyTGVnJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gYnMuZ2V0TW9kZWwoJ2FsaVRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdhbGknCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkFsaSIsY29sb3I9KDEsMiwxKSxzY2FsZT0yLjIscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDc6ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgnYmVhckNvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2JlYXJDb2xvck1hc2snKSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGVhZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ2JlYXJIZWFkJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdiZWFyVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JlYXJUb3JzbycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBlbHZpc01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JlYXJQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnYmVhckZvcmVBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kTW9kZWwgPSBicy5nZXRNb2RlbCgnYmVhckhhbmQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS51cHBlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JlYXJVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnYmVhckxvd2VyTGVnJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gYnMuZ2V0TW9kZWwoJ2JlYXJUb2VzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuc3R5bGUgPSAnYmVhcicKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiSGF2ZSBhIEJlYXJ5IGd1ZCBkYXkiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDg6ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgncGVuZ3VpbkNvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ3Blbmd1aW5Db2xvck1hc2snKSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGVhZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ3Blbmd1aW5IZWFkJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdwZW5ndWluVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ3Blbmd1aW5Ub3JzbycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBlbHZpc01vZGVsID0gYnMuZ2V0TW9kZWwoJ3Blbmd1aW5QZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgncGVuZ3VpbkZvcmVBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kTW9kZWwgPSBicy5nZXRNb2RlbCgncGVuZ3VpbkhhbmQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS51cHBlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ3Blbmd1aW5VcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgncGVuZ3Vpbkxvd2VyTGVnJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gYnMuZ2V0TW9kZWwoJ3Blbmd1aW5Ub2VzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuc3R5bGUgPSAncGVuZ3VpbicKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiRGlzdGFudCBjb3VzaW4gb2YgRnJvc3R5Iixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA5OiAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ3dpemFyZENvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ3dpemFyZENvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnd2l6YXJkSGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnd2l6YXJkVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ3dpemFyZFRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgnd2l6YXJkUGVsdmlzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZm9yZUFybU1vZGVsID0gYnMuZ2V0TW9kZWwoJ3dpemFyZEZvcmVBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kTW9kZWwgPSBicy5nZXRNb2RlbCgnd2l6YXJkSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnd2l6YXJkVXBwZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5sb3dlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ3dpemFyZExvd2VyTGVnJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gYnMuZ2V0TW9kZWwoJ3dpemFyZFRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICd3aXphcmQnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkVWSUwgU0NFUFRFUiBXSVpBUkQgTUFOIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQoKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gMTA6ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JUZXh0dXJlID0gYnMuZ2V0VGV4dHVyZSgncGl4aWVDb2xvcicpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yTWFza1RleHR1cmUgPSBicy5nZXRUZXh0dXJlKCdwaXhpZUNvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgncGl4aWVIZWFkJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdwaXhpZVVwcGVyQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9yc29Nb2RlbCA9IGJzLmdldE1vZGVsKCdwaXhpZVRvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgncGl4aWVQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgncGl4aWVGb3JlQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ3BpeGllSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgncGl4aWVVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgncGl4aWVMb3dlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvZXNNb2RlbCA9IGJzLmdldE1vZGVsKCdwaXhpZVRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdwaXhpZScKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiUElYSUVMLUFURUQiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDExOiAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2N5Ym9yZ0NvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2N5Ym9yZ0NvbG9yTWFzaycpICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnY3lib3JnSGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnY3lib3JnVXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ2N5Ym9yZ1RvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgnY3lib3JnUGVsdmlzJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZm9yZUFybU1vZGVsID0gYnMuZ2V0TW9kZWwoJ2N5Ym9yZ0ZvcmVBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kTW9kZWwgPSBicy5nZXRNb2RlbCgnY3lib3JnSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnY3lib3JnVXBwZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5sb3dlckxlZ01vZGVsID0gYnMuZ2V0TW9kZWwoJ2N5Ym9yZ0xvd2VyTGVnJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9lc01vZGVsID0gYnMuZ2V0TW9kZWwoJ2N5Ym9yZ1RvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdjeWJvcmcnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIlRoZSBSb2JvIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKSAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSdoaWdobGlnaHQnOiAgIAogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gKCgwK3JhbmRvbS5yYW5kb20oKSo2LjUpLCgwK3JhbmRvbS5yYW5kb20oKSo2LjUpLCgwK3JhbmRvbS5yYW5kb20oKSo2LjUpKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhpZ2hsaWdodCA9ICgoMCtyYW5kb20ucmFuZG9tKCkqNi41KSwoMCtyYW5kb20ucmFuZG9tKCkqNi41KSwoMCtyYW5kb20ucmFuZG9tKCkqNi41KSkgICAKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJUaGUgSGlnaGxpZ2h0Iixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKSAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0nc3BvdGxpZ2h0JzogICAKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb2xvciA9IHJhbmRvbS5jaG9pY2UoWygtMTAsMjMsMTgpLCgzMiwtMjQsMTApLCgtMjEsMTAsMjkpLCg1LC0xNSwyNSksKDE3LC0yNywyNiksKC0xNCwtMjQsMjQpXSkgIAogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhpZ2hsaWdodCA9IHJhbmRvbS5jaG9pY2UoWygxMCwyMywxOCksKDMyLDI0LDEwKSwoMjEsMTAsMjkpLCg1LDE1LDI1KSwoMTcsMjcsMjYpLCgxNCwtMjQsMjQpXSkgIAogICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykudGludCA9ICgtMSwtMSwtMSkgIAogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIlRoZSBTUE9UIExJR0hUIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKSAgCgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSdwb3dlcnVwJzogICAgCiAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHRlc3RpbmdFdmVudCA9IDAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBldmVudCA9IHJhbmRvbS5yYW5kaW50KDEsNSkgaWYgdGVzdGluZ0V2ZW50ID09IDAgZWxzZSB0ZXN0aW5nRXZlbnQKICAgICAgICAgICAgICAgIHByaW50ICdQQ05hbWU6ICcgKyBzdHIoZXZlbnQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGV2ZW50IGluIFsxXToKICAgICAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lLiBUaGUgZWZmZWN0OiBQb3dlcnVwcycKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwTWVzc2FnZShwb3dlcnVwVHlwZSA9ICdqdW1wRmx5JykpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDI6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGUgPSAnaWNlSW1wYWN0JykpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDM6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnICAgICAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwTWVzc2FnZShwb3dlcnVwVHlwZSA9ICd0Ym9tYicpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA0OgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQQ05hbWUuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJyAgICAgICAgICAgICAgICAJCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGUgPSAnY3Vyc2UnKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gNToKICAgICAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lLiBUaGUgZWZmZWN0OiBQb3dlcnVwcycgICAgICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlID0gJ3NsZWVwJykpICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0nbmFtZSc6ICAgIAogICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB0ZXN0aW5nRXZlbnQgPSAwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXZlbnQgPSByYW5kb20ucmFuZGludCgxLDEpIGlmIHRlc3RpbmdFdmVudCA9PSAwIGVsc2UgdGVzdGluZ0V2ZW50CiAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lOiAnICsgc3RyKGV2ZW50KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBldmVudCBpbiBbMV06CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm5hbWUgPSAnUFJPJwogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJCZSBQUk8iLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhpZ2hsaWdodCA9ICgtOCwtMiwgNCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gMjoKICAgICAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lLiBUaGUgZWZmZWN0OiBQb3dlcnVwcycKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubmFtZSA9ICdCZSBHQVknCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhpZ2hsaWdodCA9ICgtOCwtMiwgNCkKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiQkUgR0FZIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSAzOgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQQ05hbWUuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJyAgICAgICAgICAgICAgICAJCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm5hbWUgPSAnTk9PQicKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGlnaGxpZ2h0ID0gKC04LC0yLCA0KQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJHRVQgV1JFQ0tFRCBQQUwiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDQ6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnICAgICAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubmFtZSA9ICdCT1NTJwogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oaWdobGlnaHQgPSAoLTgsLTIsIDQpCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkJlIEJPU1MiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnICAgICAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubmFtZSA9ICdQQzIzMTM5MicKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGlnaGxpZ2h0ID0gKC04LC0yLCA0KQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJ1c2Ugb3duZXIgSUQiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09J2dyYXZpdHknOiAgICAKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0ZXN0aW5nRXZlbnQgPSAwCgogICAgICAgICAgICAgICAgZXZlbnQgPSByYW5kb20ucmFuZGludCg2LDYpIGlmIHRlc3RpbmdFdmVudCA9PSAwIGVsc2UgdGVzdGluZ0V2ZW50CiAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lOiAnICsgc3RyKGV2ZW50KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBldmVudCBpbiBbMV06CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuRnJlZXplTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlPSdjdXJzZScpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSAyOgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQQ05hbWUuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJwogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlPSdoZWFsdGgnKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gMzoKICAgICAgICAgICAgICAgICAgICBwcmludCAnUENOYW1lLiBUaGUgZWZmZWN0OiBQb3dlcnVwcycgICAgICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICAgICAgYnMuQm9tYigocFswXSswLjQzLHBbMV0rNCxwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdzdGlja3lJY2UnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLTAuNDMscFsxXSsyLHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3N0aWNreUljZScpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnc3RpY2t5SWNlJykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuQm9tYigocFswXSswLjQzLHBbMV0rNCxwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdzdGlja3lJY2UnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLTAuNDMscFsxXSsyLHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3N0aWNreUljZScpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnc3RpY2t5SWNlJykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDQ6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BDTmFtZS4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnICAgICAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgICAgICBwID0gc2VsZi5ub2RlLnBvc2l0aW9uRm9yd2FyZAogICAgICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0rMC40MyxwWzFdKzQscFsyXS0wLjI1KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLHBbMV0rNCxwWzJdKzAuNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0rMC40MyxwWzFdKzQscFsyXS0wLjI1KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLHBbMV0rNCxwWzJdKzAuNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0rMC40MyxwWzFdKzQscFsyXS0wLjI1KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLHBbMV0rNCxwWzJdKzAuNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA1OgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQQ05hbWUuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJyAgICAgICAgICAgICAgICAJCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImtub2Nrb3V0IiwxMDAwMCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gNjoKICAgICAgICAgICAgICAgICAgICBwcmludCAnJwogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKGJzLlNsb3dNb3ZlTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnQm94JzoKICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdKzAuNDMscFsxXSs0LHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdKzAuNDMscFsxXSs0LHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdKzAuNDMscFsxXSs0LHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09J3Ryb2xsJzogICAgCiAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHRlc3RpbmdFdmVudCA9IDAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBldmVudCA9IHJhbmRvbS5yYW5kaW50KDEsMTApIGlmIHRlc3RpbmdFdmVudCA9PSAwIGVsc2UgdGVzdGluZ0V2ZW50CiAgICAgICAgICAgICAgICBwcmludCAnUGF0cm9uIEFuZCBPb3JlMjgyIDwzOiAnICsgc3RyKGV2ZW50KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBldmVudCBpbiBbMV06CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BhdHJvbiBBbmQgT29yZTI4MiA8My4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkNFTEVCUkFURSA6RCIsY29sb3I9KDEsMSwwKSxzY2FsZT0xLjYscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBicy5hbmltYXRlQXJyYXkoc2VsZi5ub2RlLCdjb2xvcicsMyx7MDooMCwwLDIpLDUwMDooMCwyLDApLDEwMDA6KDIsMCwwKSwxNTAwOigyLDIsMCksMjAwMDooMiwwLDIpLDI1MDA6KDAsMSw2KSwzMDAwOigxLDIsMCl9LFRydWUpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoJ2NlbGVicmF0ZScsNTAwMCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGlnaGxpZ2h0ID0gKDAsMCwwKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSAyOgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQYXRyb24gQW5kIE9vcmUyODIgPDMuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJwogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKGJzLlBvd2VydXBNZXNzYWdlKHBvd2VydXBUeXBlPSdzaGllbGQnKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwTWVzc2FnZShwb3dlcnVwVHlwZT0ncHVuY2gnKSkKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiVGhlIEJvc3MgQ29tYm8iLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDM6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQgJ1BhdHJvbiBBbmQgT29yZTI4MiA8My4gVGhlIGVmZmVjdDogUG93ZXJ1cHMnICAgICAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZShicy5GcmVlemVNZXNzYWdlKCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGU9J2N1cnNlJykpCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIkdFVCBXUkVDS0VEIFBBTCIsY29sb3I9KDEsMiwxKSxzY2FsZT0yLjIscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gNDoKICAgICAgICAgICAgICAgICAgICBwcmludCAnUGF0cm9uIEFuZCBPb3JlMjgyIDwzLiBUaGUgZWZmZWN0OiBQb3dlcnVwcycgICAgICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdwaXhpZScKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiQ0hBUkFDVEVSIFBJWElFIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA1OgogICAgICAgICAgICAgICAgICAgIHByaW50ICdQYXRyb24gQW5kIE9vcmUyODIgPDMuIFRoZSBlZmZlY3Q6IFBvd2VydXBzJyAgICAgICAgICAgICAgICAJCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuUG93ZXJ1cE1lc3NhZ2UocG93ZXJ1cFR5cGU9KFsnY3Vyc2UnLCdoZWFsdGgnLCdzaGllbGQnLCdwdW5jaCcsJ3Ryb2xsJywnc3BlZWQnLCdyYW5kb21DaGFyYWN0ZXInXSkpKQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJSYW5kb20gUG93ZXJ1cCBCZXdhcmUiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gNjogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYuX3B1bmNoUG93ZXJTY2FsZSA9IDMKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiUmFuZG9tIENoYXJhY3RlciIsY29sb3I9KDEsMiwxKSxzY2FsZT0yLjIscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdrcm9ua1VwcGVyQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudG9yc29Nb2RlbCA9IGJzLmdldE1vZGVsKCdrcm9ua1RvcnNvJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGVsdmlzTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtGb3JlQXJtJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ2tyb25rSGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtMb3dlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvZXNNb2RlbCA9IGJzLmdldE1vZGVsKCdrcm9ua1RvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdrcm9uaycKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVsaWYgZXZlbnQgPT0gNzogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0TGFuZE1pbmVDb3VudCgoc2VsZi5sYW5kTWluZUNvdW50KzEwKSkKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiTEFORE1JTkVTIixjb2xvcj0oMSwyLDEpLHNjYWxlPTIuMixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZWxpZiBldmVudCA9PSA4OiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiV2VhayBQVU5DSCIsY29sb3I9KDEsMSwwKSxzY2FsZT0xLjYscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYuX3B1bmNoUG93ZXJTY2FsZSA9IDAuNQogICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDk6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIlNUT05HIFBVTkNIIixjb2xvcj0oMSwxLDApLHNjYWxlPTEuNixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKSAgICAKICAgICAgICAgICAgICAgICAgICBzZWxmLl9wdW5jaFBvd2VyU2NhbGUgPSAxMCAgICAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICBlbGlmIGV2ZW50ID09IDEwOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5kZWZhdWx0Q29sb3IgPSAoMC41LDAuNSwxKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsMC41LDApCgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oZWFkTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5SGVhZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgna3JvbmtVcHBlckFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvcnNvTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5VG9yc28nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5wZWx2aXNNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlQZWx2aXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5Rm9yZUFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlIYW5kJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUudXBwZXJMZWdNb2RlbCA9IGJzLmdldE1vZGVsKCdmcm9zdHlVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5TG93ZXJMZWcnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b2VzTW9kZWwgPSBicy5nZXRNb2RlbCgnZnJvc3R5VG9lcycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnN0eWxlID0gJ2Zyb3N0eScgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSdtaic6IAogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yID0gKDIsMiwyKQogICAgICAgICAgICAgICAgc2VsZi5fcHVuY2hDb29sZG93biA9IDEKICAgICAgICAgICAgICAgIGJzLmdldFNoYXJlZE9iamVjdCgnZ2xvYmFscycpLnRpbnQgPSAoMC42LDAuNiwwLjkpCiAgICAgICAgICAgICAgICBsaWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsncG9zaXRpb24nOnNlbGYubm9kZS5wb3NpdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzowLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodEF0dGVudWF0ZWQnOkZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb2xvcic6ICgwLDEsNil9KQogICAgICAgICAgICAgICAgYnMuYW5pbWF0ZShsaWdodCwncmFkaXVzJyx7MDozLjAsMzAwOjUsNjAwOjB9KSAgICAgCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB0ZXN0aW5nRXZlbnQgPSAwCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXZlbnQgPSByYW5kb20ucmFuZGludCgxLDEpIGlmIHRlc3RpbmdFdmVudCA9PSAwIGVsc2UgdGVzdGluZ0V2ZW50CiAgICAgICAgICAgICAgICBwcmludCAnUGF0cm9uIEFuZCBPb3JlMjgyIDwzOiAnICsgc3RyKGV2ZW50KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBldmVudCBpbiBbMV06CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvbG9yVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2Zyb3N0eUNvbG9yJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY29sb3JNYXNrVGV4dHVyZSA9IGJzLmdldFRleHR1cmUoJ2FnZW50Q29sb3JNYXNrJykKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGVhZE1vZGVsID0gYnMuZ2V0TW9kZWwoJ2Zyb3N0eUhlYWQnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS51cHBlckFybU1vZGVsID0gYnMuZ2V0TW9kZWwoJ2FnZW50VXBwZXJBcm0nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS50b3Jzb01vZGVsID0gYnMuZ2V0TW9kZWwoJ2FnZW50VG9yc28nKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5wZWx2aXNNb2RlbCA9IGJzLmdldE1vZGVsKCdhZ2VudFBlbHZpcycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmZvcmVBcm1Nb2RlbCA9IGJzLmdldE1vZGVsKCdiZWFyRm9yZUFybScpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IGJzLmdldE1vZGVsKCdiZWFySGFuZCcpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnVwcGVyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnYWdlbnRVcHBlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBicy5nZXRNb2RlbCgnYWdlbnRMb3dlckxlZycpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnRvZXNNb2RlbCA9IGJzLmdldE1vZGVsKCdhZ2VudFRvZXMnKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5zdHlsZSA9ICdhZ2VudCcgICAgICAgCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ib21iVHlwZSA9ICdpY2UnCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIk1yLkdlbnRpbGVtYW4sIGJyb3RoZXIgb2YgQWdlbnQiLGNvbG9yPSgxLDIsMSksc2NhbGU9Mi4yLHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdNb3Rpb24nOgogICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykuc2xvd01vdGlvbiA9IGJzLmdldFNoYXJlZE9iamVjdCgnZ2xvYmFscycpLnNsb3dNb3Rpb24gPT0gRmFsc2UKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBlU0xPLU1PIVx1ZTAwZSIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykudGludCA9ICgwLjYsMC42LDAuOSkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0naWNlJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ2ludmlzaWJpbGl0eSc6CiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhJbnZpc2liaWxpdHkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDQ1WU9VIENBTlQgU0VFIE1FXHVlMDQ1Iixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ2dsb2JhbHMnKS50aW50ID0gKDAuNiwwLjYsMC45KQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdpY2UnKTsKICAgICAgICAgICAgICAgIHNlbGYuX2ZsYXNoQmlsbGJvYXJkKHRleCkKICAgICAgICAgICAgICAgIHNlbGYuc2V0SW52aXNpYmlsaXR5KCkKICAgICAgICAgICAgICAgIHNlbGYuX2lzSW52aXNpYmxlID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2ludmlzaWJpbGl0eVdlYXJPZmZGbGFzaFRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLGJzLldlYWtDYWxsKHNlbGYuX2ludmlzaWJpbGl0eVdlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW52aXNpYmlsaXR5V2Vhck9mZlRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSxicy5XZWFrQ2FsbChzZWxmLl9pbnZpc2liaWxpdHlXZWFyT2ZmKSkgCgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnanVtcEZseSc6CiAgICAgICAgICAgIAlwbGF5ZXIgPSBzZWxmLmdldFBsYXllcigpCiAgICAgICAgICAgIAlwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdqdW1wUHJlc3MnLCBzZWxmLm9uSnVtcGZseSkKICAgICAgICAgICAgICAgIHRleCA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleGp1bXBGbHkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDAzRmx5IGFuZCBKVU1QIEhpZ2hcdWUwMDMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0naWNlJyk7CiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1RleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1N0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fanVtcEZseVdlYXJPZmZGbGFzaFRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0xMDAwLGJzLldlYWtDYWxsKHNlbGYuX2p1bXBGbHlXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2p1bXBGbHlXZWFyT2ZmVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLGJzLldlYWtDYWxsKHNlbGYuX2p1bXBGbHlXZWFyT2ZmKSkgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnaGlqdW1wJzoKICAgICAgICAgICAgCXBsYXllciA9IHNlbGYuZ2V0UGxheWVyKCkKICAgICAgICAgICAgCXBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2p1bXBQcmVzcycsIHNlbGYub25IaUp1bXBDaGFyZ2UpCiAgICAgICAgICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdqdW1wUmVsZWFzZScsIHNlbGYub25IaUp1bXApCiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhIaUp1bXAKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDAzSG9sZCBKVU1QIGZvciBhIHdoaWxlXG5BbmQgUmVsZWFzZSFcdWUwMDMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0naWNlJyk7CiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1RleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1N0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5faGlqdW1wV2Vhck9mZkZsYXNoVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLTEwMDAsYnMuV2Vha0NhbGwoc2VsZi5faGlqdW1wV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9oaWp1bXBXZWFyT2ZmVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLGJzLldlYWtDYWxsKHNlbGYuX2hpanVtcFdlYXJPZmYpKSAgICAgICAKCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdiYWxsb24nOgogICAgICAgICAgICAgICAgc2VsZi5ib21iVHlwZSA9ICdiYWxsb24nCiAgICAgICAgICAgICAgICB0ZXggPSBicy5nZXRUZXh0dXJlKCduZXh0TGV2ZWxJY29uJykKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDAzUFJFU1MgQk9NQlx1ZTAwMyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnQmxvY2tQb3dlcnVwJzoKICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICBicy5Cb21iKHBvc2l0aW9uPShwWzBdLCBwWzFdICsgMi4wLCBwWzJdKSwKICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9KDAsNSwwKSxib21iVHlwZT0nQmxvY2snKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjRXhwbG9kZSBNZVx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOyAgICAKICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnZ29sZGVuQm9tYic6CiAgICAgICAgICAgICAgICBwID0gc2VsZi5ub2RlLnBvc2l0aW9uRm9yd2FyZAogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXSxwWzFdKzIscFsyXSksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLAogICAgICAgICAgICAgICAgICAgICAgICBib21iVHlwZSA9ICdnb2xkZW5Cb21iJykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY011bGl0cGxlIGJvbWJzIENvbWluZ1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOyAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnY2VsZWJyYXRlJzoKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KCJDRUxFQlJBVEUgOkQiLGNvbG9yPSgxLDEsMCksc2NhbGU9MS42LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5nZXRTaGFyZWRPYmplY3QoJ2dsb2JhbHMnKS50aW50ID0gKDAuNiwwLjYsMC45KQogICAgICAgICAgICAgICAgbGlnaHQgPSBicy5uZXdOb2RlKCdsaWdodCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3Bvc2l0aW9uJzpzZWxmLm5vZGUucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoZWlnaHRBdHRlbnVhdGVkJzpGYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sb3InOiAoMCwxLDYpfSkKICAgICAgICAgICAgICAgIGJzLmFuaW1hdGUobGlnaHQsJ3JhZGl1cycsezA6My4wLDMwMDo1LDYwMDowfSkgIAogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgYnMuYW5pbWF0ZUFycmF5KHNlbGYubm9kZSwnY29sb3InLDMsezA6KDAsMCwyKSw1MDA6KDAsMiwwKSwxMDAwOigyLDAsMCksMTUwMDooMiwyLDApLDIwMDA6KDIsMCwyKSwyNTAwOigwLDEsNiksMzAwMDooMSwyLDApfSxUcnVlKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoJ2NlbGVicmF0ZScsNTAwMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnRmxvYXRpbmdNaW5lJzoKICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICBic1NvbWV0aGluZy5GbG9hdGluZ0xhbmRNaW5lKChwWzBdLHBbMV0rMixwWzJdKSkuYXV0b1JldGFpbigpICAgCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0dHXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7ICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnaWNlSW1wYWN0JzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0aWNlSW1wYWN0Q291bnQobWluKHNlbGYuaWNlSW1wYWN0Q291bnQrMywgMykpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0ljZUltcGFjdCBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3Rib21iJzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0dGJvbWJDb3VudChtaW4oc2VsZi50Ym9tYkNvdW50KzIsIDIpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQoIlRlbGVQb3J0LUJvbWIhIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpICAgCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7ICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnd2VlZGJvbWInOgogICAgICAgICAgICAgICAgc2VsZi5zZXR3ZWVkYm9tYkNvdW50KG1pbihzZWxmLndlZWRib21iQ291bnQrMSwgMSkpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCgiV2VlZC1Cb3giLGNvbG9yPSgxLDAuNSwwLjMpLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdnbHVlYm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldGdsdWVib21iQ291bnQobWluKHNlbGYuZ2x1ZWJvbWJDb3VudCsxLCAxKSkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjR0xVRSBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOyAgICAgIAoKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ2JvdCc6CiAgICAgICAgICAgICAgICBwID0gc2VsZi5ub2RlLnBvc2l0aW9uCiAgICAgICAgICAgICAgICBwb3MgPSAocFswXSwgcFsxXSArIDIsIHBbMl0pCiAgICAgICAgICAgICAgICBib3RNb2QuQm90KHBvcyA9IHBvcywgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIpLmF1dG9SZXRhaW4oKSAKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDQ1Qm90IE1PRCAyLjBcdWUwNDUiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsgICAgICAgICAgICAKCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdyYWRpdXMnOgogICAgICAgICAgICAgICAgdGV4ID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4UmFkaXVzCiAgICAgICAgICAgIAlzZWxmLmJsYXN0UmFkaXVzID0gNS41CiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0luY3JlYXNlZCBCbGFzdCBSYWRpdXNcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIHQgPSBicy5zY3JlZW5NZXNzYWdlKCIhQmxhc3RzIEJpZ2dlciEiLCBjb2xvcj0oMCwgMC41LCAwLjgpKQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX3JhZGl1c1dlYXJPZmZGbGFzaFRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0xMDAwLGJzLldlYWtDYWxsKHNlbGYuX3JhZGl1c1dlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcmFkaXVzV2Vhck9mZlRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSxicy5XZWFrQ2FsbChzZWxmLl9yYWRpdXNXZWFyT2ZmKSkgIAoKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3NsZWVwJzoKICAgICAgICAgICAgCXRleCA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleFNsZWVwCiAgICAgICAgICAgIAlzZWxmLmZyb3plbiA9IFRydWUKICAgICAgICAgICAgICAgIHQgPSBicy5zY3JlZW5NZXNzYWdlKCIhU2xlZXAgTW9kZSBPbiEiLCBjb2xvcj0oMCwgMC41LCAwLjgpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNJbSBVc2VsZXNzISFcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM0VuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zbGVlcHBvd2VyV2Vhck9mZkZsYXNoVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLTEwMDAsYnMuV2Vha0NhbGwoc2VsZi5fc2xlZXBXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NsZWVwV2Vhck9mZlRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSxicy5XZWFrQ2FsbChzZWxmLl9zbGVlcFdlYXJPZmYpKSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICduaWdodCc6CiAgICAgICAgICAgICAgICB0ZXggPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhOaWdodAogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgdGltZSA9IGJzLmdldFNoYXJlZE9iamVjdCgnZ2xvYmFscycpLnRpbnQKICAgICAgICAgICAgICAgIGlmIHRpbWUgPT0gVHJ1ZTogYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykudGludCA9IEZhbHNlCiAgICAgICAgICAgICAgICBlbHNlOiBicy5nZXRTaGFyZWRPYmplY3QoJ2dsb2JhbHMnKS50aW50ID0gKDAuMiwwLjMsMC40KQogICAgICAgICAgICAgICAgdCA9IGJzLnNjcmVlbk1lc3NhZ2UoIiFOaWdodCEiLCBjb2xvcj0oMCwgMC41LCAwLjgpKQogICAgICAgICAgICAgICAgdCA9IGJzLnBsYXlTb3VuZChicy5nZXRTb3VuZCgnbmlnaHQnKSkKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM0VuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9uaWdodFdlYXJPZmZGbGFzaFRpbWVyID0gYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0xMDAwLGJzLldlYWtDYWxsKHNlbGYuX25pZ2h0V2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9uaWdodFdlYXJPZmZUaW1lciA9IGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsYnMuV2Vha0NhbGwoc2VsZi5fbmlnaHRXZWFyT2ZmKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3NwYXpCb21iJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnc3BhekJvbWInCiAgICAgICAgICAgICAgICBzZWxmLmJvbWJDb3VudCA9ICgzKQogICAgICAgICAgICAgICAgdGV4ID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKSAgCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY1doYXQgaGFwcGVuZWQgdG8gaGlzIEhlYWRcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0ID0gYnMuc2NyZWVuTWVzc2FnZSgiIVNwYXpCb21iISIsIGNvbG9yPSgxLDEsMSkpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1RleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1N0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3BhekJvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUtMzAwMCxicy5XZWFrQ2FsbChzZWxmLl9zcGF6Qm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fc3BhekJvbWJXZWFyT2ZmVGltZXIgPSBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLGJzLldlYWtDYWxsKHNlbGYuX3NwYXpCb21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdoZWFsQm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldGhlYWxCb21iQ291bnQobWluKHNlbGYuaGVhbEJvbWJDb3VudCsyLCAxKSkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjSGVhbGxsdGggUG90aW9uXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnY3Vyc2VCb21iJzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0Y3Vyc2VCb21iQ291bnQobWluKHNlbGYuY3Vyc2VCb21iQ291bnQrMywgMykpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0hlaGUgQm9pXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldGNoYXJhY3RlckJvbWJDb3VudChtaW4oc2VsZi5jaGFyYWN0ZXJCb21iQ291bnQrMSwgMSkpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY1doaWNoIENoYXIgYXJlIFVcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgKG1zZy5wb3dlcnVwVHlwZSA9PSAndHJpb0JvbWInKToKICAgICAgICAgICAgICAgIHNlbGYuc2V0dHJpb0JvbWJDb3VudChtaW4oc2VsZi50cmlvQm9tYkNvdW50KzMsIDMpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNJbXBhY3QgU2hvd2VyXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ21qQm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldG1qQm9tYkNvdW50KG1pbihzZWxmLm1qQm9tYkNvdW50KzEsIDEpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNUaGUgR2VudGlsZW1hblx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdpY3lUcmlvJzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0aWN5VHJpb0NvdW50KG1pbihzZWxmLmljeVRyaW9Db3VudCsxLCAxKSkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjSUNZIFNIT1dFUlx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdib29tQm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldGJvb21Cb21iQ291bnQobWluKHNlbGYuYm9vbUJvbWJDb3VudCs1LCA1KSkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjS2FhYm9vb29tXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3NwZWVkQm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLnNldHNwZWVkQm9tYkNvdW50KG1pbihzZWxmLnNwZWVkQm9tYkNvdW50KzEsIDEpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNCb21icyBmb3IgQm9vdHNcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdrbm9ja0JvbWInOgogICAgICAgICAgICAgICAgc2VsZi5zZXRrbm9ja0JvbWJDb3VudChtaW4oc2VsZi5rbm9ja0JvbWJDb3VudCsxMCwgMTApKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNTbGVlcHkgU2xlZXB5XHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3N0aWNreUljZSc6CiAgICAgICAgICAgICAgICBzZWxmLnNldHN0aWNreUljZUNvdW50KG1pbihzZWxmLnN0aWNreUljZUNvdW50KzMsIDMpKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNJY2UgYnV0IFN0aWNreVx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdzdGlja3lJY2VUcmlvJzoKICAgICAgICAgICAgICAgIHNlbGYuc2V0c3RpY2t5SWNlVHJpb0NvdW50KG1pbihzZWxmLnN0aWNreUljZVRyaW9Db3VudCszLCAzKSkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjSWNlIGJ1dCBTdGlja3lcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnaW1wYWN0TWVzcyc6CiAgICAgICAgICAgICAgICBwID0gc2VsZi5ub2RlLnBvc2l0aW9uRm9yd2FyZAogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXSswLjQzLHBbMV0rNCxwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdpbXBhY3QnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0tMC40MyxwWzFdKzIscFsyXS0wLjI1KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnaW1wYWN0JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLHBbMV0rNCxwWzJdKzAuNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ2ltcGFjdCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdzdGlja3lNZXNzJzoKICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdKzAuNDMscFsxXSs0LHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3N0aWNreScpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdzdGlja3knKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnc3RpY2t5JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3N0aWNreUljZU1lc3MnOgogICAgICAgICAgICAgICAgcCA9IHNlbGYubm9kZS5wb3NpdGlvbkZvcndhcmQKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0rMC40MyxwWzFdKzQscFsyXS0wLjI1KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnc3RpY2t5SWNlJykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdLTAuNDMscFsxXSsyLHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3N0aWNreUljZScpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXSxwWzFdKzQscFsyXSswLjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdzdGlja3lJY2UnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAndG50JzoKICAgICAgICAgICAgICAgIHAgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICBicy5Cb21iKChwWzBdKzAuNDMscFsxXSs0LHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ3RudCcpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuQm9tYigocFswXS0wLjQzLHBbMV0rMixwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICd0bnQnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAndG50JykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ2ljeU1lc3MnOgogICAgICAgICAgICAgICAgZGVmIF9ib29tKCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoYnMuRGllTWVzc2FnZSgpKQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDAzSGVhbGVkIFVwISFcdWUwMDMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxNTAwLGJzLkNhbGwoX2Jvb20pKQogICAgICAgICAgICAgICAgI3AgPSBzZWxmLm5vZGUucG9zaXRpb25Gb3J3YXJkCiAgICAgICAgICAgICAgICAjYnMuQm9tYigocFswXSswLjQzLHBbMV0rNCxwWzJdLTAuMjUpLHZlbG9jaXR5PSgwLC02LDApLCBzb3VyY2VQbGF5ZXIgPSBzZWxmLnNvdXJjZVBsYXllcixib21iVHlwZSA9ICdpY2UnKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgICNicy5Cb21iKChwWzBdLTAuNDMscFsxXSsyLHBbMl0tMC4yNSksdmVsb2NpdHk9KDAsLTYsMCksIHNvdXJjZVBsYXllciA9IHNlbGYuc291cmNlUGxheWVyLGJvbWJUeXBlID0gJ2ljZScpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgI2JzLkJvbWIoKHBbMF0scFsxXSs0LHBbMl0rMC41KSx2ZWxvY2l0eT0oMCwtNiwwKSwgc291cmNlUGxheWVyID0gc2VsZi5zb3VyY2VQbGF5ZXIsYm9tYlR5cGUgPSAnaWNlJykuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3VzZSc6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ3VzZScKICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgiaW1wdWxzZSIsc2VsZi5ub2RlLnBvc2l0aW9uWzBdLHNlbGYubm9kZS5wb3NpdGlvblsxXS0yLHNlbGYubm9kZS5wb3NpdGlvblsyXSxzZWxmLm5vZGUudmVsb2NpdHlbMF0qMCwyMCArMC4wMSoodCAtIHNlbGYubGFzdEp1bXBUaW1lKSxzZWxmLm5vZGUudmVsb2NpdHlbMl0qMCwxMCw1LDAsMCxzZWxmLm5vZGUudmVsb2NpdHlbMF0qLTAuMSwyMCArIDAuMDEqKHQgLSBzZWxmLmxhc3RKdW1wVGltZSksc2VsZi5ub2RlLnZlbG9jaXR5WzJdKjApCiAgICAgICAgICAgICAgICB0ZXggPSBzZWxmLl9nZXRCb21iVHlwZVRleCgpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLTIwMDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdhbnRpR3Jhdic6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ2FudGlHcmF2JwogICAgICAgICAgICAgICAgdGV4ID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKQogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQgKyBnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lIC0gMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmYpKQoKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ25pZ2h0Qm9tYic6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ25pZ2h0Qm9tYicKICAgICAgICAgICAgICAgIHRleCA9IHNlbGYuX2dldEJvbWJUeXBlVGV4KCkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjQVRPTSBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnYmxhc3RCb21iJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnYmxhc3RCb21iJwogICAgICAgICAgICAgICAgdGV4ID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNCTEFTUiBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAncmV2ZW5nZUJvbWInOgogICAgICAgICAgICAgICAgc2VsZi5ib21iVHlwZSA9ICdyZXZlbmdlQm9tYicKICAgICAgICAgICAgICAgIHRleCA9IHNlbGYuX2dldEJvbWJUeXBlVGV4KCkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjUkVWRU5HRVx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnZGlydEJvbWJzJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnaWNlJwogICAgICAgICAgICAgICAgdGV4ID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4RGlydAogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNTTE9XIEJPTUJTXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lciggZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmYpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyMjQkxBQ0sgQk9NQiMjIwogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAna2lsbExhS2lsbEJvbWJzJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAna2lsbExhS2lsbCcgCiAgICAgICAgICAgICAgICB0ZXggPSBicy5nZXRUZXh0dXJlKCdibGFjaycpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0RJRSBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoIGdQb3dlcnVwV2Vhck9mZlRpbWUtMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmKSkKCiAgICAgICAgICAgICMjI1BPSVNPTiBCT01CIyMjCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdwb2lzb25Cb21icyc6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ3BvaXNvbicgCiAgICAgICAgICAgICAgICB0ZXggPSBicy5nZXRUZXh0dXJlKCdlZ2dUZXgyJykKICAgICAgICAgICAgICAgIFBvaXNvbihvd25lcj1zZWxmLm5vZGUpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0N1cnNlcyBsaWwgc2lzdGVyXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lciggZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmYpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCiAgICAgICAgICAgICMjI0pVTVBJTkcgQk9NQiMjIwogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnanVtcGluZ0JvbWJzJzoKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAncXEnIAogICAgICAgICAgICAgICAgdGV4ID0gYnMuZ2V0VGV4dHVyZSgnZWdnVGV4MycpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0p1bXBzIGFuZCBkYW1hZ2VzXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CiAgICAgICAgICAgICAgICBpZiBzZWxmLnBvd2VydXBzRXhwaXJlOgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlRleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMlN0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZGbGFzaFRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lciggZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmYpKQoKICAgICAgICAgICAgIyMjVFAgQk9NQiMjIwogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAndHBCb21icyc6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ3RwJyAKICAgICAgICAgICAgICAgIHRleCA9IGJzLmdldFRleHR1cmUoJ2JvbWJTdGlja3lDb2xvcicpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBUZWxlcG9ydChvd25lcj1zZWxmLm5vZGUpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY1RlbGVwb3J0IEJPTUIgMlx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoIGdQb3dlcnVwV2Vhck9mZlRpbWUtMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2JvbWJXZWFyT2ZmKSkKCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdzdGlja3lCb21icyc6CiAgICAgICAgICAgICAgICBzZWxmLmJvbWJUeXBlID0gJ3N0aWNreScKICAgICAgICAgICAgICAgIHRleCA9IHNlbGYuX2dldEJvbWJUeXBlVGV4KCkKICAgICAgICAgICAgICAgIHNlbGYuX2ZsYXNoQmlsbGJvYXJkKHRleCkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjU3RpY2tzIHRvIFlvdVx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAncHVuY2gnOgogICAgICAgICAgICAgICAgc2VsZi5faGFzQm94aW5nR2xvdmVzID0gVHJ1ZQogICAgICAgICAgICAgICAgdGV4ID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4UHVuY2gKICAgICAgICAgICAgICAgIHNlbGYuX2ZsYXNoQmlsbGJvYXJkKHRleCkKICAgICAgICAgICAgICAgIHNlbGYuZXF1aXBCb3hpbmdHbG92ZXMoKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNTaGFuayBFTVx1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuYm94aW5nR2xvdmVzRmxhc2hpbmcgPSAwCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQzU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM0VuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib3hpbmdHbG92ZXNXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9nbG92ZXNXZWFyT2ZmRmxhc2gpKQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JveGluZ0dsb3Zlc1dlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fZ2xvdmVzV2Vhck9mZikpIAoKICAgICAgICAgICAgIyMjWUVMTE9XIFNISUVMRCMjIwogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAneWVsbG93U2hpZWxkJzoKICAgICAgICAgICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQogICAgICAgICAgICAgICAgc2VsZi5lcXVpcFllbGxvd1NoaWVsZHMoZGVjYXkgPSBUcnVlKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNDb2xvcnkgQnViYmxlXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CgogICAgICAgICAgICAjIyNTUEVFREVTVCBQVU5DSCMjIwogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnc3BlZWRQdW5jaCc6CiAgICAgICAgICAgICAgICBzZWxmLl9wdW5jaFBvd2VyU2NhbGUgPSAxLjIKICAgICAgICAgICAgICAgIHNlbGYuX3B1bmNoQ29vbGRvd24gPSAxMzAKICAgICAgICAgICAgICAgIHNlbGYuX2hhc0JveGluZ0dsb3ZlcyA9IEZhbHNlCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuYm94aW5nR2xvdmVzID0gMAogICAgICAgICAgICAgICAgdGV4ID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4U3BlZWRQdW5jaAogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNTaGFuayBlbSBHdWRcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmJveGluZ0dsb3Zlc0ZsYXNoaW5nID0gMAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1RleHR1cmUgPSB0ZXgKICAgICAgICAgICAgICAgICAgICB0ID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkM1N0YXJ0VGltZSA9IHQKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDNFbmRUaW1lID0gdCtnUG93ZXJ1cFdlYXJPZmZUaW1lCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm94aW5nR2xvdmVzV2Vhck9mZkZsYXNoVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUtMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fZ2xvdmVzV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib3hpbmdHbG92ZXNXZWFyT2ZmVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLldlYWtDYWxsKHNlbGYuX2dsb3Zlc1dlYXJPZmYpKQoKICAgICAgICAgICAgZWxpZiBtc2cucG93ZXJ1cFR5cGUgPT0gJ3VuYnJlYWthYmxlJzoKICAgICAgICAgICAgICAgIHRleCA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleFVuYgogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQodGV4KQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNVTkJcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQxVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQxU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMUVuZFRpbWUgPSB0ICsgZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX3VuYnJlYWthYmxlV2Vhck9mZkZsYXNoVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUgLSAyMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl91bmJyZWFrYWJsZVdlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fX3VuYnJlYWthYmxlV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl91bmJyZWFrYWJsZVdlYXJPZmYpKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgbXNnLnBvd2VydXBUeXBlID09ICdzaGllbGQnOgogICAgICAgICAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgICAgICAgICBzZWxmLmVxdWlwU2hpZWxkcygKICAgICAgICAgICAgICAgICAgICBkZWNheT1UcnVlIGlmIGZhY3Rvcnkuc2hpZWxkRGVjYXlSYXRlID4gMCBlbHNlIEZhbHNlKQogICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwMGNQb3AgTWUgUExTXHVlMDBjIixjb2xvcj0oMSwwLjUsMCksc2NhbGU9MS41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikuYXV0b1JldGFpbigpCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sdmVsb2NpdHk9KDAsMCwwKSxjb3VudD02MDAsc3ByZWFkPTAuNyxjaHVua1R5cGU9J3NwYXJrJyk7CgogICAgICAgICAgICBlbGlmIG1zZy5wb3dlcnVwVHlwZSA9PSAnY3Vyc2UnOgogICAgICAgICAgICAgICAgc2VsZi5jdXJzZSgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY1RPVUNIIE1FIFBMU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwoKICAgICAgICAgICAgZWxpZiAobXNnLnBvd2VydXBUeXBlID09ICdpY2VCb21icycpOgogICAgICAgICAgICAgICAgc2VsZi5ib21iVHlwZSA9ICdpY2UnCiAgICAgICAgICAgICAgICB0ZXggPSBzZWxmLl9nZXRCb21iVHlwZVRleCgpCiAgICAgICAgICAgICAgICBzZWxmLl9mbGFzaEJpbGxib2FyZCh0ZXgpCiAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAwY0lDWSBCT01CU1x1ZTAwYyIsY29sb3I9KDEsMC41LDApLHNjYWxlPTEuNSxwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLHZlbG9jaXR5PSgwLDAsMCksY291bnQ9NjAwLHNwcmVhZD0wLjcsY2h1bmtUeXBlPSdzcGFyaycpOwogICAgICAgICAgICAgICAgaWYgc2VsZi5wb3dlcnVwc0V4cGlyZToKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJUZXh0dXJlID0gdGV4CiAgICAgICAgICAgICAgICAgICAgdCA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUubWluaUJpbGxib2FyZDJTdGFydFRpbWUgPSB0CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyRW5kVGltZSA9IHQrZ1Bvd2VydXBXZWFyT2ZmVGltZQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2JvbWJXZWFyT2ZmRmxhc2hUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZS0yMDAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZkZsYXNoKSkKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZlRpbWVyID0gXAogICAgICAgICAgICAgICAgICAgICAgICBicy5UaW1lcihnUG93ZXJ1cFdlYXJPZmZUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5XZWFrQ2FsbChzZWxmLl9ib21iV2Vhck9mZikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbGlmIChtc2cucG93ZXJ1cFR5cGUgPT0gJ2ZpcmV3b3JrQm9tYnMnKToKICAgICAgICAgICAgICAgIHNlbGYuYm9tYlR5cGUgPSAnZmlyZXdvcmsnCiAgICAgICAgICAgICAgICB0ZXggPSBicy5nZXRUZXh0dXJlKCdlZ2dUZXgxJykKICAgICAgICAgICAgICAgIHNlbGYuX2ZsYXNoQmlsbGJvYXJkKHRleCkKICAgICAgICAgICAgICAgIGJzVXRpbHMuUG9wdXBUZXh0KHUiXHVlMDBjUGFyYWx5emUgQk9NQlNcdWUwMGMiLGNvbG9yPSgxLDAuNSwwKSxzY2FsZT0xLjUscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbix2ZWxvY2l0eT0oMCwwLDApLGNvdW50PTYwMCxzcHJlYWQ9MC43LGNodW5rVHlwZT0nc3BhcmsnKTsKICAgICAgICAgICAgICAgIGlmIHNlbGYucG93ZXJ1cHNFeHBpcmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyVGV4dHVyZSA9IHRleAogICAgICAgICAgICAgICAgICAgIHQgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLm1pbmlCaWxsYm9hcmQyU3RhcnRUaW1lID0gdAogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5taW5pQmlsbGJvYXJkMkVuZFRpbWUgPSB0K2dQb3dlcnVwV2Vhck9mZlRpbWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ib21iV2Vhck9mZkZsYXNoVGltZXIgPSBcCiAgICAgICAgICAgICAgICAgICAgICAgIGJzLlRpbWVyKGdQb3dlcnVwV2Vhck9mZlRpbWUtMjAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmZGbGFzaCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fYm9tYldlYXJPZmZUaW1lciA9IFwKICAgICAgICAgICAgICAgICAgICAgICAgYnMuVGltZXIoZ1Bvd2VydXBXZWFyT2ZmVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuV2Vha0NhbGwoc2VsZi5fYm9tYldlYXJPZmYpKQoKICAgICAgICAgICAgZWxpZiAobXNnLnBvd2VydXBUeXBlID09ICdoZWFsdGgnKToKICAgICAgICAgICAgICAgIGlmIHNlbGYuX2N1cnNlZDoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9jdXJzZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQogICAgICAgICAgICAgICAgICAgIGZvciBhdHRyIGluIFsnbWF0ZXJpYWxzJywgJ3JvbGxlck1hdGVyaWFscyddOgogICAgICAgICAgICAgICAgICAgICAgICBtYXRlcmlhbHMgPSBnZXRhdHRyKHNlbGYubm9kZSwgYXR0cikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZmFjdG9yeS5jdXJzZU1hdGVyaWFsIGluIG1hdGVyaWFsczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldGF0dHIoc2VsZi5ub2RlLCBhdHRyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0dXBsZShtIGZvciBtIGluIG1hdGVyaWFscwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBtICE9IGZhY3RvcnkuY3Vyc2VNYXRlcmlhbCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmN1cnNlRGVhdGhUaW1lID0gMAogICAgICAgICAgICAgICAgc2VsZi5oaXRQb2ludHMgPSBzZWxmLmhpdFBvaW50c01heAogICAgICAgICAgICAgICAgc2VsZi5fZmxhc2hCaWxsYm9hcmQoYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4SGVhbHRoKQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmh1cnQgPSAwCiAgICAgICAgICAgICAgICBzZWxmLl9sYXN0SGl0VGltZSA9IE5vbmUKICAgICAgICAgICAgICAgIHNlbGYuX251bVRpbWVzSGl0ID0gMAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJmbGFzaCIpCiAgICAgICAgICAgIGlmIG1zZy5zb3VyY2VOb2RlLmV4aXN0cygpOgogICAgICAgICAgICAgICAgbXNnLnNvdXJjZU5vZGUuaGFuZGxlTWVzc2FnZShicy5Qb3dlcnVwQWNjZXB0TWVzc2FnZSgpKQogICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5GcmVlemVNZXNzYWdlKToKICAgICAgICAgICAgdGltZT01MDAwCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgICAgICBpZiBzZWxmLm5vZGUuaW52aW5jaWJsZSA9PSBUcnVlOgogICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLmJsb2NrU291bmQsIDEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgaWYgc2VsZi5zaGllbGQgaXMgbm90IE5vbmUgb3Igc2VsZi55ZWxsb3dTaGllbGQgaXMgbm90IE5vbmU6IHJldHVybgogICAgICAgICAgICBpZiBub3Qgc2VsZi5mcm96ZW46CiAgICAgICAgICAgICAgICBzZWxmLmZyb3plbiA9IFRydWUKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5mcm96ZW4gPSAxCiAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIodGltZSwgYnMuV2Vha0NhbGwoc2VsZi5oYW5kbGVNZXNzYWdlLCBicy5UaGF3TWVzc2FnZSgpKSkKICAgICAgICAgICAgICAgICMgaW5zdGFudGx5IHNoYXR0ZXIgaWYgd2UncmUgYWxyZWFkeSBkZWFkCiAgICAgICAgICAgICAgICAjIChvdGhlcndpc2UgaXRzIGhhcmQgdG8gdGVsbCB3ZSdyZSBkZWFkKQogICAgICAgICAgICAgICAgaWYgc2VsZi5oaXRQb2ludHMgPD0gMDogc2VsZi5zaGF0dGVyKCkKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuVGhhd01lc3NhZ2UpOgogICAgICAgICAgICBpZiBzZWxmLmZyb3plbiBhbmQgbm90IHNlbGYuc2hhdHRlcmVkIGFuZCBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLmZyb3plbiA9IEZhbHNlCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZnJvemVuID0gMAogICAgICAgICAgICAgCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuSGl0TWVzc2FnZSk6CiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm5vZGUuZXhpc3RzKCk6IHJldHVybgogICAgICAgICAgICBpZiBzZWxmLm5vZGUuaW52aW5jaWJsZSA9PSBUcnVlOgogICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLmJsb2NrU291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMS4wLCBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICBnYW1lVGltZSA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgaWYgc2VsZi5fbGFzdEhpdFRpbWUgaXMgTm9uZSBvciBnYW1lVGltZS1zZWxmLl9sYXN0SGl0VGltZSA+IDEwMDA6CiAgICAgICAgICAgICAgICBzZWxmLl9udW1UaW1lc0hpdCArPSAxCiAgICAgICAgICAgICAgICBzZWxmLl9sYXN0SGl0VGltZSA9IGdhbWVUaW1lCiAgICAgICAgICAgIAogICAgICAgICAgICBtYWcgPSBtc2cubWFnbml0dWRlICogc2VsZi5faW1wYWN0U2NhbGUKICAgICAgICAgICAgdmVsb2NpdHlNYWcgPSBtc2cudmVsb2NpdHlNYWduaXR1ZGUgKiBzZWxmLl9pbXBhY3RTY2FsZQoKICAgICAgICAgICAgZGFtYWdlU2NhbGUgPSAwLjIyIGlmIG5vdCBzZWxmLnVuYnJlYWthYmxlIGVsc2UgMC4wMzMKCiAgICAgICAgICAgIGlmIHNlbGYueWVsbG93U2hpZWxkIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgaWYgbXNnLmZsYXREYW1hZ2U6IGRhbWFnZSA9IG1zZy5mbGF0RGFtYWdlICogc2VsZi5faW1wYWN0U2NhbGUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImltcHVsc2UiLCBtc2cucG9zWzBdLCBtc2cucG9zWzFdLCBtc2cucG9zWzJdLG1zZy52ZWxvY2l0eVswXSwgbXNnLnZlbG9jaXR5WzFdLCBtc2cudmVsb2NpdHlbMl0sbWFnICwgdmVsb2NpdHlNYWcsIG1zZy5yYWRpdXMsIDEsbXNnLmZvcmNlRGlyZWN0aW9uWzBdLCBtc2cuZm9yY2VEaXJlY3Rpb25bMV0sbXNnLmZvcmNlRGlyZWN0aW9uWzJdKQogICAgICAgICAgICAgICAgICAgIGRhbWFnZSA9IGRhbWFnZVNjYWxlICogc2VsZi5ub2RlLmRhbWFnZQoKICAgICAgICAgICAgICAgIHNlbGYueWVsbG93U2hpZWxkSGl0UG9pbnRzIC09IGRhbWFnZQogICAgICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGQuaHVydCA9ICgxLjAgLSBmbG9hdChzZWxmLnllbGxvd1NoaWVsZEhpdFBvaW50cykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL3NlbGYueWVsbG93U2hpZWxkSGl0UG9pbnRzTWF4KQogICAgICAgICAgICAgICAgbWF4U3BpbGxvdmVyID0gc2VsZi5nZXRGYWN0b3J5KCkubWF4U2hpZWxkU3BpbGxvdmVyRGFtYWdlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnllbGxvd1NoaWVsZEhpdFBvaW50cyA8PSAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYueWVsbG93U2hpZWxkLmRlbGV0ZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi55ZWxsb3dTaGllbGQgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNoaWVsZERvd25Tb3VuZCwgMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgdCA9IHNlbGYubm9kZS5wb3NpdGlvbgogICAgICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPSh0WzBdLCB0WzFdKzAuOSwgdFsyXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9c2VsZi5ub2RlLnZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PXJhbmRvbS5yYW5kcmFuZ2UoMjAsIDMwKSwgc2NhbGU9MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjYsIGNodW5rVHlwZT0nc3BhcmsnKQoKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaWYgbXNnLmhpdFN1YlR5cGUgIT0gJ3BvaXNvbkVmZmVjdCc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChzZWxmLmdldEZhY3RvcnkoKS5zaGllbGRIaXRTb3VuZCwgMC41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKCiAgICAgICAgICAgICAgICBpZiBtc2cuaGl0U3ViVHlwZSAhPSAnbm9kZS5oYW5kbGVNZXNzYWdlKCJrbm9ja291dCIsIDQ1LjApRWZmZWN0JzoKICAgICAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1tc2cucG9zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5PShtc2cuZm9yY2VEaXJlY3Rpb25bMF0qMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMV0qMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMl0qMS4wKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1taW4oMzAsIDUraW50KGRhbWFnZSowLjAwNSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuNSwgc3ByZWFkPTAuMywgY2h1bmtUeXBlPSdzcGFyaycpCgogICAgICAgICAgICAgICAgIyBpZiB0aGV5IHBhc3NlZCBvdXIgc3BpbGxvdmVyIHRocmVzaG9sZCwKICAgICAgICAgICAgICAgICMgcGFzcyBkYW1hZ2UgYWxvbmcgdG8gc3BhegogICAgICAgICAgICAgICAgaWYgc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMgPD0gLW1heFNwaWxsb3ZlcjoKICAgICAgICAgICAgICAgICAgICBsZWZ0b3ZlckRhbWFnZSA9IC1tYXhTcGlsbG92ZXItc2VsZi55ZWxsb3dTaGllbGRIaXRQb2ludHMKICAgICAgICAgICAgICAgICAgICBzaGllbGRMZWZ0b3ZlclJhdGlvID0gbGVmdG92ZXJEYW1hZ2UvZGFtYWdlCgogICAgICAgICAgICAgICAgICAgICMgc2NhbGUgZG93biB0aGUgbWFnbml0dWRlcyBhcHBsaWVkIHRvIHNwYXogYWNjb3JkaW5nbHkuLgogICAgICAgICAgICAgICAgICAgIG1hZyAqPSBzaGllbGRMZWZ0b3ZlclJhdGlvCiAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHlNYWcgKj0gc2hpZWxkTGVmdG92ZXJSYXRpbwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZSAjIGdvb2Qgam9iIHNoaWVsZCEKICAgICAgICAgICAgZWxzZTogc2hpZWxkTGVmdG92ZXJSYXRpbyA9IDEuMAoKICAgICAgICAgICAgaWYgc2VsZi5zaGllbGQgaXMgbm90IE5vbmUgYW5kIG1zZy5oaXRTdWJUeXBlICE9ICdwb2lzb25FZmZlY3QnOgogICAgICAgICAgICAgICAgaWYgbXNnLmZsYXREYW1hZ2U6IGRhbWFnZSA9IG1zZy5mbGF0RGFtYWdlICogc2VsZi5faW1wYWN0U2NhbGUKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImltcHVsc2UiLCBtc2cucG9zWzBdLCBtc2cucG9zWzFdLCBtc2cucG9zWzJdLG1zZy52ZWxvY2l0eVswXSwgbXNnLnZlbG9jaXR5WzFdLCBtc2cudmVsb2NpdHlbMl0sbWFnICwgdmVsb2NpdHlNYWcsIG1zZy5yYWRpdXMsIDEsbXNnLmZvcmNlRGlyZWN0aW9uWzBdLCBtc2cuZm9yY2VEaXJlY3Rpb25bMV0sbXNnLmZvcmNlRGlyZWN0aW9uWzJdKQogICAgICAgICAgICAgICAgICAgIGRhbWFnZSA9IGRhbWFnZVNjYWxlICogc2VsZi5ub2RlLmRhbWFnZQoKICAgICAgICAgICAgICAgIHNlbGYuc2hpZWxkSGl0UG9pbnRzIC09IGRhbWFnZQogICAgICAgICAgICAgICAgc2VsZi5zaGllbGQuaHVydCA9ICgxLjAgLSBmbG9hdChzZWxmLnNoaWVsZEhpdFBvaW50cykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL3NlbGYuc2hpZWxkSGl0UG9pbnRzTWF4KQogICAgICAgICAgICAgICAgbWF4U3BpbGxvdmVyID0gc2VsZi5nZXRGYWN0b3J5KCkubWF4U2hpZWxkU3BpbGxvdmVyRGFtYWdlCiAgICAgICAgICAgICAgICBpZiBzZWxmLnNoaWVsZEhpdFBvaW50cyA8PSAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2hpZWxkLmRlbGV0ZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGllbGQgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNoaWVsZERvd25Tb3VuZCwgMS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgICAgICAgICAgdCA9IHNlbGYubm9kZS5wb3NpdGlvbgogICAgICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPSh0WzBdLCB0WzFdKzAuOSwgdFsyXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9c2VsZi5ub2RlLnZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PXJhbmRvbS5yYW5kcmFuZ2UoMjAsIDMwKSwgc2NhbGU9MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjYsIGNodW5rVHlwZT0nc3BhcmsnKQoKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaWYgbXNnLmhpdFN1YlR5cGUgIT0gJ3BvaXNvbkVmZmVjdCc6CiAgICAgICAgICAgICAgICAgICAgICAgIGJzLnBsYXlTb3VuZChzZWxmLmdldEZhY3RvcnkoKS5zaGllbGRIaXRTb3VuZCwgMC41LHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKCiAgICAgICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1tc2cucG9zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9KG1zZy5mb3JjZURpcmVjdGlvblswXSoxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzFdKjEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMl0qMS4wKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PW1pbigzMCwgNStpbnQoZGFtYWdlKjAuMDA1KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjUsIHNwcmVhZD0wLjMsIGNodW5rVHlwZT0nc3BhcmsnKQoKICAgICAgICAgICAgICAgICMgaWYgdGhleSBwYXNzZWQgb3VyIHNwaWxsb3ZlciB0aHJlc2hvbGQsCiAgICAgICAgICAgICAgICAjIHBhc3MgZGFtYWdlIGFsb25nIHRvIHNwYXoKICAgICAgICAgICAgICAgIGlmIHNlbGYuc2hpZWxkSGl0UG9pbnRzIDw9IC1tYXhTcGlsbG92ZXI6CiAgICAgICAgICAgICAgICAgICAgbGVmdG92ZXJEYW1hZ2UgPSAtbWF4U3BpbGxvdmVyLXNlbGYuc2hpZWxkSGl0UG9pbnRzCiAgICAgICAgICAgICAgICAgICAgc2hpZWxkTGVmdG92ZXJSYXRpbyA9IGxlZnRvdmVyRGFtYWdlL2RhbWFnZQoKICAgICAgICAgICAgICAgICAgICAjIHNjYWxlIGRvd24gdGhlIG1hZ25pdHVkZXMgYXBwbGllZCB0byBzcGF6IGFjY29yZGluZ2x5Li4KICAgICAgICAgICAgICAgICAgICBtYWcgKj0gc2hpZWxkTGVmdG92ZXJSYXRpbwogICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5TWFnICo9IHNoaWVsZExlZnRvdmVyUmF0aW8KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUgIyBnb29kIGpvYiBzaGllbGQhCiAgICAgICAgICAgIGVsc2U6IHNoaWVsZExlZnRvdmVyUmF0aW8gPSAxLjAKCiAgICAgICAgICAgIGlmIG1zZy5mbGF0RGFtYWdlOgogICAgICAgICAgICAgICAgZGFtYWdlID0gKG1zZy5mbGF0RGFtYWdlICogc2VsZi5faW1wYWN0U2NhbGUgKiBzaGllbGRMZWZ0b3ZlclJhdGlvKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgImltcHVsc2UiLCBtc2cucG9zWzBdLCBtc2cucG9zWzFdLCBtc2cucG9zWzJdLAogICAgICAgICAgICAgICAgICAgIG1zZy52ZWxvY2l0eVswXSwgbXNnLnZlbG9jaXR5WzFdLCBtc2cudmVsb2NpdHlbMl0sCiAgICAgICAgICAgICAgICAgICAgbWFnLCB2ZWxvY2l0eU1hZywgbXNnLnJhZGl1cywgMCwKICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMF0sIG1zZy5mb3JjZURpcmVjdGlvblsxXSwKICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMl0pCgogICAgICAgICAgICAgICAgZGFtYWdlID0gZGFtYWdlU2NhbGUgKiBzZWxmLm5vZGUuZGFtYWdlCgogICAgICAgICAgICBpZiBtc2cuaGl0U3ViVHlwZSAhPSAncG9pc29uRWZmZWN0Jzogc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImh1cnRTb3VuZCIpCgogICAgICAgICAgICBpZiBtc2cuaGl0VHlwZSA9PSAncHVuY2gnOgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLm9uUHVuY2hlZChkYW1hZ2UpCiAgICAgICAgICAgICAgICBpZiBkYW1hZ2UgPiAwIGFuZCBkYW1hZ2UgPCAxMDA6CiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwNGVCYWRcdWUwNGUiLGNvbG9yPSgxLDAuMywwLjUpLHNjYWxlPTEuNixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuc2hvd0RhbWFnZUNvdW50KCctJyArIHN0cihpbnQoZGFtYWdlKSkgKyAiIHBvaW50cyIsIG1zZy5wb3MsIG1zZy5mb3JjZURpcmVjdGlvbikKICAgICAgICAgICAgICAgIGlmIGRhbWFnZSA+IDIwMCBhbmQgZGFtYWdlIDwgNDUwOgogICAgICAgICAgICAgICAgICAgIGJzVXRpbHMuc2hvd0RhbWFnZUNvdW50KCctJyArIHN0cihpbnQoZGFtYWdlKSkgKyAiIHBvaW50cyIsIG1zZy5wb3MsIG1zZy5mb3JjZURpcmVjdGlvbikKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTA0OSNPU1VNIVx1ZTA0OSIsY29sb3I9KDAsMSwwLjMpLHNjYWxlPTEuNixwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pLmF1dG9SZXRhaW4oKQogICAgICAgICAgICAgICAgaWYgZGFtYWdlID49IDEwMDA6IAogICAgICAgICAgICAgICAgICAgIHNlbGYuZ2V0QWN0aXZpdHkoKS5oYW5kbGVNZXNzYWdlKGJzLkZhdGFsaXR5QW5pbWF0ZU1lc3NhZ2UoZGFtYWdlKSkKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLlBvcHVwVGV4dCh1Ilx1ZTAyY1RIRSBCT1NTXHVlMDJjIixjb2xvcj0oMC40LDAuMywxKSxzY2FsZT0xLjYscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGlmIGRhbWFnZSA+IDQ1MCBhbmQgZGFtYWdlIDwgMTAwMDoKICAgICAgICAgICAgICAgICAgICBic1V0aWxzLnNob3dEYW1hZ2VDb3VudCgnLScgKyBzdHIoaW50KGRhbWFnZS8xMCkpICsgIiUiLCBtc2cucG9zLCBtc2cuZm9yY2VEaXJlY3Rpb24pCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5Qb3B1cFRleHQodSJcdWUwNDhHcmFuZE1hc3Rlclx1ZTA0OCIsY29sb3I9KDEsMSwwKSxzY2FsZT0xLjYscG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uKS5hdXRvUmV0YWluKCkKICAgICAgICAgICAgICAgIGlmIGRhbWFnZSA+PSAxMDAwOgogICAgICAgICAgICAgICAgICAgIGRlZiBkZWxldGUoKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAicHVuY2hMaW5lIikgYW5kIHNlbGYucHVuY2hMaW5lIGlzIG5vdCBOb25lIGFuZCBzZWxmLnB1bmNoTGluZS5leGlzdHMoKTogc2VsZi5wdW5jaExpbmUuZGVsZXRlKCkKICAgICAgICAgICAgICAgICAgICBkZWxldGUoKQogICAgICAgICAgICAgICAgICAgIHNlbGYucHVuY2hMaW5lID0gYnMubmV3Tm9kZSgiZXhwbG9zaW9uIiwgYXR0cnM9ewogICAgICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOm1zZy5wb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICd2ZWxvY2l0eSc6KDEsMiwxKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3JhZGl1cyc6IDAuMDAxNSppbnQoZGFtYWdlLzEwMCksCiAgICAgICAgICAgICAgICAgICAgICAgICdiaWcnOiByYW5kb20ucmFuZG9tKCkgPiAwLjYsCiAgICAgICAgICAgICAgICAgICAgICAgICdjb2xvcic6KHJhbmRvbS5yYW5kb20oKSoyLCByYW5kb20ucmFuZG9tKCkqMiwgcmFuZG9tLnJhbmRvbSgpKjMpIGlmIGRhbWFnZSA8IDI3NTAgZWxzZSAocmFuZG9tLnJhbmRvbSgpKjMuNSwgcmFuZG9tLnJhbmRvbSgpKjMsIHJhbmRvbS5yYW5kb20oKSoyKX0pCiAgICAgICAgICAgICAgICAgICAgYnNVdGlscy5zaG93RGFtYWdlQ291bnQoIkZBVEFMSVRZISEhIiwgbXNnLnBvcywgbXNnLmZvcmNlRGlyZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAwLCBkZWxldGUpCiAgICAgICAgICAgICAgICBpZiBtc2cuaGl0U3ViVHlwZSA9PSAnc3VwZXJQdW5jaCc6CiAgICAgICAgICAgICAgICAgICAgdHJ5OiBicy5wbGF5U291bmQoc2VsZi5nZXRGYWN0b3J5KCkucHVuY2hTb3VuZFN0cm9uZ2VyLCAxLjAsIHBvc2l0aW9uPW1zZy5wb3MpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzIAogICAgICAgICAgICAgICAgaWYgZGFtYWdlID4gNTAwOgogICAgICAgICAgICAgICAgICAgIHNvdW5kcyA9IHNlbGYuZ2V0RmFjdG9yeSgpLnB1bmNoU291bmRzU3Ryb25nCiAgICAgICAgICAgICAgICAgICAgc291bmQgPSBzb3VuZHNbcmFuZG9tLnJhbmRyYW5nZShsZW4oc291bmRzKSldCiAgICAgICAgICAgICAgICAgICAgaWYgZGFtYWdlID4gMTAwMDoKICAgICAgICAgICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249bXNnLnBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J3NwYXJrJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eT0obXNnLmZvcmNlRGlyZWN0aW9uWzBdKjEuMyoxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5mb3JjZURpcmVjdGlvblsxXSoxLjMqMS41KzUuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzJdKjEuMyoxLjUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PW1pbigzMDAsIDEwNStpbnQoZGFtYWdlKjAuNDQpKSBpZiBkYW1hZ2UgPCAzMDAwMCBlbHNlIDU4MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuMjgpOwogICAgICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPW1zZy5wb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHVua1R5cGU9J3N3ZWF0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5PShtc2cuZm9yY2VEaXJlY3Rpb25bMF0qMS4zKjIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzFdKjEuMyoyKzUuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMl0qMS4zKjIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9bWluKDE1MCwgNzUraW50KGRhbWFnZSowLjQ0KSkgaWYgZGFtYWdlIDw9IDEwMDAgZWxzZSAxNTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjY1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByZWFkPTAuMjEpOwogICAgICAgICAgICAgICAgZWxzZTogc291bmQgPSBzZWxmLmdldEZhY3RvcnkoKS5wdW5jaFNvdW5kCiAgICAgICAgICAgICAgICB0cnk6IGJzLnBsYXlTb3VuZChzb3VuZCwgMS4wLCBwb3NpdGlvbj1tc2cucG9zKQogICAgICAgICAgICAgICAgZXhjZXB0OiBwYXNzCiAgICAgICAgICAgICAgICBzZWxmLnJlYWxQb3MgPSBtc2cucG9zCgogICAgICAgICAgICAgICAgIyB0aHJvdyB1cCBzb21lIGNodW5rcwogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249bXNnLnBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5PShtc2cuZm9yY2VEaXJlY3Rpb25bMF0qMC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5mb3JjZURpcmVjdGlvblsxXSowLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzJdKjAuNSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1taW4oMTAsIDEraW50KGRhbWFnZSowLjAwMjUpKSBpZiBkYW1hZ2UgPD0gMTAwMCBlbHNlIDE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC4zLCBzcHJlYWQ9MC4wMyk7CgogICAgICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249bXNnLnBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNodW5rVHlwZT0nc3dlYXQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9KG1zZy5mb3JjZURpcmVjdGlvblswXSoxLjMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzFdKjEuMys1LjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmZvcmNlRGlyZWN0aW9uWzJdKjEuMyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudD1taW4oMzAsIDEraW50KGRhbWFnZSowLjA0KSkgaWYgZGFtYWdlIDw9IDEwMDAgZWxzZSA0MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlPTAuOSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcmVhZD0wLjI4KTsKICAgICAgICAgICAgICAgICMgbW9tZW50YXJ5IGZsYXNoCiAgICAgICAgICAgICAgICBodXJ0aW5lc3MgPSBkYW1hZ2UqMC4wMDMKICAgICAgICAgICAgICAgIHB1bmNoUG9zID0gKG1zZy5wb3NbMF0rbXNnLmZvcmNlRGlyZWN0aW9uWzBdKjAuMDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cucG9zWzFdK21zZy5mb3JjZURpcmVjdGlvblsxXSowLjAyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLnBvc1syXSttc2cuZm9yY2VEaXJlY3Rpb25bMl0qMC4wMikKICAgICAgICAgICAgICAgIGZsYXNoQ29sb3IgPSAoMS4wLCAwLjgsIDAuNCkKICAgICAgICAgICAgICAgIGxpZ2h0ID0gYnMubmV3Tm9kZSgibGlnaHQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsncG9zaXRpb24nOnB1bmNoUG9zLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmFkaXVzJzowLjEyK2h1cnRpbmVzcyowLjEyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaW50ZW5zaXR5JzowLjMqKDEuMCsxLjAqaHVydGluZXNzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hlaWdodEF0dGVudWF0ZWQnOkZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sb3InOmZsYXNoQ29sb3J9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDYwLCBsaWdodC5kZWxldGUpCgogICAgICAgICAgICAgICAgZmxhc2ggPSBicy5uZXdOb2RlKCJmbGFzaCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM9eydwb3NpdGlvbic6cHVuY2hQb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzaXplJzowLjE3KzAuMTcqaHVydGluZXNzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sb3InOmZsYXNoQ29sb3J9KQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKDYwLCBmbGFzaC5kZWxldGUpCgogICAgICAgICAgICBpZiBtc2cuaGl0VHlwZSA9PSAnaW1wYWN0JzoKICAgICAgICAgICAgICAgIGJzLmVtaXRCR0R5bmFtaWNzKHBvc2l0aW9uPW1zZy5wb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eT0obXNnLmZvcmNlRGlyZWN0aW9uWzBdKjIuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZm9yY2VEaXJlY3Rpb25bMV0qMi4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5mb3JjZURpcmVjdGlvblsyXSoyLjApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9bWluKDEwLCAxK2ludChkYW1hZ2UqMC4wMSkpIGlmIGRhbWFnZSA8PSAyMDAwIGVsc2UgMTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjQsIHNwcmVhZD0wLjEpOwogICAgICAgICAgICBpZiBzZWxmLmhpdFBvaW50cyA+IDA6CiAgICAgICAgICAgICAgICAjIGl0cyBraW5kYSBjcmFwcHkgdG8gZGllIGZyb20gaW1wYWN0cywgc28gbGV0cyByZWR1Y2UKICAgICAgICAgICAgICAgICMgaW1wYWN0IGRhbWFnZSBieSBhIHJlYXNvbmFibGUgYW1vdW50IGlmIGl0J2xsIGtlZXAgdXMgYWxpdmUKICAgICAgICAgICAgICAgIGlmIG1zZy5oaXRUeXBlID09ICdpbXBhY3QnIGFuZCBkYW1hZ2UgPiBzZWxmLmhpdFBvaW50czoKICAgICAgICAgICAgICAgICAgICAjIGRyb3AgZGFtYWdlIHRvIHdoYXRldmVyIHB1dHMgdXMgYXQgMTAgaGl0IHBvaW50cywKICAgICAgICAgICAgICAgICAgICAjIG9yIDIwMCBsZXNzIHRoYW4gaXQgdXNlZCB0byBiZSB3aGljaGV2ZXIgaXMgZ3JlYXRlcgogICAgICAgICAgICAgICAgICAgICMgKHNvIGl0ICpjYW4qIHN0aWxsIGtpbGwgdXMgaWYgaXRzIGhpZ2ggZW5vdWdoKQogICAgICAgICAgICAgICAgICAgIG5ld0RhbWFnZSA9IG1heChkYW1hZ2UtMjAwLCBzZWxmLmhpdFBvaW50cy0xMCkKICAgICAgICAgICAgICAgICAgICBkYW1hZ2UgPSBuZXdEYW1hZ2UKICAgICAgICAgICAgICAgIGlmIG1zZy5oaXRTdWJUeXBlIG5vdCBpbiBbInBvaXNvbkVmZmVjdCJdOiBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgiZmxhc2giKQogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBob2xkaW5nIHNvbWV0aGluZywgZHJvcCBpdAogICAgICAgICAgICAgICAgaWYgZGFtYWdlID4gMC4wIGFuZCBzZWxmLm5vZGUuaG9sZE5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhvbGROb2RlID0gYnMuTm9kZShOb25lKQogICAgICAgICAgICAgICAgc2VsZi5oaXRQb2ludHMgLT0gZGFtYWdlCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaHVydCA9IDEuMCAtIGZsb2F0KHNlbGYuaGl0UG9pbnRzKS9zZWxmLmhpdFBvaW50c01heAogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBjdXJzZWQsICphbnkqIGRhbWFnZSBibG93cyB1cyB1cAogICAgICAgICAgICAgICAgaWYgc2VsZi5fY3Vyc2VkIGFuZCBkYW1hZ2UgPiAwOgogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcig1MCwgYnMuV2Vha0NhbGwoc2VsZi5jdXJzZUV4cGxvZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuc291cmNlUGxheWVyKSkKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgZnJvemVuLCBzaGF0dGVyLi4gb3RoZXJ3aXNlIGRpZSBpZiB3ZSBoaXQgemVybwogICAgICAgICAgICAgICAgaWYgc2VsZi5mcm96ZW4gYW5kIChkYW1hZ2UgPiAyMDAgb3Igc2VsZi5oaXRQb2ludHMgPD0gMCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGF0dGVyKCkKICAgICAgICAgICAgICAgIGVsaWYgc2VsZi5oaXRQb2ludHMgPD0gMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZShicy5EaWVNZXNzYWdlKGhvdz0naW1wYWN0JykpCgogICAgICAgICAgICAjIGlmIHdlJ3JlIGRlYWQsIHRha2UgYSBsb29rIGF0IHRoZSBzbW9vdGhlZCBkYW1hZ2UgdmFsCiAgICAgICAgICAgICMgKHdoaWNoIGdpdmVzIHVzIGEgc21vb3RoZWQgYXZlcmFnZSBvZiByZWNlbnQgZGFtYWdlKSBhbmQgc2hhdHRlcgogICAgICAgICAgICAjIHVzIGlmIGl0cyBncm93biBoaWdoIGVub3VnaAogICAgICAgICAgICBpZiBzZWxmLmhpdFBvaW50cyA8PSAwOgogICAgICAgICAgICAgICAgZGFtYWdlQXZnID0gc2VsZi5ub2RlLmRhbWFnZVNtb290aGVkICogZGFtYWdlU2NhbGUKICAgICAgICAgICAgICAgIGlmIGRhbWFnZUF2ZyA+IDEwMDA6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5zaGF0dGVyKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgZG9uLnNob3dIUDogc2VsZi5faHBUZXh0LnRleHQgPSAnSFA6ICcgKyAgc3RyKGludChzZWxmLmhpdFBvaW50cykpCiAgICAgICAgICAgIGVsc2U6IHNlbGYuX2hwVGV4dC50ZXh0ID0gJycKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgX0JvbWJEaWVkTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYuYm9tYkNvdW50ICs9IDEKICAgICAgICAKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5EaWVNZXNzYWdlKToKICAgICAgICAgICAgd2FzRGVhZCA9IHNlbGYuX2RlYWQKICAgICAgICAgICAgc2VsZi5fZGVhZCA9IFRydWUKICAgICAgICAgICAgc2VsZi5oaXRQb2ludHMgPSAwCiAgICAgICAgICAgIGlmIG1zZy5pbW1lZGlhdGU6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZGVsZXRlKCkKICAgICAgICAgICAgZWxpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaHVydCA9IDEuMAogICAgICAgICAgICAgICAgaWYgc2VsZi5wbGF5QmlnRGVhdGhTb3VuZCBhbmQgbm90IHdhc0RlYWQ6CiAgICAgICAgICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNpbmdsZVBsYXllckRlYXRoU291bmQpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuZGVhZCA9IFRydWUKICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigyMDAwLCBzZWxmLm5vZGUuZGVsZXRlKQoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5PdXRPZkJvdW5kc01lc3NhZ2UpOgogICAgICAgICAgICAjIGJ5IGRlZmF1bHQgd2UganVzdCBkaWUgaGVyZQogICAgICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UoYnMuRGllTWVzc2FnZShob3c9J2ZhbGwnKSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5TdGFuZE1lc3NhZ2UpOgogICAgICAgICAgICBzZWxmLl9sYXN0U3RhbmRQb3MgPSAobXNnLnBvc2l0aW9uWzBdLCBtc2cucG9zaXRpb25bMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cucG9zaXRpb25bMl0pCiAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJzdGFuZCIsIG1zZy5wb3NpdGlvblswXSwgbXNnLnBvc2l0aW9uWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cucG9zaXRpb25bMl0sIG1zZy5hbmdsZSkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBfQ3Vyc2VFeHBsb2RlTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYuY3Vyc2VFeHBsb2RlKCkKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBfUHVuY2hIaXRNZXNzYWdlKToKICAgICAgICAgICAgbm9kZSA9IGJzLmdldENvbGxpc2lvbkluZm8oIm9wcG9zaW5nTm9kZSIpCgogICAgICAgICAgICAjIG9ubHkgYWxsb3cgb25lIGhpdCBwZXIgbm9kZSBwZXIgcHVuY2gKICAgICAgICAgICAgaWYgKG5vZGUgaXMgbm90IE5vbmUgYW5kIG5vZGUuZXhpc3RzKCkKICAgICAgICAgICAgICAgIGFuZCBub3Qgbm9kZSBpbiBzZWxmLl9wdW5jaGVkTm9kZXMpOgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwdW5jaE1vbWVudHVtQW5ndWxhciA9IChzZWxmLm5vZGUucHVuY2hNb21lbnR1bUFuZ3VsYXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogc2VsZi5fcHVuY2hQb3dlclNjYWxlKQogICAgICAgICAgICAgICAgcHVuY2hQb3dlciA9IHNlbGYubm9kZS5wdW5jaFBvd2VyICogc2VsZi5fcHVuY2hQb3dlclNjYWxlCgogICAgICAgICAgICAgICAgIyBvayBoZXJlJ3MgdGhlIGRlYWw6ICB3ZSBwYXNzIGFsb25nIG91ciBiYXNlIHZlbG9jaXR5IGZvciB1c2UKICAgICAgICAgICAgICAgICMgaW4gdGhlIGltcHVsc2UgZGFtYWdlIGNhbGN1bGF0aW9ucyBzaW5jZSB0aGF0IGlzIGEgbW9yZQogICAgICAgICAgICAgICAgIyBwcmVkaWN0YWJsZSB2YWx1ZSB0aGFuIG91ciBmaXN0IHZlbG9jaXR5LCB3aGljaCBpcyByYXRoZXIKICAgICAgICAgICAgICAgICMgZXJyYXRpYy4gLi4uaG93ZXZlciB3ZSB3YW50IHRvIGFjdHVhbGx5IGFwcGx5IGZvcmNlIGluIHRoZQogICAgICAgICAgICAgICAgIyBkaXJlY3Rpb24gb3VyIGZpc3QgaXMgbW92aW5nIHNvIGl0IGxvb2tzIGJldHRlci4uIHNvIHdlIHN0aWxsCiAgICAgICAgICAgICAgICAjIHBhc3MgdGhhdCBhbG9uZyBhcyBhIGRpcmVjdGlvbiAuLnBlcmhhcHMgYSB0aW1lLWF2ZXJhZ2VkCiAgICAgICAgICAgICAgICAjIGZpc3QtdmVsb2NpdHkgd291bGQgd29yayB0b28/Li4gc2hvdWxkIHRyeSB0aGF0LgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIGlmIGl0cyBzb21ldGhpbmcgYmVzaWRlcyBhbm90aGVyIHNwYXosIGp1c3QgZG8gYSBtdWZmbGVkIHB1bmNoCiAgICAgICAgICAgICAgICAjIHNvdW5kCiAgICAgICAgICAgICAgICBpZiBub2RlLmdldE5vZGVUeXBlKCkgIT0gJ3NwYXonOgogICAgICAgICAgICAgICAgICAgIHNvdW5kcyA9IHNlbGYuZ2V0RmFjdG9yeSgpLmltcGFjdFNvdW5kc01lZGl1bQogICAgICAgICAgICAgICAgICAgIHNvdW5kID0gc291bmRzW3JhbmRvbS5yYW5kcmFuZ2UobGVuKHNvdW5kcykpXQogICAgICAgICAgICAgICAgICAgIHRyeTogYnMucGxheVNvdW5kKHNvdW5kLCAxLjAsIHBvc2l0aW9uPXNlbGYucmVhbFBvcykKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6IHBhc3MKCiAgICAgICAgICAgICAgICB0ID0gc2VsZi5ub2RlLnB1bmNoUG9zaXRpb24KICAgICAgICAgICAgICAgIHB1bmNoRGlyID0gc2VsZi5ub2RlLnB1bmNoVmVsb2NpdHkKICAgICAgICAgICAgICAgIHYgPSBzZWxmLm5vZGUucHVuY2hNb21lbnR1bUxpbmVhcgoKICAgICAgICAgICAgICAgIHNlbGYuX3B1bmNoZWROb2Rlcy5hZGQobm9kZSkKICAgICAgICAgICAgICAgIG5vZGUuaGFuZGxlTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICBicy5IaXRNZXNzYWdlKAogICAgICAgICAgICAgICAgICAgICAgICBwb3M9dCwKICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9diwKICAgICAgICAgICAgICAgICAgICAgICAgbWFnbml0dWRlPXB1bmNoUG93ZXIqcHVuY2hNb21lbnR1bUFuZ3VsYXIqMTEwLjAsCiAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5TWFnbml0dWRlPXB1bmNoUG93ZXIqNDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHJhZGl1cz0wLAogICAgICAgICAgICAgICAgICAgICAgICBzcmNOb2RlPXNlbGYubm9kZSwKICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlUGxheWVyPXNlbGYuc291cmNlUGxheWVyLAogICAgICAgICAgICAgICAgICAgICAgICBmb3JjZURpcmVjdGlvbiA9IHB1bmNoRGlyLAogICAgICAgICAgICAgICAgICAgICAgICBoaXRUeXBlPSdwdW5jaCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGhpdFN1YlR5cGU9KCdzdXBlclB1bmNoJyBpZiBzZWxmLl9oYXNCb3hpbmdHbG92ZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAnZGVmYXVsdCcpKSkKCiAgICAgICAgICAgICAgICAjIGFsc28gYXBwbHkgb3Bwb3NpdGUgdG8gb3Vyc2VsZiBmb3IgdGhlIGZpcnN0IHB1bmNoIG9ubHkKICAgICAgICAgICAgICAgICMgLi50aGlzIGlzIGdpdmVuIGFzIGEgY29uc3RhbnQgZm9yY2Ugc28gdGhhdCBpdCBpcyBtb3JlCiAgICAgICAgICAgICAgICAjIG5vdGljYWJsZSBmb3Igc2xvd2VyIHB1bmNoZXMgd2hlcmUgaXQgbWF0dGVycy4uIGZvciBmYXN0CiAgICAgICAgICAgICAgICAjIGF3ZXNvbWUgbG9va2luZyBwdW5jaGVzIGl0cyBvayBpZiB3ZSBwdW5jaCAndGhyb3VnaCcKICAgICAgICAgICAgICAgICMgdGhlIHRhcmdldAogICAgICAgICAgICAgICAgbWFnID0gLTQwMC4wCiAgICAgICAgICAgICAgICBpZiBzZWxmLl9ob2NrZXk6IG1hZyAqPSAwLjUKICAgICAgICAgICAgICAgIGlmIGxlbihzZWxmLl9wdW5jaGVkTm9kZXMpID09IDE6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmhhbmRsZU1lc3NhZ2UoImtpY2tCYWNrIiwgdFswXSwgdFsxXSwgdFsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdW5jaERpclswXSwgcHVuY2hEaXJbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVuY2hEaXJbMl0sIG1hZykKCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgX1BpY2t1cE1lc3NhZ2UpOgogICAgICAgICAgICBvcHBvc2luZ05vZGUsIG9wcG9zaW5nQm9keSA9IGJzLmdldENvbGxpc2lvbkluZm8oJ29wcG9zaW5nTm9kZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHBvc2luZ0JvZHknKQoKICAgICAgICAgICAgaWYgb3Bwb3NpbmdOb2RlIGlzIE5vbmUgb3Igbm90IG9wcG9zaW5nTm9kZS5leGlzdHMoKTogcmV0dXJuIFRydWUKCiAgICAgICAgICAgICMgZG9udCBhbGxvdyBwaWNraW5nIHVwIG9mIGludmluY2libGUgZHVkZXMKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgb3Bwb3NpbmdOb2RlLmludmluY2libGUgPT0gVHJ1ZTogcmV0dXJuIFRydWUKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjogcGFzcwoKICAgICAgICAgICAgIyBpZiB3ZSdyZSBncmFiYmluZyB0aGUgcGVsdmlzIG9mIGEgbm9uLXNoYXR0ZXJlZCBzcGF6LCB3ZSB3YW5uYQogICAgICAgICAgICAjIGdyYWIgdGhlIHRvcnNvIGluc3RlYWQKICAgICAgICAgICAgaWYgKG9wcG9zaW5nTm9kZS5nZXROb2RlVHlwZSgpID09ICdzcGF6JwogICAgICAgICAgICAgICAgYW5kIG5vdCBvcHBvc2luZ05vZGUuc2hhdHRlcmVkIGFuZCBvcHBvc2luZ0JvZHkgPT0gNCk6CiAgICAgICAgICAgICAgICBvcHBvc2luZ0JvZHkgPSAxCgogICAgICAgICAgICAjIHNwZWNpYWwgY2FzZSAtIGlmIHdlJ3JlIGhvbGRpbmcgYSBmbGFnLCBkb250IHJlcGxhY2UgaXQKICAgICAgICAgICAgIyAoIGhtbSAtIHNob3VsZCBtYWtlIHRoaXMgY3VzdG9taXphYmxlIG9yIG1vcmUgbG93IGxldmVsICkKICAgICAgICAgICAgaGVsZCA9IHNlbGYubm9kZS5ob2xkTm9kZQogICAgICAgICAgICBpZiAoaGVsZCBpcyBub3QgTm9uZSBhbmQgaGVsZC5leGlzdHMoKQogICAgICAgICAgICAgICAgYW5kIGhlbGQuZ2V0Tm9kZVR5cGUoKSA9PSAnZmxhZycpOiByZXR1cm4gVHJ1ZQogICAgICAgICAgICBzZWxmLm5vZGUuaG9sZEJvZHkgPSBvcHBvc2luZ0JvZHkgIyBuZWVkcyB0byBiZSBzZXQgYmVmb3JlIGhvbGROb2RlCiAgICAgICAgICAgIHNlbGYubm9kZS5ob2xkTm9kZSA9IG9wcG9zaW5nTm9kZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJzLkFjdG9yLmhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKQoKICAgIGRlZiBkcm9wQm9tYihzZWxmKToKICAgICAgICAiIiIKICAgICAgICBUZWxsIHRoZSBzcGF6IHRvIGRyb3Agb25lIG9mIGhpcyBib21icywgYW5kIHJldHVybnMKICAgICAgICB0aGUgcmVzdWx0aW5nIGJvbWIgb2JqZWN0LgogICAgICAgIElmIHRoZSBzcGF6IGhhcyBubyBib21icyBvciBpcyBvdGhlcndpc2UgdW5hYmxlIHRvCiAgICAgICAgZHJvcCBhIGJvbWIsIHJldHVybnMgTm9uZS4KICAgICAgICAiIiIKCiAgICAgICAgaWYgKHNlbGYubGFuZE1pbmVDb3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiAoc2VsZi50Ym9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLmdsdWVib21iQ291bnQgPD0gMCBhbmQgc2VsZi5ib21iQ291bnQgPD0gMCkgb3Igc2VsZi5mcm96ZW46CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsaWYgKHNlbGYud2VlZGJvbWJDb3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiAoc2VsZi5pY2VJbXBhY3RDb3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiAoc2VsZi5jdXJzZUJvbWJDb3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiAoc2VsZi5oZWFsQm9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLmtub2NrQm9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLnNwZWVkQm9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLm1qQm9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLmljeVRyaW9Db3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiAoc2VsZi5ib29tQm9tYkNvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLnRyaW9Cb21iQ291bnQgPD0gMCBhbmQgc2VsZi5ib21iQ291bnQgPD0gMCkgb3Igc2VsZi5mcm96ZW46CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsaWYgKHNlbGYuc3RpY2t5SWNlQ291bnQgPD0gMCBhbmQgc2VsZi5ib21iQ291bnQgPD0gMCkgb3Igc2VsZi5mcm96ZW46CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsaWYgKHNlbGYuc3RpY2t5SWNlVHJpb0NvdW50IDw9IDAgYW5kIHNlbGYuYm9tYkNvdW50IDw9IDApIG9yIHNlbGYuZnJvemVuOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbGlmIChzZWxmLmNoYXJhY3RlckJvbWJDb3VudCA8PSAwIGFuZCBzZWxmLmJvbWJDb3VudCA8PSAwKSBvciBzZWxmLmZyb3plbjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcCA9IHNlbGYubm9kZS5wb3NpdGlvbkZvcndhcmQKICAgICAgICB2ID0gc2VsZi5ub2RlLnZlbG9jaXR5CgogICAgICAgIGlmIHNlbGYubGFuZE1pbmVDb3VudCA+IDA6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYuc2V0TGFuZE1pbmVDb3VudChzZWxmLmxhbmRNaW5lQ291bnQtMSkKICAgICAgICAgICAgYm9tYlR5cGUgPSAnbGFuZE1pbmUnCiAgICAgICAgZWxpZiBzZWxmLnRib21iQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldHRib21iQ291bnQoc2VsZi50Ym9tYkNvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ3Rib21iJwogICAgICAgIGVsaWYgc2VsZi53ZWVkYm9tYkNvdW50ID4gMDoKICAgICAgICAgICAgZHJvcHBpbmdCb21iID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXR3ZWVkYm9tYkNvdW50KHNlbGYud2VlZGJvbWJDb3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICd3ZWVkYm9tYicKICAgICAgICAgICAgYm9tYlR5cGUgPSAnd2VlZGJvbWInCiAgICAgICAgZWxpZiBzZWxmLmdsdWVib21iQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldGdsdWVib21iQ291bnQoc2VsZi5nbHVlYm9tYkNvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ2dsdWVib21iJwogICAgICAgIGVsaWYgc2VsZi5pY2VJbXBhY3RDb3VudCA+IDA6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYuc2V0aWNlSW1wYWN0Q291bnQoc2VsZi5pY2VJbXBhY3RDb3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICdpY2VJbXBhY3QnCiAgICAgICAgZWxpZiBzZWxmLmN1cnNlQm9tYkNvdW50ID4gMDoKICAgICAgICAgICAgZHJvcHBpbmdCb21iID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXRjdXJzZUJvbWJDb3VudChzZWxmLmN1cnNlQm9tYkNvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ2N1cnNlQm9tYicKICAgICAgICBlbGlmIHNlbGYuaGVhbEJvbWJDb3VudCA+IDA6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYuc2V0aGVhbEJvbWJDb3VudChzZWxmLmhlYWxCb21iQ291bnQtMSkKICAgICAgICAgICAgYm9tYlR5cGUgPSAnaGVhbEJvbWInCiAgICAgICAgZWxpZiBzZWxmLmtub2NrQm9tYkNvdW50ID4gMDoKICAgICAgICAgICAgZHJvcHBpbmdCb21iID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXRrbm9ja0JvbWJDb3VudChzZWxmLmtub2NrQm9tYkNvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ2tub2NrQm9tYicKICAgICAgICBlbGlmIHNlbGYuc3BlZWRCb21iQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldHNwZWVkQm9tYkNvdW50KHNlbGYuc3BlZWRCb21iQ291bnQtMSkKICAgICAgICAgICAgYm9tYlR5cGUgPSAnc3BlZWRCb21iJwogICAgICAgIGVsaWYgc2VsZi5takJvbWJDb3VudCA+IDA6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYuc2V0bWpCb21iQ291bnQoc2VsZi5takJvbWJDb3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICdtakJvbWInCiAgICAgICAgZWxpZiBzZWxmLmljeVRyaW9Db3VudCA+IDA6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYuc2V0aWN5VHJpb0NvdW50KHNlbGYuaWN5VHJpb0NvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ2ljeVRyaW8nCiAgICAgICAgZWxpZiBzZWxmLmJvb21Cb21iQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldGJvb21Cb21iQ291bnQoc2VsZi5ib29tQm9tYkNvdW50LTEpCiAgICAgICAgICAgIGJvbWJUeXBlID0gJ2Jvb21Cb21iJwogICAgICAgIGVsaWYgc2VsZi50cmlvQm9tYkNvdW50ID4gMDoKICAgICAgICAgICAgZHJvcHBpbmdCb21iID0gRmFsc2UKICAgICAgICAgICAgc2VsZi5zZXR0cmlvQm9tYkNvdW50KHNlbGYudHJpb0JvbWJDb3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICd0cmlvQm9tYicKICAgICAgICBlbGlmIHNlbGYuc3RpY2t5SWNlQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldHN0aWNreUljZUNvdW50KHNlbGYuc3RpY2t5SWNlQ291bnQtMSkKICAgICAgICAgICAgYm9tYlR5cGUgPSAnc3RpY2t5SWNlJwogICAgICAgIGVsaWYgc2VsZi5zdGlja3lJY2VUcmlvQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldHN0aWNreUljZVRyaW9Db3VudChzZWxmLnN0aWNreUljZVRyaW9Db3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICdzdGlja3lJY2VUcmlvJwogICAgICAgIGVsaWYgc2VsZi5jaGFyYWN0ZXJCb21iQ291bnQgPiAwOgogICAgICAgICAgICBkcm9wcGluZ0JvbWIgPSBGYWxzZQogICAgICAgICAgICBzZWxmLnNldGNoYXJhY3RlckJvbWJDb3VudChzZWxmLmNoYXJhY3RlckJvbWJDb3VudC0xKQogICAgICAgICAgICBib21iVHlwZSA9ICdjaGFyYWN0ZXJCb21iJwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRyb3BwaW5nQm9tYiA9IFRydWUKICAgICAgICAgICAgYm9tYlR5cGUgPSBzZWxmLmJvbWJUeXBlCgogICAgICAgIGJvbWIgPSBicy5Cb21iKHBvc2l0aW9uPShwWzBdLCBwWzFdIC0gMC4wLCBwWzJdKSwKICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eT0odlswXSwgdlsxXSwgdlsyXSksCiAgICAgICAgICAgICAgICAgICAgICAgYm9tYlR5cGU9Ym9tYlR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgYmxhc3RSYWRpdXM9c2VsZi5ibGFzdFJhZGl1cywKICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VQbGF5ZXI9c2VsZi5zb3VyY2VQbGF5ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgb3duZXI9c2VsZi5ub2RlKS5hdXRvUmV0YWluKCkKCiAgICAgICAgaWYgZHJvcHBpbmdCb21iOgogICAgICAgICAgICBzZWxmLmJvbWJDb3VudCAtPSAxCiAgICAgICAgICAgIGJvbWIubm9kZS5hZGREZWF0aEFjdGlvbihicy5XZWFrQ2FsbChzZWxmLmhhbmRsZU1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfQm9tYkRpZWRNZXNzYWdlKCkpKQogICAgICAgIHNlbGYuX3BpY2tVcChib21iLm5vZGUpCgogICAgICAgIGZvciBjIGluIHNlbGYuX2Ryb3BwZWRCb21iQ2FsbGJhY2tzOiBjKHNlbGYsIGJvbWIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGJvbWIKCiAgICBkZWYgX3BpY2tVcChzZWxmLCBub2RlKToKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCkgYW5kIG5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5ob2xkQm9keSA9IDAgIyBuZWVkcyB0byBiZSBzZXQgYmVmb3JlIGhvbGROb2RlCiAgICAgICAgICAgIHNlbGYubm9kZS5ob2xkTm9kZSA9IG5vZGUKICAgICAgICAKICAgIGRlZiBzZXRMYW5kTWluZUNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmxhbmRNaW5lQ291bnQgPSBjb3VudAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi5sYW5kTWluZUNvdW50ICE9IDA6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAneCcrc3RyKHNlbGYubGFuZE1pbmVDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleExhbmRNaW5lcwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycKICAgICAgICAgICAgICAgIAogICAgZGVmIHNldHN0aWNreUljZUNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnN0aWNreUljZUNvdW50ID0gY291bnQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIGlmIHNlbGYuc3RpY2t5SWNlQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5zdGlja3lJY2VDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleHN0aWNreUljZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycKICAgICAgICAgICAgICAgIAogICAgZGVmIHNldHN0aWNreUljZVRyaW9Db3VudChzZWxmLCBjb3VudCk6CiAgICAgICAgIiIiCiAgICAgICAgU2V0IHRoZSBudW1iZXIgb2YgbGFuZC1taW5lcyB0aGlzIHNwYXogaXMgY2FycnlpbmcuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5zdGlja3lJY2VUcmlvQ291bnQgPSBjb3VudAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi5zdGlja3lJY2VUcmlvQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5zdGlja3lJY2VUcmlvQ291bnQpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhzdGlja3lJY2VUcmlvCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAnJwogICAgICAgICAgICAgICAgCiAgICBkZWYgc2V0a25vY2tCb21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYua25vY2tCb21iQ291bnQgPSBjb3VudAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi5rbm9ja0JvbWJDb3VudCAhPSAwOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJ3gnK3N0cihzZWxmLmtub2NrQm9tYkNvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4a25vY2tCb21iCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAnJwogICAgICAgICAgICAgICAgCiAgICBkZWYgc2V0Y2hhcmFjdGVyQm9tYkNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmNoYXJhY3RlckJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLmNoYXJhY3RlckJvbWJDb3VudCAhPSAwOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJ3gnK3N0cihzZWxmLmNoYXJhY3RlckJvbWJDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleGNoYXJhY3RlckJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnCiAgICAgICAgICAgICAgICAKICAgIGRlZiBzZXRtakJvbWJDb3VudChzZWxmLCBjb3VudCk6CiAgICAgICAgIiIiCiAgICAgICAgU2V0IHRoZSBudW1iZXIgb2YgbGFuZC1taW5lcyB0aGlzIHNwYXogaXMgY2FycnlpbmcuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5takJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLm1qQm9tYkNvdW50ICE9IDA6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAneCcrc3RyKHNlbGYubWpCb21iQ291bnQpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhtakJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnCiAgICAgICAgICAgICAgICAKICAgIGRlZiBzZXRpY3lUcmlvQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYuaWN5VHJpb0NvdW50ID0gY291bnQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIGlmIHNlbGYuaWN5VHJpb0NvdW50ICE9IDA6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAneCcrc3RyKHNlbGYuaWN5VHJpb0NvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4aWN5VHJpbwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycKICAgICAgICAgICAgICAgIAogICAgZGVmIHNldGJvb21Cb21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYuYm9vbUJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLmJvb21Cb21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5ib29tQm9tYkNvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4Ym9vbUJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnCiAgICAgICAgICAgICAgICAKICAgIGRlZiBzZXR0cmlvQm9tYkNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnRyaW9Cb21iQ291bnQgPSBjb3VudAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi50cmlvQm9tYkNvdW50ICE9IDA6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAneCcrc3RyKHNlbGYudHJpb0JvbWJDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleHRyaW9Cb21iCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAnJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgZGVmIHNldHNwZWVkQm9tYkNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnNwZWVkQm9tYkNvdW50ID0gY291bnQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIGlmIHNlbGYuc3BlZWRCb21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5zcGVlZEJvbWJDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleHNwZWVkQm9tYgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycKICAgICAgICAgICAgICAgIAogICAgZGVmIHNldGhlYWxCb21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYuaGVhbEJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLmhlYWxCb21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5oZWFsQm9tYkNvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4aGVhbEJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnCgogICAgZGVmIHNldGN1cnNlQm9tYkNvdW50KHNlbGYsIGNvdW50KToKICAgICAgICAiIiIKICAgICAgICBTZXQgdGhlIG51bWJlciBvZiBsYW5kLW1pbmVzIHRoaXMgc3BheiBpcyBjYXJyeWluZy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmN1cnNlQm9tYkNvdW50ID0gY291bnQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIGlmIHNlbGYuY3Vyc2VCb21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi5jdXJzZUJvbWJDb3VudCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleGN1cnNlQm9tYgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycKCiAgICBkZWYgc2V0aWNlSW1wYWN0Q291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYuaWNlSW1wYWN0Q291bnQgPSBjb3VudAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgaWYgc2VsZi5pY2VJbXBhY3RDb3VudCAhPSAwOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJ3gnK3N0cihzZWxmLmljZUltcGFjdENvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4aWNlSW1wYWN0CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHQgPSAnJwogICAgICAgICAgICAgICAgCiAgICBkZWYgc2V0dGJvbWJDb3VudChzZWxmLCBjb3VudCk6CiAgICAgICAgIiIiCiAgICAgICAgU2V0IHRoZSBudW1iZXIgb2YgbGFuZC1taW5lcyB0aGlzIHNwYXogaXMgY2FycnlpbmcuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi50Ym9tYkNvdW50ID0gY291bnQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIGlmIHNlbGYudGJvbWJDb3VudCAhPSAwOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJ3gnK3N0cihzZWxmLnRib21iQ291bnQpCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuY291bnRlclRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXh0Ym9tYgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0ID0gJycgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgZGVmIHNldGdsdWVib21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYuZ2x1ZWJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLmdsdWVib21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcrJytzdHIoc2VsZi5nbHVlYm9tYkNvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4Z2x1ZWJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnICAgICAgCgogICAgZGVmIHNldHdlZWRib21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICIiIgogICAgICAgIFNldCB0aGUgbnVtYmVyIG9mIGxhbmQtbWluZXMgdGhpcyBzcGF6IGlzIGNhcnJ5aW5nLgogICAgICAgICIiIgogICAgICAgIHNlbGYud2VlZGJvbWJDb3VudCA9IGNvdW50CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBpZiBzZWxmLndlZWRib21iQ291bnQgIT0gMDoKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICd4JytzdHIoc2VsZi53ZWVkYm9tYkNvdW50KQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLmNvdW50ZXJUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4d2VlZGJvbWIKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5jb3VudGVyVGV4dCA9ICcnICAgICAKCiAgICBkZWYgY3Vyc2VFeHBsb2RlKHNlbGYsIHNvdXJjZVBsYXllcj1Ob25lKToKICAgICAgICAiIiIKICAgICAgICBFeHBsb2RlIHRoZSBwb29yIHNwYXogYXMgaGFwcGVucyB3aGVuCiAgICAgICAgYSBjdXJzZSB0aW1lciBydW5zIG91dC4KICAgICAgICAiIiIKCiAgICAgICAgIyBjb252ZXJ0IE5vbmUgdG8gYW4gZW1wdHkgcGxheWVyLXJlZgogICAgICAgIGlmIHNvdXJjZVBsYXllciBpcyBOb25lOiBzb3VyY2VQbGF5ZXIgPSBicy5QbGF5ZXIoTm9uZSkKICAgICAgICAKICAgICAgICBpZiBzZWxmLl9jdXJzZWQgYW5kIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5zaGF0dGVyKGV4dHJlbWU9VHJ1ZSkKICAgICAgICAgICAgc2VsZi5oYW5kbGVNZXNzYWdlKGJzLkRpZU1lc3NhZ2UoKSkKICAgICAgICAgICAgYWN0aXZpdHkgPSBzZWxmLl9hY3Rpdml0eSgpCiAgICAgICAgICAgIGlmIGFjdGl2aXR5OgogICAgICAgICAgICAgICAgYnMuQmxhc3QocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk9c2VsZi5ub2RlLnZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgYmxhc3RSYWRpdXM9My4wLCBibGFzdFR5cGU9J25vcm1hbCcsCiAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VQbGF5ZXI9KHNvdXJjZVBsYXllciBpZiBzb3VyY2VQbGF5ZXIuZXhpc3RzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBzZWxmLnNvdXJjZVBsYXllcikpLmF1dG9SZXRhaW4oKQogICAgICAgICAgICBzZWxmLl9jdXJzZWQgPSBGYWxzZQoKICAgIGRlZiBzaGF0dGVyKHNlbGYsIGV4dHJlbWU9RmFsc2UpOgogICAgICAgICIiIgogICAgICAgIEJyZWFrIHRoZSBwb29yIHNwYXogaW50byBsaXR0bGUgYml0cy4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLnNoYXR0ZXJlZDogcmV0dXJuCiAgICAgICAgc2VsZi5zaGF0dGVyZWQgPSBUcnVlCiAgICAgICAgaWYgc2VsZi5mcm96ZW46CiAgICAgICAgICAgICMgbW9tZW50YXJ5IGZsYXNoIG9mIGxpZ2h0CiAgICAgICAgICAgIGxpZ2h0ID0gYnMubmV3Tm9kZSgnbGlnaHQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM9eydwb3NpdGlvbic6c2VsZi5ub2RlLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyYWRpdXMnOjAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0QXR0ZW51YXRlZCc6RmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbG9yJzogKDAuOCwgMC44LCAxLjApfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGJzLmFuaW1hdGUobGlnaHQsICdpbnRlbnNpdHknLCB7MDozLjAsIDQwOjAuNSwgODA6MC4wNywgMzAwOjB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoMzAwLCBsaWdodC5kZWxldGUpCiAgICAgICAgICAgICMgZW1pdCBpY2UgY2h1bmtzLi4KICAgICAgICAgICAgYnMuZW1pdEJHRHluYW1pY3MocG9zaXRpb249c2VsZi5ub2RlLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eT1zZWxmLm5vZGUudmVsb2NpdHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50PWludChyYW5kb20ucmFuZG9tKCkqMTAuMCsxMC4wKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGU9MC42LCBzcHJlYWQ9MC4yLCBjaHVua1R5cGU9J2ljZScpOwogICAgICAgICAgICBicy5lbWl0QkdEeW5hbWljcyhwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5PXNlbGYubm9kZS52ZWxvY2l0eSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ9aW50KHJhbmRvbS5yYW5kb20oKSoxMC4wKzEwLjApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZT0wLjMsIHNwcmVhZD0wLjIsIGNodW5rVHlwZT0naWNlJyk7CgogICAgICAgICAgICBicy5wbGF5U291bmQoc2VsZi5nZXRGYWN0b3J5KCkuc2hhdHRlclNvdW5kLCAxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnMucGxheVNvdW5kKHNlbGYuZ2V0RmFjdG9yeSgpLnNwbGF0dGVyU291bmQsIDEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UoYnMuRGllTWVzc2FnZSgpKQogICAgICAgIHNlbGYubm9kZS5zaGF0dGVyZWQgPSAyIGlmIGV4dHJlbWUgZWxzZSAxCgogICAgZGVmIF9oaXRTZWxmKHNlbGYsIGludGVuc2l0eSk6CgogICAgICAgICMgY2xlYW4gZXhpdCBpZiB3ZSdyZSBkZWFkLi4KICAgICAgICB0cnk6IHBvcyA9IHNlbGYubm9kZS5wb3NpdGlvbgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246IHJldHVybgoKICAgICAgICBzZWxmLmhhbmRsZU1lc3NhZ2UoYnMuSGl0TWVzc2FnZShmbGF0RGFtYWdlPTUwLjAqaW50ZW5zaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcz1wb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VEaXJlY3Rpb249c2VsZi5ub2RlLnZlbG9jaXR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpdFR5cGU9J2ltcGFjdCcpKQogICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJrbm9ja291dCIsIG1heCgwLjAsIDUwLjAqaW50ZW5zaXR5KSkKICAgICAgICBpZiBpbnRlbnNpdHkgPiA1OiBzb3VuZHMgPSBzZWxmLmdldEZhY3RvcnkoKS5pbXBhY3RTb3VuZHNIYXJkZXIKICAgICAgICBlbGlmIGludGVuc2l0eSA+IDM6IHNvdW5kcyA9IHNlbGYuZ2V0RmFjdG9yeSgpLmltcGFjdFNvdW5kc0hhcmQKICAgICAgICBlbHNlOiBzb3VuZHMgPSBzZWxmLmdldEZhY3RvcnkoKS5pbXBhY3RTb3VuZHNNZWRpdW0KICAgICAgICBzID0gc291bmRzW3JhbmRvbS5yYW5kcmFuZ2UobGVuKHNvdW5kcykpXQogICAgICAgIGJzLnBsYXlTb3VuZChzLCBwb3NpdGlvbj1wb3MsIHZvbHVtZT01LjApCiAgICAgICAgCiAgICBkZWYgX2dldEJvbWJUeXBlVGV4KHNlbGYpOgogICAgICAgIGJvbWJGYWN0b3J5ID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkKICAgICAgICBpZiBzZWxmLmJvbWJUeXBlID09ICdzdGlja3knOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4U3RpY2t5Qm9tYnMKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ljZSc6IHJldHVybiBib21iRmFjdG9yeS50ZXhJY2VCb21icwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndHJpb0JvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4dHJpb0JvbWIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ2ltcGFjdCc6IHJldHVybiBib21iRmFjdG9yeS50ZXhJbXBhY3RCb21icwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAna2lsbExhS2lsbCc6IHJldHVybiBicy5nZXRUZXh0dXJlKCdibGFjaycpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdxcSc6IHJldHVybiBicy5nZXRUZXh0dXJlKCdlZ2dUZXgzJykKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3RwJzogcmV0dXJuIGJzLmdldFRleHR1cmUoJ2JvbWJTdGlja3lDb2xvcicpCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdmaXJld29yayc6IHJldHVybiBicy5nZXRUZXh0dXJlKCdlZ2dUZXgxJykKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3BvaXNvbic6IHJldHVybiBicy5nZXRUZXh0dXJlKCdlZ2dUZXgyJykgIyBvdXIgbmV3IHRleHR1cmVzCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdiYWxsb24nOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4QmFsbG9uCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdpY2VJbXBhY3QnOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4aWNlSW1wYWN0CiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICd0Ym9tYic6IHJldHVybiBib21iRmFjdG9yeS50ZXh0Ym9tYgogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnZ2x1ZWJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4Z2x1ZWJvbWIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3dlZWRib21iJzogcmV0dXJuIGJvbWJGYWN0b3J5LnRleHdlZWRib21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGF6Qm9tYic6IHJldHVybiBib21iRmFjdG9yeS50ZXhTcGF6Qm9tYgogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnY2hhcmFjdGVyQm9tYic6IHJldHVybiBib21iRmFjdG9yeS50ZXhDaGFyYWN0ZXJCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdtakJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4TUpCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdjdXJzZUJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4Y3Vyc2VCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdzcGVlZEJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4U3BlZWRCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdrbm9ja0JvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4S25vY2tCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICduaWdodEJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4TmlnaHRCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdibGFzdEJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4Ymxhc3RCb21iCiAgICAgICAgZWxpZiBzZWxmLmJvbWJUeXBlID09ICdyZXZlbmdlQm9tYic6IHJldHVybiBib21iRmFjdG9yeS50ZXhyZXZlbmdlQm9tYgogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnaGVhbEJvbWInOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4SGVhbEJvbWIKICAgICAgICBlbGlmIHNlbGYuYm9tYlR5cGUgPT0gJ3N0aWNreUljZSc6IHJldHVybiBib21iRmFjdG9yeS50ZXhTdGlja3lJY2VCb21icwogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAndXNlJzogcmV0dXJuIGJvbWJGYWN0b3J5LnRleHVzZQogICAgICAgIGVsaWYgc2VsZi5ib21iVHlwZSA9PSAnYW50aUdyYXYnOiByZXR1cm4gYm9tYkZhY3RvcnkudGV4QW50aUdyYXYKICAgICAgICBlbHNlOiByZXR1cm4gYnMuZ2V0VGV4dHVyZSgnbnVsbCcpCiAgICAgICAgCiAgICBkZWYgX2ZsYXNoQmlsbGJvYXJkKHNlbGYsIHRleCk6CiAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZFRleHR1cmUgPSB0ZXgKICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkQ3Jvc3NPdXQgPSBGYWxzZQogICAgICAgIGJzLmFuaW1hdGUoc2VsZi5ub2RlLCAiYmlsbGJvYXJkT3BhY2l0eSIsCiAgICAgICAgICAgICAgICAgICB7MDowLjAsIDEwMDoxLjAsIDQwMDoxLjAsIDUwMDowLjB9KQoKICAgIGRlZiBzZXRCb21iQ291bnQoc2VsZiwgY291bnQpOgogICAgICAgICdTZXRzIHRoZSBudW1iZXIgb2YgYm9tYnMgdGhpcyBTcGF6IGhhcy4nCiAgICAgICAgIyB3ZSBjYW50IGp1c3Qgc2V0IGJvbWJDb3VudCBjdXogc29tZSBib21icyBtYXkgYmUgbGFpZCBjdXJyZW50bHkKICAgICAgICAjIHNvIHdlIGhhdmUgdG8gZG8gYSByZWxhdGl2ZSBkaWZmIGJhc2VkIG9uIG1heAogICAgICAgIGRpZmYgPSBjb3VudCAtIHNlbGYuX21heEJvbWJDb3VudAogICAgICAgIHNlbGYuX21heEJvbWJDb3VudCArPSBkaWZmCiAgICAgICAgc2VsZi5ib21iQ291bnQgKz0gZGlmZgoKICAgIGRlZiBfZ2xvdmVzV2Vhck9mZkZsYXNoKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJveGluZ0dsb3Zlc0ZsYXNoaW5nID0gMQogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleFB1bmNoCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMS4wCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRDcm9zc091dCA9IFRydWUKCiAgICBkZWYgX2dsb3Zlc1dlYXJPZmYoc2VsZik6CiAgICAgICAgaWYgc2VsZi5fZGVtb01vZGU6ICMgcHJlc2VydmUgb2xkIGJlaGF2aW9yCiAgICAgICAgICAgIHNlbGYuX3B1bmNoUG93ZXJTY2FsZSA9IGdCYXNlUHVuY2hQb3dlclNjYWxlCiAgICAgICAgICAgIHNlbGYuX3B1bmNoQ29vbGRvd24gPSBnQmFzZVB1bmNoQ29vbGRvd24KICAgICAgICBlbHNlOgogICAgICAgICAgICBmYWN0b3J5ID0gc2VsZi5nZXRGYWN0b3J5KCkKICAgICAgICAgICAgc2VsZi5fcHVuY2hQb3dlclNjYWxlID0gZmFjdG9yeS5wdW5jaFBvd2VyU2NhbGUKICAgICAgICAgICAgc2VsZi5fcHVuY2hDb29sZG93biA9IGZhY3RvcnkucHVuY2hDb29sZG93bgogICAgICAgIHNlbGYuX2hhc0JveGluZ0dsb3ZlcyA9IEZhbHNlCiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBicy5wbGF5U291bmQoYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkucG93ZXJkb3duU291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgIHNlbGYubm9kZS5ib3hpbmdHbG92ZXMgPSAwCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wCgogICAgZGVmIF9tdWx0aUJvbWJXZWFyT2ZmRmxhc2goc2VsZik6CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleEJvbWIKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAxLjAKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZENyb3NzT3V0ID0gVHJ1ZQoKICAgIGRlZiBfbXVsdGlCb21iV2Vhck9mZihzZWxmKToKICAgICAgICBzZWxmLnNldEJvbWJDb3VudChzZWxmLmRlZmF1bHRCb21iQ291bnQpCiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBicy5wbGF5U291bmQoYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkucG93ZXJkb3duU291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wCgogICAgZGVmIF91bmJyZWFrYWJsZVdlYXJPZmZGbGFzaChzZWxmKToKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4VW5iCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMS4wCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRDcm9zc091dCA9IFRydWUKCiAgICBkZWYgX3VuYnJlYWthYmxlV2Vhck9mZihzZWxmKToKICAgICAgICBzZWxmLnVuYnJlYWthYmxlPUZhbHNlCiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBicy5wbGF5U291bmQoYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkucG93ZXJkb3duU291bmQsIHBvc2l0aW9uPXNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAwLjAKCiAgICBkZWYgX2JvbWJXZWFyT2ZmRmxhc2goc2VsZik6CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkVGV4dHVyZSA9IHNlbGYuX2dldEJvbWJUeXBlVGV4KCkKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAxLjAKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZENyb3NzT3V0ID0gVHJ1ZQoKICAgIGRlZiBfYm9tYldlYXJPZmYoc2VsZik6CiAgICAgICAgc2VsZi5ib21iVHlwZSA9IHNlbGYuYm9tYlR5cGVEZWZhdWx0CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBicy5wbGF5U291bmQoYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkucG93ZXJkb3duU291bmQsCiAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbj1zZWxmLm5vZGUucG9zaXRpb24pCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wCiAgICAgICAgICAgIAogI3RoZSBuZXcgcG93ZXJ1cHcgICAgICAgIAogICAgZGVmIF9pbnZpc2liaWxpdHlXZWFyT2ZmRmxhc2goc2VsZik6CiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkVGV4dHVyZSA9IGJzLlBvd2VydXAuZ2V0RmFjdG9yeSgpLnRleEludmlzaWJpbGl0eQogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkT3BhY2l0eSA9IDEuMAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkQ3Jvc3NPdXQgPSBUcnVlCgogICAgZGVmIF9pbnZpc2liaWxpdHlXZWFyT2ZmKHNlbGYpOgogICAgICAgIGZhY3RvcnkgPSBzZWxmLmdldEZhY3RvcnkoKQogICAgICAgIHNlbGYubm9kZS5zdHlsZSA9IHNlbGYuX3N0eWxlCiAgICAgICAgc2VsZi5ub2RlLm5hbWUgPSBzZWxmLl9uYW1lCiAgICAgICAgc2VsZi5ub2RlLmhlYWRNb2RlbCA9IHNlbGYuX2hlYWQKICAgICAgICBzZWxmLm5vZGUudG9yc29Nb2RlbCA9IHNlbGYuX3RvcnNvCiAgICAgICAgc2VsZi5ub2RlLnBlbHZpc01vZGVsID0gc2VsZi5fcGVsdmlzCiAgICAgICAgc2VsZi5ub2RlLnVwcGVyQXJtTW9kZWwgPSBzZWxmLl91cHBlckFybQogICAgICAgIHNlbGYubm9kZS5mb3JlQXJtTW9kZWwgPSBzZWxmLl9mb3JlQXJtCiAgICAgICAgc2VsZi5ub2RlLmhhbmRNb2RlbCA9IHNlbGYuX2hhbmQKICAgICAgICBzZWxmLm5vZGUudXBwZXJMZWdNb2RlbCA9IHNlbGYuX3VwcGVyTGVnCiAgICAgICAgc2VsZi5ub2RlLmxvd2VyTGVnTW9kZWwgPSBzZWxmLl9sb3dlckxlZwogICAgICAgIHNlbGYubm9kZS50b2VzTW9kZWwgPSBzZWxmLl90b2VzCiAgICAgICAgaWYgc2VsZi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkT3BhY2l0eSA9IDAuMCAgIAogICAgICAgICAgICAKICAgIGRlZiBfaGlqdW1wV2Vhck9mZkZsYXNoKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZFRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhIaUp1bXAKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAxLjAKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZENyb3NzT3V0ID0gVHJ1ZQogICAgICAgICAgICAKICAgIGRlZiBfaGlqdW1wV2Vhck9mZihzZWxmKToKICAgIAlwbGF5ZXIgPSBzZWxmLmdldFBsYXllcigpCiAgICAJcGxheWVyLmFzc2lnbklucHV0Q2FsbCgnanVtcFByZXNzJywgc2VsZi5vbkp1bXBQcmVzcykKICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdqdW1wUmVsZWFzZScsIHNlbGYub25KdW1wUmVsZWFzZSkKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wICAgICAgCiAgICAgICAgICAgIAogICAgZGVmIF9qdW1wRmx5V2Vhck9mZkZsYXNoKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZFRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhqdW1wRmx5CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMS4wCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRDcm9zc091dCA9IFRydWUKICAgICAgICAgICAgCiAgICBkZWYgX2p1bXBGbHlXZWFyT2ZmKHNlbGYpOgogICAgCXBsYXllciA9IHNlbGYuZ2V0UGxheWVyKCkKICAgIAlwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdqdW1wUHJlc3MnLCBzZWxmLm9uSnVtcFByZXNzKQogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAwLjAgICAgICAKICAgICAgICAgICAgCiAgICBkZWYgX3JhZGl1c1dlYXJPZmZGbGFzaChzZWxmKToKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRUZXh0dXJlID0gYnMuUG93ZXJ1cC5nZXRGYWN0b3J5KCkudGV4UmFkaXVzCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMS4wCiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRDcm9zc091dCA9IFRydWUKICAgICAgICAgICAgCiAgICBkZWYgX3JhZGl1c1dlYXJPZmYoc2VsZik6CiAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgc2VsZi5ibGFzdFJhZGl1cyA9IDIuMAogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAwLjAKICAgICAgICAgICAgCiAgICBkZWYgX3NsZWVwV2Vhck9mZkZsYXNoKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZFRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhTbGVlcAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkT3BhY2l0eSA9IDEuMAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkQ3Jvc3NPdXQgPSBUcnVlCiAgICAgICAgICAgIAogICAgZGVmIF9zbGVlcFdlYXJPZmYoc2VsZik6CiAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgc2VsZi5mcm96ZW4gPSBGYWxzZQogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZE9wYWNpdHkgPSAwLjAKICAgICAgICAgICAgCiAgICBkZWYgX25pZ2h0V2Vhck9mZkZsYXNoKHNlbGYpOgogICAgICAgIGlmIHNlbGYubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5ub2RlLmJpbGxib2FyZFRleHR1cmUgPSBicy5Qb3dlcnVwLmdldEZhY3RvcnkoKS50ZXhOaWdodAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkT3BhY2l0eSA9IDEuMAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkQ3Jvc3NPdXQgPSBUcnVlCiAgICAgICAgICAgIAogICAgZGVmIF9uaWdodFdlYXJPZmYoc2VsZik6CiAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgYnMuZ2V0U2hhcmVkT2JqZWN0KCdnbG9iYWxzJykudGludCA9ICgxLjEsIDEuMSwgMS4wKQogICAgICAgIHQgPSBicy5wbGF5U291bmQoYnMuZ2V0U291bmQoJ21vcm5pbmcnKSkKICAgICAgICB0ID0gYnMuc2NyZWVuTWVzc2FnZSgiIU1vcm5pbmchIiwgY29sb3I9KDAsIDAuNSwgMC44KSkKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wCiAgICAgICAgICAgIAogICAgZGVmIF9zcGF6Qm9tYldlYXJPZmZGbGFzaChzZWxmKToKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRUZXh0dXJlID0gc2VsZi5fZ2V0Qm9tYlR5cGVUZXgoKQogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkT3BhY2l0eSA9IDEuMAogICAgICAgICAgICBzZWxmLm5vZGUuYmlsbGJvYXJkQ3Jvc3NPdXQgPSBUcnVlCiAgICAgICAgICAgIAogICAgZGVmIF9zcGF6Qm9tYldlYXJPZmYoc2VsZik6CiAgICAgICAgZmFjdG9yeSA9IHNlbGYuZ2V0RmFjdG9yeSgpCiAgICAgICAgc2VsZi5ib21iQ291bnQgPSBzZWxmLmRlZmF1bHRCb21iQ291bnQKICAgICAgICBzZWxmLmJvbWJUeXBlID0gc2VsZi5ib21iVHlwZURlZmF1bHQKICAgICAgICBpZiBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubm9kZS5iaWxsYm9hcmRPcGFjaXR5ID0gMC4wCgoKY2xhc3MgUGxheWVyU3BhekRlYXRoTWVzc2FnZShvYmplY3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogTWVzc2FnZSBDbGFzc2VzCgogICAgQSBicy5QbGF5ZXJTcGF6IGhhcyBkaWVkLgoKICAgIEF0dHJpYnV0ZXM6CgogICAgICAgc3BhegogICAgICAgICAgVGhlIGJzLlBsYXllclNwYXogdGhhdCBkaWVkLgoKICAgICAgIGtpbGxlZAogICAgICAgICAgSWYgVHJ1ZSwgdGhlIHNwYXogd2FzIGtpbGxlZDsKICAgICAgICAgIElmIEZhbHNlLCB0aGV5IGxlZnQgdGhlIGdhbWUgb3IgdGhlIHJvdW5kIGVuZGVkLgoKICAgICAgIGtpbGxlclBsYXllcgogICAgICAgICAgVGhlIGJzLlBsYXllciB0aGF0IGRpZCB0aGUga2lsbGluZywgb3IgTm9uZS4KCiAgICAgICBob3cKICAgICAgICAgIFRoZSBwYXJ0aWN1bGFyIHR5cGUgb2YgZGVhdGguCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzcGF6LCB3YXNLaWxsZWQsIGtpbGxlclBsYXllciwgaG93KToKICAgICAgICAiIiIKICAgICAgICBJbnN0YW50aWF0ZSBhIG1lc3NhZ2Ugd2l0aCB0aGUgZ2l2ZW4gdmFsdWVzLgogICAgICAgICIiIgogICAgICAgIHNlbGYuc3BheiA9IHNwYXoKICAgICAgICBzZWxmLmtpbGxlZCA9IHdhc0tpbGxlZAogICAgICAgIHNlbGYua2lsbGVyUGxheWVyID0ga2lsbGVyUGxheWVyCiAgICAgICAgc2VsZi5ob3cgPSBob3cKICAgICAgICAKCmNsYXNzIFBsYXllclNwYXpIdXJ0TWVzc2FnZShvYmplY3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogTWVzc2FnZSBDbGFzc2VzCgogICAgQSBicy5QbGF5ZXJTcGF6IHdhcyBodXJ0LgoKICAgIEF0dHJpYnV0ZXM6CgogICAgICAgc3BhegogICAgICAgICAgVGhlIGJzLlBsYXllclNwYXogdGhhdCB3YXMgaHVydAogICAgIiIiCiAgICBkZWYgX19pbml0X18oc2VsZiwgc3Bheik6CiAgICAgICAgIiIiCiAgICAgICAgSW5zdGFudGlhdGUgd2l0aCB0aGUgZ2l2ZW4gYnMuU3BheiB2YWx1ZS4KICAgICAgICAiIiIKICAgICAgICBzZWxmLnNwYXogPSBzcGF6CgoKY2xhc3MgUGxheWVyU3BheihTcGF6KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEdhbWUgRmxvdyBDbGFzc2VzCiAgICAKICAgIEEgYnMuU3BheiBzdWJjbGFzcyBtZWFudCB0byBiZSBjb250cm9sbGVkIGJ5IGEgYnMuUGxheWVyLgoKICAgIFdoZW4gYSBQbGF5ZXJTcGF6IGRpZXMsIGl0IGRlbGl2ZXJzIGEgYnMuUGxheWVyU3BhekRlYXRoTWVzc2FnZQogICAgdG8gdGhlIGN1cnJlbnQgYnMuQWN0aXZpdHkuICh1bmxlc3MgdGhlIGRlYXRoIHdhcyB0aGUgcmVzdWx0IG9mIHRoZQogICAgcGxheWVyIGxlYXZpbmcgdGhlIGdhbWUsIGluIHdoaWNoIGNhc2Ugbm8gbWVzc2FnZSBpcyBzZW50KQoKICAgIFdoZW4gYSBQbGF5ZXJTcGF6IGlzIGh1cnQsIGl0IGRlbGl2ZXJzIGEgYnMuUGxheWVyU3Bhekh1cnRNZXNzYWdlCiAgICB0byB0aGUgY3VycmVudCBicy5BY3Rpdml0eS4KICAgICIiIgoKCiAgICBkZWYgX19pbml0X18oc2VsZiwgY29sb3I9KDEsIDEsIDEpLCBoaWdobGlnaHQ9KDAuNSwgMC41LCAwLjUpLAogICAgICAgICAgICAgICAgIGNoYXJhY3Rlcj0iU3BheiIsIHBsYXllcj1Ob25lLCBwb3dlcnVwc0V4cGlyZT1UcnVlKToKCiAgICAgICAgIyBjb252ZXJ0IE5vbmUgdG8gYW4gZW1wdHkgcGxheWVyLXJlZgogICAgICAgIGlmIHBsYXllciBpcyBOb25lOiBwbGF5ZXIgPSBicy5QbGF5ZXIoTm9uZSkKICAgICAgICBTcGF6Ll9faW5pdF9fKHNlbGYsIGNvbG9yPWNvbG9yLCBoaWdobGlnaHQ9aGlnaGxpZ2h0LAogICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyPWNoYXJhY3Rlciwgc291cmNlUGxheWVyPXBsYXllciwKICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0SW52aW5jaWJsZT1UcnVlLCBwb3dlcnVwc0V4cGlyZT1wb3dlcnVwc0V4cGlyZSkKICAgICAgICBzZWxmLmxhc3RQbGF5ZXJBdHRhY2tlZEJ5ID0gTm9uZSAjIEZJWE1FIC0gc2hvdWxkIHVzZSBlbXB0eSBwbGF5ZXIgcmVmCiAgICAgICAgc2VsZi5sYXN0QXR0YWNrZWRUaW1lID0gMAogICAgICAgIHNlbGYubGFzdEF0dGFja2VkVHlwZSA9IE5vbmUKICAgICAgICBzZWxmLmhlbGRDb3VudCA9IDAKICAgICAgICBzZWxmLmxhc3RQbGF5ZXJIZWxkQnkgPSBOb25lICMgRklYTUUgLSBzaG91bGQgdXNlIGVtcHR5IHBsYXllciByZWYgaGVyZQogICAgICAgIHNlbGYuX3BsYXllciA9IHBsYXllcgoKICAgICAgICAjIGdyYWIgdGhlIG5vZGUgZm9yIHRoaXMgcGxheWVyIGFuZCB3aXJlIGl0IHRvIGZvbGxvdyBvdXIgc3BhegogICAgICAgICMgKHNvIHBsYXllcnMnIGNvbnRyb2xsZXJzIGtub3cgd2hlcmUgdG8gZHJhdyB0aGVpciBndWlkZXMsIGV0YykKICAgICAgICBpZiBwbGF5ZXIuZXhpc3RzKCk6CiAgICAgICAgICAgIHBsYXllck5vZGUgPSBicy5nZXRBY3Rpdml0eSgpLl9nZXRQbGF5ZXJOb2RlKHBsYXllcikKICAgICAgICAgICAgc2VsZi5ub2RlLmNvbm5lY3RBdHRyKCd0b3Jzb1Bvc2l0aW9uJywgcGxheWVyTm9kZSwgJ3Bvc2l0aW9uJykKCiAgICBkZWYgX19zdXBlckhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKToKICAgICAgICBzdXBlcihQbGF5ZXJTcGF6LCBzZWxmKS5oYW5kbGVNZXNzYWdlKG1zZykKICAgICAgICAKICAgIGRlZiBnZXRQbGF5ZXIoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJuIHRoZSBicy5QbGF5ZXIgYXNzb2NpYXRlZCB3aXRoIHRoaXMgc3Bhei4KICAgICAgICBOb3RlIHRoYXQgd2hpbGUgYSB2YWxpZCBwbGF5ZXIgb2JqZWN0IHdpbGwgYWx3YXlzIGJlCiAgICAgICAgcmV0dXJuZWQsIHRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGF0IHRoZSBwbGF5ZXIgaXMgc3RpbGwKICAgICAgICBpbiB0aGUgZ2FtZS4gIENhbGwgYnMuUGxheWVyLmV4aXN0cygpIG9uIHRoZSByZXR1cm4gdmFsdWUKICAgICAgICBiZWZvcmUgZG9pbmcgYW55dGhpbmcgd2l0aCBpdC4KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZi5fcGxheWVyCgogICAgZGVmIGNvbm5lY3RDb250cm9sc1RvUGxheWVyKHNlbGYsIGVuYWJsZUp1bXA9VHJ1ZSwgZW5hYmxlUHVuY2g9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVQaWNrVXA9VHJ1ZSwgZW5hYmxlQm9tYj1UcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZVJ1bj1UcnVlLCBlbmFibGVGbHk9VHJ1ZSk6CiAgICAgICAgIiIiCiAgICAgICAgV2lyZSB0aGlzIHNwYXogdXAgdG8gdGhlIHByb3ZpZGVkIGJzLlBsYXllci4KICAgICAgICBGdWxsIGNvbnRyb2wgb2YgdGhlIGNoYXJhY3RlciBpcyBnaXZlbiBieSBkZWZhdWx0CiAgICAgICAgYnV0IGNhbiBiZSBzZWxlY3RpdmVseSBsaW1pdGVkIGJ5IHBhc3NpbmcgRmFsc2UKICAgICAgICB0byBzcGVjaWZpYyBhcmd1bWVudHMuCiAgICAgICAgIiIiCiAgICAgICAgcGxheWVyID0gc2VsZi5nZXRQbGF5ZXIoKQogICAgICAgICMgcmVzZXQgYW55IGN1cnJlbnRseSBjb25uZWN0ZWQgcGxheWVyIGFuZC9vciB0aGUgcGxheWVyIHdlJ3JlIHdpcmluZyB1cAogICAgICAgIGlmIHNlbGYuX2Nvbm5lY3RlZFRvUGxheWVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBpZiBwbGF5ZXIgIT0gc2VsZi5fY29ubmVjdGVkVG9QbGF5ZXI6IHBsYXllci5yZXNldElucHV0KCkKICAgICAgICAgICAgc2VsZi5kaXNjb25uZWN0Q29udHJvbHNGcm9tUGxheWVyKCkKICAgICAgICBlbHNlOiBwbGF5ZXIucmVzZXRJbnB1dCgpCgogICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ3VwRG93bicsIHNlbGYub25Nb3ZlVXBEb3duKQogICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2xlZnRSaWdodCcsIHNlbGYub25Nb3ZlTGVmdFJpZ2h0KQogICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2hvbGRQb3NpdGlvblByZXNzJywgc2VsZi5fb25Ib2xkUG9zaXRpb25QcmVzcykKICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdob2xkUG9zaXRpb25SZWxlYXNlJyxzZWxmLl9vbkhvbGRQb3NpdGlvblJlbGVhc2UpCgogICAgICAgIGlmIGVuYWJsZUp1bXA6CiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2p1bXBQcmVzcycsIHNlbGYub25KdW1wUHJlc3MpCiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2p1bXBSZWxlYXNlJywgc2VsZi5vbkp1bXBSZWxlYXNlKQogICAgICAgIGlmIGVuYWJsZVBpY2tVcDoKICAgICAgICAgICAgcGxheWVyLmFzc2lnbklucHV0Q2FsbCgncGlja1VwUHJlc3MnLCBzZWxmLm9uUGlja1VwUHJlc3MpCiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ3BpY2tVcFJlbGVhc2UnLCBzZWxmLm9uUGlja1VwUmVsZWFzZSkKICAgICAgICBpZiBlbmFibGVQdW5jaDoKICAgICAgICAgICAgcGxheWVyLmFzc2lnbklucHV0Q2FsbCgncHVuY2hQcmVzcycsIHNlbGYub25QdW5jaFByZXNzKQogICAgICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdwdW5jaFJlbGVhc2UnLCBzZWxmLm9uUHVuY2hSZWxlYXNlKQogICAgICAgIGlmIGVuYWJsZUJvbWI6CiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2JvbWJQcmVzcycsIHNlbGYub25Cb21iUHJlc3MpCiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2JvbWJSZWxlYXNlJywgc2VsZi5vbkJvbWJSZWxlYXNlKQogICAgICAgIGlmIGVuYWJsZVJ1bjoKICAgICAgICAgICAgcGxheWVyLmFzc2lnbklucHV0Q2FsbCgncnVuJywgc2VsZi5vblJ1bikKICAgICAgICBpZiBlbmFibGVGbHk6CiAgICAgICAgICAgIHBsYXllci5hc3NpZ25JbnB1dENhbGwoJ2ZseVByZXNzJywgc2VsZi5vbkZseVByZXNzKQogICAgICAgICAgICBwbGF5ZXIuYXNzaWduSW5wdXRDYWxsKCdmbHlSZWxlYXNlJywgc2VsZi5vbkZseVJlbGVhc2UpCgogICAgICAgIHNlbGYuX2Nvbm5lY3RlZFRvUGxheWVyID0gcGxheWVyCgogICAgICAgIAogICAgZGVmIGRpc2Nvbm5lY3RDb250cm9sc0Zyb21QbGF5ZXIoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgQ29tcGxldGVseSBzZXZlciBhbnkgcHJldmlvdXNseSBjb25uZWN0ZWQKICAgICAgICBicy5QbGF5ZXIgZnJvbSBjb250cm9sIG9mIHRoaXMgc3Bhei4KICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLl9jb25uZWN0ZWRUb1BsYXllciBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5fY29ubmVjdGVkVG9QbGF5ZXIucmVzZXRJbnB1dCgpCiAgICAgICAgICAgIHNlbGYuX2Nvbm5lY3RlZFRvUGxheWVyID0gTm9uZQogICAgICAgICAgICAjIHNlbmQgcmVsZWFzZXMgZm9yIGFueXRoaW5nIGluIGNhc2UgaXRzIGhlbGQuLgogICAgICAgICAgICBzZWxmLm9uTW92ZVVwRG93bigwKQogICAgICAgICAgICBzZWxmLm9uTW92ZUxlZnRSaWdodCgwKQogICAgICAgICAgICBzZWxmLl9vbkhvbGRQb3NpdGlvblJlbGVhc2UoKQogICAgICAgICAgICBzZWxmLm9uSnVtcFJlbGVhc2UoKQogICAgICAgICAgICBzZWxmLm9uUGlja1VwUmVsZWFzZSgpCiAgICAgICAgICAgIHNlbGYub25QdW5jaFJlbGVhc2UoKQogICAgICAgICAgICBzZWxmLm9uQm9tYlJlbGVhc2UoKQogICAgICAgICAgICBzZWxmLm9uUnVuKDAuMCkKICAgICAgICAgICAgc2VsZi5vbkZseVJlbGVhc2UoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50ICgnV0FSTklORzogZGlzY29ubmVjdENvbnRyb2xzRnJvbVBsYXllcigpIGNhbGxlZCBmb3InCiAgICAgICAgICAgICAgICAgICAnIG5vbi1jb25uZWN0ZWQgcGxheWVyJykKCiAgICBkZWYgaGFuZGxlTWVzc2FnZShzZWxmLCBtc2cpOgogICAgICAgIHNlbGYuX2hhbmRsZU1lc3NhZ2VTYW5pdHlDaGVjaygpCiAgICAgICAgIyBrZWVwIHRyYWNrIG9mIGlmIHdlJ3JlIGJlaW5nIGhlbGQgYW5kIGJ5IHdobyBtb3N0IHJlY2VudGx5CiAgICAgICAgaWYgaXNpbnN0YW5jZShtc2csIGJzLlBpY2tlZFVwTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYuX19zdXBlckhhbmRsZU1lc3NhZ2UobXNnKSAjIGF1Z21lbnQgc3RhbmRhcmQgYmVoYXZpb3IKICAgICAgICAgICAgc2VsZi5oZWxkQ291bnQgKz0gMQogICAgICAgICAgICBwaWNrZWRVcEJ5ID0gbXNnLm5vZGUuc291cmNlUGxheWVyCiAgICAgICAgICAgIGlmIHBpY2tlZFVwQnkgaXMgbm90IE5vbmUgYW5kIHBpY2tlZFVwQnkuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLmxhc3RQbGF5ZXJIZWxkQnkgPSBwaWNrZWRVcEJ5CiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuRHJvcHBlZE1lc3NhZ2UpOgogICAgICAgICAgICBzZWxmLl9fc3VwZXJIYW5kbGVNZXNzYWdlKG1zZykgIyBhdWdtZW50IHN0YW5kYXJkIGJlaGF2aW9yCiAgICAgICAgICAgIHNlbGYuaGVsZENvdW50IC09IDEKICAgICAgICAgICAgaWYgc2VsZi5oZWxkQ291bnQgPCAwOgogICAgICAgICAgICAgICAgcHJpbnQgIkVSUk9SOiBzcGF6IGhlbGRDb3VudCA8IDAiCiAgICAgICAgICAgICMgbGV0J3MgY291bnQgc29tZW9uZSBkcm9wcGluZyB1cyBhcyBhbiBhdHRhY2suLgogICAgICAgICAgICB0cnk6IHBpY2tlZFVwQnkgPSBtc2cubm9kZS5zb3VyY2VQbGF5ZXIKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjogcGlja2VkVXBCeSA9IE5vbmUKICAgICAgICAgICAgaWYgcGlja2VkVXBCeSBpcyBub3QgTm9uZSBhbmQgcGlja2VkVXBCeS5leGlzdHMoKToKICAgICAgICAgICAgICAgIHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkgPSBwaWNrZWRVcEJ5CiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFRpbWUgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFR5cGUgPSAoJ3BpY2tlZFVwJywgJ2RlZmF1bHQnKQogICAgICAgIGVsaWYgaXNpbnN0YW5jZShtc2csIGJzLkRpZU1lc3NhZ2UpOgoKICAgICAgICAgICAgIyByZXBvcnQgcGxheWVyIGRlYXRocyB0byB0aGUgZ2FtZQogICAgICAgICAgICBpZiBub3Qgc2VsZi5fZGVhZDoKCiAgICAgICAgICAgICAgICAjIGltbWVkaWF0ZS1tb2RlIG9yIGxlZnQtZ2FtZSBkZWF0aHMgZG9uJ3QgY291bnQgYXMgJ2tpbGxzJwogICAgICAgICAgICAgICAga2lsbGVkID0gKG1zZy5pbW1lZGlhdGU9PUZhbHNlIGFuZCBtc2cuaG93IT0nbGVmdEdhbWUnKQoKICAgICAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VsZi5fYWN0aXZpdHkoKQoKICAgICAgICAgICAgICAgIGlmIG5vdCBraWxsZWQ6CiAgICAgICAgICAgICAgICAgICAga2lsbGVyUGxheWVyID0gTm9uZQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIGlmIHRoaXMgcGxheWVyIHdhcyBiZWluZyBoZWxkIGF0IHRoZSB0aW1lIG9mIGRlYXRoLAogICAgICAgICAgICAgICAgICAgICMgdGhlIGhvbGRlciBpcyB0aGUga2lsbGVyCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVsZENvdW50ID4gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHNlbGYubGFzdFBsYXllckhlbGRCeSBpcyBub3QgTm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHNlbGYubGFzdFBsYXllckhlbGRCeS5leGlzdHMoKSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGtpbGxlclBsYXllciA9IHNlbGYubGFzdFBsYXllckhlbGRCeQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICMgb3RoZXJ3aXNlLCBpZiB0aGV5IHdlcmUgYXR0YWNrZWQgYnkgc29tZW9uZSBpbiB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgIyBsYXN0IGZldyBzZWNvbmRzLCB0aGF0IHBlcnNvbidzIHRoZSBraWxsZXIuLgogICAgICAgICAgICAgICAgICAgICAgICAjIG90aGVyd2lzZSBpdCB3YXMgYSBzdWljaWRlLgogICAgICAgICAgICAgICAgICAgICAgICAjIEZJWE1FIC0gY3VycmVudGx5IGRpc2FibGluZyBzdWljaWRlcyBpbiBDby1PcCBzaW5jZQogICAgICAgICAgICAgICAgICAgICAgICAjIGFsbCBib3Qga2lsbHMgd291bGQgcmVnaXN0ZXIgYXMgc3VpY2lkZXM7IG5lZWQgdG8KICAgICAgICAgICAgICAgICAgICAgICAgIyBjaGFuZ2UgdGhpcyBmcm9tIGxhc3RQbGF5ZXJBdHRhY2tlZEJ5IHRvIHNvbWV0aGluZwogICAgICAgICAgICAgICAgICAgICAgICAjIGxpa2UgbGFzdEFjdG9yQXR0YWNrZWRCeSB0byBmaXggdGhhdC4KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgc2VsZi5sYXN0UGxheWVyQXR0YWNrZWRCeS5leGlzdHMoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBicy5nZXRHYW1lVGltZSgpIC0gc2VsZi5sYXN0QXR0YWNrZWRUaW1lIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IDQwMDApOgogICAgICAgICAgICAgICAgICAgICAgICAgICAga2lsbGVyUGxheWVyID0gc2VsZi5sYXN0UGxheWVyQXR0YWNrZWRCeQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBvaywgY2FsbCBpdCBhIHN1aWNpZGUgdW5sZXNzIHdlJ3JlIGluIGNvLW9wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZpdHkgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIG5vdCBpc2luc3RhbmNlKGFjdGl2aXR5LmdldFNlc3Npb24oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLkNvb3BTZXNzaW9uKSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2lsbGVyUGxheWVyID0gc2VsZi5nZXRQbGF5ZXIoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraWxsZXJQbGF5ZXIgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGtpbGxlclBsYXllciBpcyBub3QgTm9uZSBhbmQgbm90IGtpbGxlclBsYXllci5leGlzdHMoKToKICAgICAgICAgICAgICAgICAgICBraWxsZXJQbGF5ZXIgPSBOb25lCgogICAgICAgICAgICAgICAgIyBvbmx5IHJlcG9ydCBpZiBib3RoIHRoZSBwbGF5ZXIgYW5kIHRoZSBhY3Rpdml0eSBzdGlsbCBleGlzdAogICAgICAgICAgICAgICAgaWYgKGtpbGxlZCBhbmQgYWN0aXZpdHkgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgICAgICBhbmQgc2VsZi5nZXRQbGF5ZXIoKS5leGlzdHMoKSk6CiAgICAgICAgICAgICAgICAgICAgYWN0aXZpdHkuaGFuZGxlTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgUGxheWVyU3BhekRlYXRoTWVzc2FnZShzZWxmLCBraWxsZWQsIGtpbGxlclBsYXllciwgbXNnLmhvdykpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHNlbGYuX19zdXBlckhhbmRsZU1lc3NhZ2UobXNnKSAjIGF1Z21lbnQgc3RhbmRhcmQgYmVoYXZpb3IKCiAgICAgICAgIyBrZWVwIHRyYWNrIG9mIHRoZSBwbGF5ZXIgd2hvIGxhc3QgaGl0IHVzIGZvciBwb2ludCByZXdhcmRpbmcKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5IaXRNZXNzYWdlKToKICAgICAgICAgICAgaWYgbXNnLnNvdXJjZVBsYXllciBpcyBub3QgTm9uZSBhbmQgbXNnLnNvdXJjZVBsYXllci5leGlzdHMoKToKICAgICAgICAgICAgICAgIHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkgPSBtc2cuc291cmNlUGxheWVyCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFRpbWUgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFR5cGUgPSAobXNnLmhpdFR5cGUsIG1zZy5oaXRTdWJUeXBlKQogICAgICAgICAgICBzZWxmLl9fc3VwZXJIYW5kbGVNZXNzYWdlKG1zZykgIyBhdWdtZW50IHN0YW5kYXJkIGJlaGF2aW9yCiAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VsZi5fYWN0aXZpdHkoKQogICAgICAgICAgICBpZiBhY3Rpdml0eSBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgIGFjdGl2aXR5LmhhbmRsZU1lc3NhZ2UoUGxheWVyU3Bhekh1cnRNZXNzYWdlKHNlbGYpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIFNwYXouaGFuZGxlTWVzc2FnZShzZWxmLCBtc2cpCgoKY2xhc3MgUmVzcGF3bkljb24ob2JqZWN0KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEdhbWUgRmxvdyBDbGFzc2VzCgogICAgQW4gaWNvbiB3aXRoIGEgY291bnRkb3duIHRoYXQgYXBwZWFycyBhbG9uZ3NpZGUgdGhlIHNjcmVlbjsKICAgIHVzZWQgdG8gaW5kaWNhdGUgdGhhdCBhIGJzLlBsYXllciBpcyB3YWl0aW5nIHRvIHJlc3Bhd24uCiAgICAiIiIKICAgIAogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBsYXllciwgcmVzcGF3blRpbWUpOgogICAgICAgICIiIgogICAgICAgIEluc3RhbnRpYXRlIHdpdGggYSBnaXZlbiBicy5QbGF5ZXIgYW5kIHJlc3Bhd25UaW1lIChpbiBtaWxsaXNlY29uZHMpCiAgICAgICAgIiIiCiAgICAgICAgYWN0aXZpdHkgPSBicy5nZXRBY3Rpdml0eSgpCiAgICAgICAgb25SaWdodCA9IEZhbHNlCiAgICAgICAgc2VsZi5fdmlzaWJsZSA9IFRydWUKICAgICAgICBpZiBpc2luc3RhbmNlKGJzLmdldFNlc3Npb24oKSwgYnMuVGVhbXNTZXNzaW9uKToKICAgICAgICAgICAgb25SaWdodCA9IHBsYXllci5nZXRUZWFtKCkuZ2V0SUQoKSUyPT0xCiAgICAgICAgICAgICMgc3RvcmUgYSBsaXN0IG9mIGljb25zIGluIHRoZSB0ZWFtCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHJlc3Bhd25JY29ucyA9IChwbGF5ZXIuZ2V0VGVhbSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdhbWVEYXRhWydfc3BhelJlc3Bhd25JY29uc1JpZ2h0J10pCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICByZXNwYXduSWNvbnMgPSAocGxheWVyLmdldFRlYW0oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nYW1lRGF0YVsnX3NwYXpSZXNwYXduSWNvbnNSaWdodCddKSA9IHt9CiAgICAgICAgICAgIG9mZnNFeHRyYSA9IC0yMAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIG9uUmlnaHQgPSBGYWxzZQogICAgICAgICAgICAjIHN0b3JlIGEgbGlzdCBvZiBpY29ucyBpbiB0aGUgYWN0aXZpdHkKICAgICAgICAgICAgdHJ5OiByZXNwYXduSWNvbnMgPSBhY3Rpdml0eS5fc3BhelJlc3Bhd25JY29uc1JpZ2h0CiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICByZXNwYXduSWNvbnMgPSBhY3Rpdml0eS5fc3BhelJlc3Bhd25JY29uc1JpZ2h0ID0ge30KICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShhY3Rpdml0eS5nZXRTZXNzaW9uKCksIGJzLkZyZWVGb3JBbGxTZXNzaW9uKToKICAgICAgICAgICAgICAgIG9mZnNFeHRyYSA9IC0xNTAKICAgICAgICAgICAgZWxzZTogb2Zmc0V4dHJhID0gLTIwCgogICAgICAgIHRyeToKICAgICAgICAgICAgbWFza1RleCA9IHBsYXllci5nZXRUZWFtKCkuZ2FtZURhdGFbJ19zcGF6UmVzcGF3bkljb25zTWFza1RleCddCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgbWFza1RleCA9IHBsYXllci5nZXRUZWFtKCkuZ2FtZURhdGFbJ19zcGF6UmVzcGF3bkljb25zTWFza1RleCddID0gXAogICAgICAgICAgICAgICAgYnMuZ2V0VGV4dHVyZSgnY2hhcmFjdGVySWNvbk1hc2snKQoKICAgICAgICAjIG5vdyBmaW5kIHRoZSBmaXJzdCB1bnVzZWQgc2xvdCBhbmQgdXNlIHRoYXQKICAgICAgICBpbmRleCA9IDAKICAgICAgICB3aGlsZSAoaW5kZXggaW4gcmVzcGF3bkljb25zIGFuZCByZXNwYXduSWNvbnNbaW5kZXhdKCkgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgYW5kIHJlc3Bhd25JY29uc1tpbmRleF0oKS5fdmlzaWJsZSk6CiAgICAgICAgICAgIGluZGV4ICs9IDEKICAgICAgICByZXNwYXduSWNvbnNbaW5kZXhdID0gd2Vha3JlZi5yZWYoc2VsZikKCiAgICAgICAgb2ZmcyA9IG9mZnNFeHRyYSArIGluZGV4Ki01MwogICAgICAgIGljb24gPSBwbGF5ZXIuZ2V0SWNvbigpCiAgICAgICAgdGV4dHVyZSA9IGljb25bJ3RleHR1cmUnXQogICAgICAgIGhPZmZzID0gLTEwCiAgICAgICAgc2VsZi5faW1hZ2UgPSBicy5Ob2RlQWN0b3IoCiAgICAgICAgICAgIGJzLm5ld05vZGUoJ2ltYWdlJywKICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3RleHR1cmUnOnRleHR1cmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aW50VGV4dHVyZSc6aWNvblsndGludFRleHR1cmUnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RpbnRDb2xvcic6aWNvblsndGludENvbG9yJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aW50MkNvbG9yJzppY29uWyd0aW50MkNvbG9yJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXNrVGV4dHVyZSc6bWFza1RleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzooLTQwLWhPZmZzIGlmIG9uUmlnaHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSA0MCtoT2ZmcywgLTE4MCtvZmZzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NjYWxlJzooMzIsIDMyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOjEuMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Fic29sdXRlU2NhbGUnOlRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhdHRhY2gnOid0b3BSaWdodCcgaWYgb25SaWdodCBlbHNlICd0b3BMZWZ0J30pKQogICAgICAgIAogICAgICAgIGJzLmFuaW1hdGUoc2VsZi5faW1hZ2Uubm9kZSwgJ29wYWNpdHknLCB7MDowLCAyMDA6MC43fSkKICAgICAgICAKICAgICAgICB0ZXh0ID0gYnMuZ2V0VGV4dHVyZSgncmVwbGF5SWNvbicpICNjcmVhdGVkIHBlcnNvbmFsbHkgYnkgUENNb2RkZXIKICAgICAgICBzZWxmLnBfaW1hZ2UgPSBicy5Ob2RlQWN0b3IoCiAgICAgICAgICAgIGJzLm5ld05vZGUoJ2ltYWdlJywKICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3RleHR1cmUnOnRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aW50Q29sb3InOigwLDAsMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0aW50MkNvbG9yJzooMCwwLDEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOigtNzUtaE9mZnMgaWYgb25SaWdodAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIDc1K2hPZmZzLCAtMTgwK29mZnMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2NhbGUnOigzMiwgMzIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eSc6MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYWJzb2x1dGVTY2FsZSc6VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2F0dGFjaCc6J3RvcFJpZ2h0JyBpZiBvblJpZ2h0IGVsc2UgJ3RvcExlZnQnfSkpCiAgICAgICAgCiAgICAgICAgYnMuYW5pbWF0ZShzZWxmLnBfaW1hZ2Uubm9kZSwgJ29wYWNpdHknLCB7MDowLCAyMDA6MS4wfSkKICAgICAgICBic1V0aWxzLmFuaW1hdGUoc2VsZi5wX2ltYWdlLm5vZGUsJ3JvdGF0ZScsezkwMDAwOjcwMDAsMTAwMDozNjB9LGxvb3A9VHJ1ZSkKICAgICAgICAjYnNVdGlscy5hbmltYXRlQXJyYXkoc2VsZi5wX2ltYWdlLm5vZGUsJ3NjYWxlJywyLHsxMjAwOig2MCw2MCksMjAwOig3Myw3MyksMDooNjAsNjApfSxsb29wPVRydWUpCgogICAgICAgIHNlbGYuX25hbWUgPSBicy5Ob2RlQWN0b3IoCiAgICAgICAgICAgIGJzLm5ld05vZGUoJ3RleHQnLAogICAgICAgICAgICAgICAgICAgICAgIGF0dHJzPXsndkF0dGFjaCc6J3RvcCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoQXR0YWNoJzoncmlnaHQnIGlmIG9uUmlnaHQgZWxzZSAnbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0Jzpicy5Mc3RyKHZhbHVlPXBsYXllci5nZXROYW1lKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWF4V2lkdGgnOjEwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBbGlnbic6J2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2QWxpZ24nOidjZW50ZXInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2hhZG93JzoxLjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmbGF0bmVzcyc6MS4wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sb3InOmJzLmdldFNhZmVDb2xvcihpY29uWyd0aW50Q29sb3InXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzY2FsZSc6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOigtNDAtaE9mZnMgaWYgb25SaWdodAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIDQwK2hPZmZzLCAtMjA1KzQ5K29mZnMpfSkpCiAgICAgICAgCiAgICAgICAgYnMuYW5pbWF0ZShzZWxmLl9uYW1lLm5vZGUsICdzY2FsZScsIHswOjAsIDEwMDowLjV9KQoKICAgICAgICBzZWxmLl90ZXh0ID0gYnMuTm9kZUFjdG9yKAogICAgICAgICAgICBicy5uZXdOb2RlKCd0ZXh0JywKICAgICAgICAgICAgICAgICAgICAgICBhdHRycz17J3Bvc2l0aW9uJzooLTY3LWhPZmZzIGlmIG9uUmlnaHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSA2NytoT2ZmcywgLTE5NCtvZmZzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBdHRhY2gnOidyaWdodCcgaWYgb25SaWdodCBlbHNlICdsZWZ0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hBbGlnbic6J3JpZ2h0JyBpZiBvblJpZ2h0IGVsc2UgJ2xlZnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc2NhbGUnOjAuOSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NoYWRvdyc6MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZmxhdG5lc3MnOjAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3ZBdHRhY2gnOid0b3AnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sb3InOmJzLmdldFNhZmVDb2xvcihpY29uWyd0aW50Q29sb3InXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0JzonJ30pKQogICAgICAgIAogICAgICAgIGJzLmFuaW1hdGUoc2VsZi5fdGV4dC5ub2RlLCAnc2NhbGUnLCB7MDowLCAxMDA6MS4wfSkKCiAgICAgICAgc2VsZi5fcmVzcGF3blRpbWUgPSBicy5nZXRHYW1lVGltZSgpK3Jlc3Bhd25UaW1lCiAgICAgICAgc2VsZi5fdXBkYXRlKCkKICAgICAgICBzZWxmLl90aW1lciA9IGJzLlRpbWVyKDEwMDAsIGJzLldlYWtDYWxsKHNlbGYuX3VwZGF0ZSksIHJlcGVhdD1UcnVlKQoKICAgIGRlZiBfdXBkYXRlKHNlbGYpOgogICAgICAgIHJlbWFpbmluZyA9IGludChyb3VuZChzZWxmLl9yZXNwYXduVGltZS1icy5nZXRHYW1lVGltZSgpKS8xMDAwLjApCiAgICAgICAgaWYgcmVtYWluaW5nID4gMDoKICAgICAgICAgICAgaWYgc2VsZi5fdGV4dC5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICAgICAgc2VsZi5fdGV4dC5ub2RlLnRleHQgPSBzdHIocmVtYWluaW5nKQogICAgICAgIGVsc2U6IHNlbGYuX2NsZWFyKCkKICAgICAgICAgICAgCiAgICBkZWYgX2NsZWFyKHNlbGYpOgogICAgICAgIHNlbGYuX3Zpc2libGUgPSBGYWxzZQogICAgICAgIHNlbGYuX2ltYWdlID0gc2VsZi5fdGV4dCA9IHNlbGYuX3RpbWVyID0gc2VsZi5fbmFtZSA9IHNlbGYucF9pbWFnZSA9IE5vbmUKCmNsYXNzIFNwYXpCb3RQdW5jaGVkTWVzc2FnZShvYmplY3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogTWVzc2FnZSBDbGFzc2VzCgogICAgQSBicy5TcGF6Qm90IGdvdCBwdW5jaGVkLgoKICAgIEF0dHJpYnV0ZXM6CgogICAgICAgYmFkR3V5CiAgICAgICAgICBUaGUgYnMuU3BhekJvdCB0aGF0IGdvdCBwdW5jaGVkLgoKICAgICAgIGRhbWFnZQogICAgICAgICAgSG93IG11Y2ggZGFtYWdlIHdhcyBkb25lIHRvIHRoZSBicy5TcGF6Qm90LgogICAgIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBiYWRHdXksIGRhbWFnZSk6CiAgICAgICAgIiIiCiAgICAgICAgSW5zdGFudGlhdGUgYSBtZXNzYWdlIHdpdGggdGhlIGdpdmVuIHZhbHVlcy4KICAgICAgICAiIiIKICAgICAgICBzZWxmLmJhZEd1eSA9IGJhZEd1eQogICAgICAgIHNlbGYuZGFtYWdlID0gZGFtYWdlCgpjbGFzcyBTcGF6Qm90RGVhdGhNZXNzYWdlKG9iamVjdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBNZXNzYWdlIENsYXNzZXMKCiAgICBBIGJzLlNwYXpCb3QgaGFzIGRpZWQuCgogICAgQXR0cmlidXRlczoKCiAgICAgICBiYWRHdXkKICAgICAgICAgIFRoZSBicy5TcGF6Qm90IHRoYXQgd2FzIGtpbGxlZC4KCiAgICAgICBraWxsZXJQbGF5ZXIKICAgICAgICAgIFRoZSBicy5QbGF5ZXIgdGhhdCBraWxsZWQgaXQgKG9yIE5vbmUpLgoKICAgICAgIGhvdwogICAgICAgICAgVGhlIHBhcnRpY3VsYXIgdHlwZSBvZiBkZWF0aC4KICAgICIiIgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgYmFkR3V5LCBraWxsZXJQbGF5ZXIsIGhvdyk6CiAgICAgICAgIiIiCiAgICAgICAgSW5zdGFudGlhdGUgd2l0aCBnaXZlbiB2YWx1ZXMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5iYWRHdXkgPSBiYWRHdXkKICAgICAgICBzZWxmLmtpbGxlclBsYXllciA9IGtpbGxlclBsYXllcgogICAgICAgIHNlbGYuaG93ID0gaG93CiAgICAgICAgCmNsYXNzIFNwYXpCb3QoU3Bheik6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwoKICAgIEEgcmVhbGx5IGR1bWIgQUkgdmVyc2lvbiBvZiBicy5TcGF6LgogICAgQWRkIHRoZXNlIHRvIGEgYnMuQm90U2V0IHRvIHVzZSB0aGVtLgoKICAgIE5vdGU6IGN1cnJlbnRseSB0aGUgQUkgaGFzIG5vIHJlYWwgYWJpbGl0eSB0bwogICAgbmF2aWdhdGUgb2JzdGFjbGVzIGFuZCBzbyBzaG91bGQgb25seSBiZSB1c2VkCiAgICBvbiB3aWRlLW9wZW4gbWFwcy4KCiAgICBXaGVuIGEgU3BhekJvdCBpcyBraWxsZWQsIGl0IGRlbGl2ZXJzIGEgYnMuU3BhekJvdERlYXRoTWVzc2FnZQogICAgdG8gdGhlIGN1cnJlbnQgYWN0aXZpdHkuCgogICAgV2hlbiBhIFNwYXpCb3QgaXMgcHVuY2hlZCwgaXQgZGVsaXZlcnMgYSBicy5TcGF6Qm90UHVuY2hlZE1lc3NhZ2UKICAgIHRvIHRoZSBjdXJyZW50IGFjdGl2aXR5LgogICAgIiIiCgogICAgY2hhcmFjdGVyID0gJ1NwYXonCiAgICBwdW5jaGluZXNzID0gMC4zCiAgICB0aHJvd2luZXNzID0gMC45CiAgICBzdGF0aWMgPSBGYWxzZQogICAgYm91bmN5ID0gVHJ1ZQogICAgcnVuID0gVHJ1ZQogICAgY2hhcmdlRGlzdE1pbiA9IDAuMCAjIHdoZW4gd2UgY2FuIHN0YXJ0IGEgbmV3IGNoYXJnZQogICAgY2hhcmdlRGlzdE1heCA9IDIuMCAjIHdoZW4gd2UgY2FuIHN0YXJ0IGEgbmV3IGNoYXJnZQogICAgcnVuRGlzdE1pbiA9IDAuMCAjIGhvdyBjbG9zZSB3ZSBjYW4gYmUgdG8gY29udGludWUgcnVubmluZwogICAgY2hhcmdlU3BlZWRNaW4gPSAwLjMKICAgIGNoYXJnZVNwZWVkTWF4ID0gMS4wCiAgICB0aHJvd0Rpc3RNaW4gPSAyLjAKICAgIHRocm93RGlzdE1heCA9IDUuMAogICAgdGhyb3dSYXRlID0gMS4wCiAgICBkZWZhdWx0Qm9tYlR5cGUgPSAnbm9ybWFsJwogICAgZGVmYXVsdEJvbWJDb3VudCA9IDEKICAgIHN0YXJ0Q3Vyc2VkID0gRmFsc2UKICAgIGNvbG9yPWdEZWZhdWx0Qm90Q29sb3IKICAgIGhpZ2hsaWdodD1nRGVmYXVsdEJvdEhpZ2hsaWdodAogICAgaHAgPSAxMDAwCiAgICBwaCA9IDEuMgoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICAiIiIKICAgICAgICBJbnN0YW50aWF0ZSBhIHNwYXotYm90LgogICAgICAgICIiIgogICAgICAgIFNwYXouX19pbml0X18oc2VsZiwgY29sb3I9c2VsZi5jb2xvciwgaGlnaGxpZ2h0PXNlbGYuaGlnaGxpZ2h0LCBjaGFyYWN0ZXI9c2VsZi5jaGFyYWN0ZXIsIHNvdXJjZVBsYXllcj1Ob25lLCBzdGFydEludmluY2libGU9RmFsc2UsIGNhbkFjY2VwdFBvd2VydXBzPUZhbHNlKQoKICAgICAgICAjIGlmIHlvdSBuZWVkIHRvIGFkZCBjdXN0b20gYmVoYXZpb3IgdG8gYSBib3QsIHNldCB0aGlzIHRvIGEgY2FsbGFibGUKICAgICAgICAjIHdoaWNoIHRha2VzIG9uZSBhcmcgKHRoZSBib3QpIGFuZCByZXR1cm5zIEZhbHNlIGlmIHRoZSBib3QncyBub3JtYWwKICAgICAgICAjIHVwZGF0ZSBzaG91bGQgYmUgcnVuIGFuZCBUcnVlIGlmIG5vdAogICAgICAgIHNlbGYudXBkYXRlQ2FsbGJhY2sgPSBOb25lCiAgICAgICAgc2VsZi5fbWFwID0gd2Vha3JlZi5yZWYoYnMuZ2V0QWN0aXZpdHkoKS5nZXRNYXAoKSkKICAgICAgICBzZWxmLmxhc3RQbGF5ZXJBdHRhY2tlZEJ5ID0gTm9uZSAjIEZJWE1FIC0gc2hvdWxkIHVzZSBlbXB0eSBwbGF5ZXItcmVmcwogICAgICAgIHNlbGYubGFzdEF0dGFja2VkVGltZSA9IDAKICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFR5cGUgPSBOb25lCiAgICAgICAgc2VsZi50YXJnZXRQb2ludERlZmF1bHQgPSBOb25lCiAgICAgICAgc2VsZi5oZWxkQ291bnQgPSAwCiAgICAgICAgc2VsZi5sYXN0UGxheWVySGVsZEJ5ID0gTm9uZSAjIEZJWE1FIC0gc2hvdWxkIHVzZSBlbXB0eSBwbGF5ZXItcmVmcyBoZXJlCiAgICAgICAgc2VsZi50YXJnZXRGbGFnID0gTm9uZQogICAgICAgIHNlbGYuX2NoYXJnZVNwZWVkID0gMC41KihzZWxmLmNoYXJnZVNwZWVkTWluK3NlbGYuY2hhcmdlU3BlZWRNYXgpCiAgICAgICAgc2VsZi5fbGVhZEFtb3VudCA9IDAuNQogICAgICAgIHNlbGYuX21vZGUgPSAnd2FpdCcKICAgICAgICBzZWxmLl9jaGFyZ2VDbG9zaW5nSW4gPSBGYWxzZQogICAgICAgIHNlbGYuX2xhc3RDaGFyZ2VEaXN0ID0gMC4wCiAgICAgICAgc2VsZi5fcnVubmluZyA9IEZhbHNlCiAgICAgICAgc2VsZi5fbGFzdEp1bXBUaW1lID0gMAogICAgICAgICMgdGhlc2UgY29vbGRvd25zIGRpZG50IGV4aXN0IHdoZW4gdGhlc2UgYm90cyB3ZXJlIGNhbGlicmF0ZWQsCiAgICAgICAgIyBzbyB0YWtlIHRoZW0gb3V0IG9mIHRoZSBlcXVhdGlvbgogICAgICAgIHNlbGYuX2p1bXBDb29sZG93biA9IDAKICAgICAgICBzZWxmLl9waWNrdXBDb29sZG93biA9IDAKICAgICAgICBzZWxmLl9mbHlDb29sZG93biA9IDAKICAgICAgICBzZWxmLl9ib21iQ29vbGRvd24gPSAwCiAgICAgICAgc2VsZi5fcHVuY2hQb3dlclNjYWxlID0gc2VsZi5waAogICAgICAgIHNlbGYuaGl0UG9pbnRzID0gc2VsZi5oaXRQb2ludHNNYXggPSBzZWxmLmhwCiAgICAgICAgaWYgc2VsZi5zdGFydEN1cnNlZDogc2VsZi5jdXJzZSgpCiAgICAgICAgCiAgICBkZWYgX2dldFRhcmdldFBsYXllclB0KHNlbGYpOgogICAgICAgICIiIiByZXR1cm5zIHRoZSBkZWZhdWx0IHBsYXllciBwdCB3ZSdyZSB0YXJnZXRpbmcgIiIiCiAgICAgICAgYnAgPSBicy5WZWN0b3IoKnNlbGYubm9kZS5wb3NpdGlvbikKICAgICAgICBjbG9zZXN0TGVuID0gTm9uZQogICAgICAgIGNsb3Nlc3RWZWwgPSBOb25lCiAgICAgICAgZm9yIHBwLCBwdiBpbiBzZWxmLl9wbGF5ZXJQdHM6CgogICAgICAgICAgICBsID0gKHBwLWJwKS5sZW5ndGgoKQogICAgICAgICAgICAjIGlnbm9yZSBwbGF5ZXItcG9pbnRzIHRoYXQgYXJlIHNpZ25pZmljYW50bHkgYmVsb3cgdGhlIGJvdAogICAgICAgICAgICAjIChrZWVwcyBib3RzIGZyb20gZm9sbG93aW5nIHBsYXllcnMgb2ZmIGNsaWZmcykKICAgICAgICAgICAgaWYgKGNsb3Nlc3RMZW4gaXMgTm9uZSBvciBsIDwgY2xvc2VzdExlbikgYW5kIChwcFsxXSA+IGJwWzFdIC0gNS4wKToKICAgICAgICAgICAgICAgIGNsb3Nlc3RMZW4gPSBsCiAgICAgICAgICAgICAgICBjbG9zZXN0VmVsID0gcHYKICAgICAgICAgICAgICAgIGNsb3Nlc3QgPSBwcAogICAgICAgIGlmIGNsb3Nlc3RMZW4gaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHJldHVybiAoYnMuVmVjdG9yKGNsb3Nlc3RbMF0sIGNsb3Nlc3RbMV0sIGNsb3Nlc3RbMl0pLAogICAgICAgICAgICAgICAgICAgIGJzLlZlY3RvcihjbG9zZXN0VmVsWzBdLCBjbG9zZXN0VmVsWzFdLCBjbG9zZXN0VmVsWzJdKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZQoKICAgIGRlZiBfc2V0UGxheWVyUHRzKHNlbGYsIHB0cyk6CiAgICAgICAgIiIiCiAgICAgICAgUHJvdmlkZSB0aGUgc3Bhei1ib3Qgd2l0aCB0aGUgbG9jYXRpb25zIG9mIHBsYXllcnMuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fcGxheWVyUHRzID0gcHRzCgogICAgZGVmIF91cGRhdGVBSShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBTaG91bGQgYmUgY2FsbGVkIHBlcmlvZGljYWxseSB0byB1cGRhdGUgdGhlIHNwYXonIEFJCiAgICAgICAgIiIiCiAgICAgICAgCiAgICAgICAgaWYgc2VsZi51cGRhdGVDYWxsYmFjayBpcyBub3QgTm9uZToKICAgICAgICAgICAgaWYgc2VsZi51cGRhdGVDYWxsYmFjayhzZWxmKSA9PSBUcnVlOgogICAgICAgICAgICAgICAgcmV0dXJuICMgdHJ1ZSBtZWFucyBib3QgaGFzIGJlZW4gaGFuZGxlZAoKICAgICAgICB0ID0gc2VsZi5ub2RlLnBvc2l0aW9uCiAgICAgICAgb3VyUG9zID0gYnMuVmVjdG9yKHRbMF0sIDAsIHRbMl0pCiAgICAgICAgY2FuQXR0YWNrID0gVHJ1ZQoKICAgICAgICAjIGlmIHdlJ3JlIGEgZmxhZy1iZWFyZXIsIHdlJ3JlIHByZXR0eSBzaW1wbGUtbWluZGVkIC0ganVzdCB3YWxrCiAgICAgICAgIyB0b3dhcmRzIHRoZSBmbGFnIGFuZCB0cnkgdG8gcGljayBpdCB1cAogICAgICAgIGlmIHNlbGYudGFyZ2V0RmxhZyBpcyBub3QgTm9uZToKCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLnRhcmdldEZsYWcubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgICMgb3VyIGZsYWcgbXVzdGEgZGllZCA6LUMKICAgICAgICAgICAgICAgIHNlbGYudGFyZ2V0RmxhZyA9IE5vbmUKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICBpZiBzZWxmLm5vZGUuaG9sZE5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICB0cnk6IGhvbGRpbmdGbGFnID0gKHNlbGYubm9kZS5ob2xkTm9kZS5nZXROb2RlVHlwZSgpID09ICdmbGFnJykKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246IGhvbGRpbmdGbGFnID0gRmFsc2UKICAgICAgICAgICAgZWxzZTogaG9sZGluZ0ZsYWcgPSBGYWxzZQogICAgICAgICAgICAjIGlmIHdlJ3JlIGhvbGRpbmcgdGhlIGZsYWcsIGp1c3Qgd2FsayBsZWZ0CiAgICAgICAgICAgIGlmIGhvbGRpbmdGbGFnOgogICAgICAgICAgICAgICAgIyBqdXN0IHdhbGsgbGVmdAogICAgICAgICAgICAgICAgc2VsZi5fb25Nb3ZlKC0xLjAsIDAuMCkKICAgICAgICAgICAgIyBvdGhlcndpc2UgdHJ5IHRvIGdvIHBpY2sgaXQgdXAKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHRhcmdldFB0UmF3ID0gYnMuVmVjdG9yKCpzZWxmLnRhcmdldEZsYWcubm9kZS5wb3NpdGlvbikKICAgICAgICAgICAgICAgIHRhcmdldFZlbCA9IGJzLlZlY3RvcigwLCAwLCAwKQogICAgICAgICAgICAgICAgZGlmZiA9ICh0YXJnZXRQdFJhdy1vdXJQb3MpCiAgICAgICAgICAgICAgICBkaWZmID0gYnMuVmVjdG9yKGRpZmZbMF0sIDAsIGRpZmZbMl0pICMgZG9udCBjYXJlIGFib3V0IHkKICAgICAgICAgICAgICAgIGRpc3QgPSBkaWZmLmxlbmd0aCgpCiAgICAgICAgICAgICAgICB0b1RhcmdldCA9IGRpZmYubm9ybWFsKCkKCiAgICAgICAgICAgICAgICAjIGlmIHdlJ3JlIGhvbGRpbmcgc29tZSBub24tZmxhZyBpdGVtLCBkcm9wIGl0CiAgICAgICAgICAgICAgICBpZiBzZWxmLm5vZGUuaG9sZE5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBpY2tVcFByZXNzZWQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBpY2tVcFByZXNzZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgICAgICMgaWYgd2UncmUgYSBydW5uZXIsIHJ1biBvbmx5IHdoZW4gbm90IHN1cGVyLW5lYXIgdGhlIGZsYWcKICAgICAgICAgICAgICAgIGlmIHNlbGYucnVuIGFuZCBkaXN0ID4gMy4wOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3J1bm5pbmcgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnJ1biA9IDEuMAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydW5uaW5nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucnVuID0gMC4wCgogICAgICAgICAgICAgICAgc2VsZi5fb25Nb3ZlKHRvVGFyZ2V0LngoKSwgLXRvVGFyZ2V0LnooKSkKICAgICAgICAgICAgICAgIGlmIGRpc3QgPCAxLjI1OgogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5waWNrVXBQcmVzc2VkID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5waWNrVXBQcmVzc2VkID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgIyBub3QgYSBmbGFnLWJlYXJlci4uIGlmIHdlJ3JlIGhvbGRpbmcgYW55dGhpbmcgYnV0IGEgYm9tYiwgZHJvcCBpdAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIHNlbGYubm9kZS5ob2xkTm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgIHRyeTogaG9sZGluZ0JvbWIgPSBcCiAgICAgICAgICAgICAgICAgICAoc2VsZi5ub2RlLmhvbGROb2RlLmdldE5vZGVUeXBlKCkgaW4gWydib21iJywgJ3Byb3AnXSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246IGhvbGRpbmdCb21iID0gRmFsc2UKICAgICAgICAgICAgICAgIGlmIG5vdCBob2xkaW5nQm9tYjoKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGlja1VwUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucGlja1VwUHJlc3NlZCA9IEZhbHNlCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIAogICAgICAgIHRhcmdldFB0UmF3LCB0YXJnZXRWZWwgPSBzZWxmLl9nZXRUYXJnZXRQbGF5ZXJQdCgpCgogICAgICAgIGlmIHRhcmdldFB0UmF3IGlzIE5vbmU6CiAgICAgICAgICAgICMgdXNlIGRlZmF1bHQgdGFyZ2V0IGlmIHdlJ3ZlIGdvdCBvbmUKICAgICAgICAgICAgaWYgc2VsZi50YXJnZXRQb2ludERlZmF1bHQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICB0YXJnZXRQdFJhdyA9IHNlbGYudGFyZ2V0UG9pbnREZWZhdWx0CiAgICAgICAgICAgICAgICB0YXJnZXRWZWwgPSBicy5WZWN0b3IoMCwgMCwgMCkKICAgICAgICAgICAgICAgIGNhbkF0dGFjayA9IEZhbHNlCiAgICAgICAgICAgICMgd2l0aCBubyB0YXJnZXQsIHdlIHN0b3AgbW92aW5nIGFuZCBkcm9wIHdoYXRldmVyIHdlJ3JlIGhvbGRpbmcKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYuX29uTW92ZSgwLDApCiAgICAgICAgICAgICAgICBpZiBzZWxmLm5vZGUuaG9sZE5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBpY2tVcFByZXNzZWQgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBpY2tVcFByZXNzZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMgd2UgZG9udCB3YW50IGhlaWdodCB0byBjb21lIGludG8gcGxheQogICAgICAgIHRhcmdldFB0UmF3LmRhdGFbMV0gPSAwCiAgICAgICAgdGFyZ2V0VmVsLmRhdGFbMV0gPSAwCgogICAgICAgIGRpc3RSYXcgPSAodGFyZ2V0UHRSYXctb3VyUG9zKS5sZW5ndGgoKQogICAgICAgICMgdXNlIGEgcG9pbnQgb3V0IGluIGZyb250IG9mIHRoZW0gYXMgcmVhbCB0YXJnZXQKICAgICAgICAjIChtb3JlIG91dCBpbiBmcm9udCB0aGUgZmFydGhlciBmcm9tIHVzIHRoZXkgYXJlKQogICAgICAgIHRhcmdldFB0ID0gdGFyZ2V0UHRSYXcgKyB0YXJnZXRWZWwqZGlzdFJhdyowLjMqc2VsZi5fbGVhZEFtb3VudAoKICAgICAgICBkaWZmID0gKHRhcmdldFB0LW91clBvcykKICAgICAgICBkaXN0ID0gZGlmZi5sZW5ndGgoKQogICAgICAgIHRvVGFyZ2V0ID0gZGlmZi5ub3JtYWwoKQoKICAgICAgICBpZiBzZWxmLl9tb2RlID09ICd0aHJvdyc6CiAgICAgICAgICAgICMgd2UgY2FuIG9ubHkgdGhyb3cgaWYgYWxpdmUgYW5kIHdlbGwuLgogICAgICAgICAgICBpZiBub3Qgc2VsZi5fZGVhZCBhbmQgbm90IHNlbGYubm9kZS5rbm9ja291dDoKCiAgICAgICAgICAgICAgICB0aW1lVGlsbFRocm93ID0gc2VsZi5fdGhyb3dSZWxlYXNlVGltZS1icy5nZXRHYW1lVGltZSgpCgogICAgICAgICAgICAgICAgaWYgbm90IHNlbGYubm9kZS5ob2xkTm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgICAgICAjIGlmIHdlIGhhdm50IHRocm93biB5ZXQsIHdoaXAgb3V0IHRoZSBib21iCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuX2hhdmVEcm9wcGVkVGhyb3dCb21iOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRyb3BCb21iKCkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5faGF2ZURyb3BwZWRUaHJvd0JvbWIgPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgIyBvdGhlcndpc2Ugb3VyIGxhY2sgb2YgaGVsZCBub2RlIG1lYW5zIHdlIHN1Y2Nlc3NmdWxseQogICAgICAgICAgICAgICAgICAgICMgcmVsZWFzZWQgb3VyIGJvbWIuLiBsZXRzIHJldHJlYXQgbm93CiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbW9kZSA9ICdmbGVlJwoKICAgICAgICAgICAgICAgICMgb2ggY3JhcCB3ZSdyZSBob2xkaW5nIGEgYm9tYi4uIGJldHRlciB0aHJvdyBpdC4KICAgICAgICAgICAgICAgIGVsaWYgdGltZVRpbGxUaHJvdyA8PSAwOgogICAgICAgICAgICAgICAgICAgICMganVtcCBhbmQgdGhyb3cuLgogICAgICAgICAgICAgICAgICAgIGRlZiBfc2FmZVBpY2t1cChub2RlKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5waWNrVXBQcmVzc2VkID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLnBpY2tVcFByZXNzZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgICAgIGlmIGRpc3QgPiA1LjA6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5qdW1wUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmp1bXBQcmVzc2VkID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgIyB0aHJvd3M6CiAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAsIGJzLkNhbGwoX3NhZmVQaWNrdXAsIHNlbGYubm9kZSkpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgIyB0aHJvd3M6CiAgICAgICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxLCBicy5DYWxsKF9zYWZlUGlja3VwLCBzZWxmLm5vZGUpKQoKICAgICAgICAgICAgICAgIGlmIHNlbGYuc3RhdGljOgogICAgICAgICAgICAgICAgICAgIGlmIHRpbWVUaWxsVGhyb3cgPCAzMDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkID0gMS4wCiAgICAgICAgICAgICAgICAgICAgZWxpZiB0aW1lVGlsbFRocm93IDwgNzAwIGFuZCBkaXN0ID4gMy4wOgogICAgICAgICAgICAgICAgICAgICAgICBzcGVlZCA9IC0xLjAgIyB3aGlwbGFzaCBmb3IgbG9uZyB0aHJvd3MKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBzcGVlZCA9IDAuMDIKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgaWYgdGltZVRpbGxUaHJvdyA8IDcwMDoKICAgICAgICAgICAgICAgICAgICAgICAgIyByaWdodCBiZWZvcmUgdGhyb3cgY2hhcmdlIGZ1bGwgc3BlZWQgdG93YXJkcyB0YXJnZXQKICAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQgPSAxLjAKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAjIGVhcmxpZXIgd2UgY2FuIGhvbGQgb3IgbW92ZSBiYWNrd2FyZCBmb3IgYSB3aGlwbGFzaAogICAgICAgICAgICAgICAgICAgICAgICBzcGVlZCA9IDAuMDEyNQogICAgICAgICAgICAgICAgc2VsZi5fb25Nb3ZlKHRvVGFyZ2V0LngoKSAqIHNwZWVkLCB0b1RhcmdldC56KCkgKiAtMS4wICogc3BlZWQpCgogICAgICAgIGVsaWYgc2VsZi5fbW9kZSA9PSAnY2hhcmdlJzoKICAgICAgICAgICAgaWYgcmFuZG9tLnJhbmRvbSgpIDwgMC4zOgogICAgICAgICAgICAgICAgc2VsZi5fY2hhcmdlU3BlZWQgPSByYW5kb20udW5pZm9ybShzZWxmLmNoYXJnZVNwZWVkTWluLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNoYXJnZVNwZWVkTWF4KQogICAgICAgICAgICAgICAgIyBpZiB3ZSdyZSBhIHJ1bm5lciB3ZSBydW4gZHVyaW5nIGNoYXJnZXMgKmV4Y2VwdCB3aGVuIG5lYXIKICAgICAgICAgICAgICAgICMgYW4gZWRnZSAob3RoZXJ3aXNlIHdlIHRlbmQgdG8gZmx5IG9mZiBlYXNpbHkpCiAgICAgICAgICAgICAgICBpZiBzZWxmLnJ1biBhbmQgZGlzdFJhdyA+IHNlbGYucnVuRGlzdE1pbjoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9sZWFkQW1vdW50ID0gMC4zCiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcnVubmluZyA9IFRydWUKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucnVuID0gMS4wCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX2xlYWRBbW9udCA9IDAuMDEKICAgICAgICAgICAgICAgICAgICBzZWxmLl9ydW5uaW5nID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICBzZWxmLm5vZGUucnVuID0gMC4wCgogICAgICAgICAgICBzZWxmLl9vbk1vdmUodG9UYXJnZXQueCgpICogc2VsZi5fY2hhcmdlU3BlZWQsIHRvVGFyZ2V0LnooKSAqIC0xLjAqc2VsZi5fY2hhcmdlU3BlZWQpCgogICAgICAgIGVsaWYgc2VsZi5fbW9kZSA9PSAnd2FpdCc6CiAgICAgICAgICAgICMgZXZlcnkgbm93IGFuZCB0aGVuLCBhaW0gdG93YXJkcyBvdXIgdGFyZ2V0Li4KICAgICAgICAgICAgIyBvdGhlciB0aGFuIHRoYXQsIGp1c3Qgc3RhbmQgdGhlcmUKICAgICAgICAgICAgaWYgYnMuZ2V0R2FtZVRpbWUoKSUxMjM0IDwgMTAwOgogICAgICAgICAgICAgICAgc2VsZi5fb25Nb3ZlKHRvVGFyZ2V0LngoKSAqICg0MDAuMC8zMzAwMCksIHRvVGFyZ2V0LnooKSAqICgtNDAwLjAvMzMwMDApKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fb25Nb3ZlKDAsMCkKICAgICAgICAgICAgICAgIAogICAgICAgIGVsaWYgc2VsZi5fbW9kZSA9PSAnZmxlZSc6CiAgICAgICAgICAgICMgZXZlbiBpZiB3ZSdyZSBhIHJ1bm5lciwgb25seSBydW4gdGlsbCB3ZSBnZXQgYXdheSBmcm9tIG91cgogICAgICAgICAgICAjIHRhcmdldCAoaWYgd2Uga2VlcCBydW5uaW5nIHdlIHRlbmQgdG8gcnVuIG9mZiBlZGdlcykKICAgICAgICAgICAgaWYgc2VsZi5ydW4gYW5kIGRpc3QgPCAzLjA6CiAgICAgICAgICAgICAgICBzZWxmLl9ydW5uaW5nID0gVHJ1ZQogICAgICAgICAgICAgICAgc2VsZi5ub2RlLnJ1biA9IDEuMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5fcnVubmluZyA9IEZhbHNlCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUucnVuID0gMC4wCiAgICAgICAgICAgIHNlbGYuX29uTW92ZSh0b1RhcmdldC54KCkgKiAtMS4wLCB0b1RhcmdldC56KCkpCgogICAgICAgICMgd2UgbWlnaHQgd2FubmEgc3dpdGNoIHN0YXRlcyB1bmxlc3Mgd2UncmUgZG9pbmcgYSB0aHJvdwogICAgICAgICMgKGluIHdoaWNoIGNhc2UgdGhhdHMgb3VyIHNvbGUgY29uY2VybikKICAgICAgICBpZiBzZWxmLl9tb2RlICE9ICd0aHJvdyc6CgogICAgICAgICAgICAjIGlmIHdlJ3JlIGN1cnJlbnRseSBjaGFyZ2luZywga2VlcCB0cmFjayBvZiBob3cgZmFyIHdlIGFyZQogICAgICAgICAgICAjIGZyb20gb3VyIHRhcmdldC4uIHdoZW4gdGhpcyB2YWx1ZSBpbmNyZWFzZXMgaXQgbWVhbnMgb3VyIGNoYXJnZQogICAgICAgICAgICAjIGlzIG92ZXIgKHJhbiBieSB0aGVtIG9yIHNvbWV0aGluZykKICAgICAgICAgICAgaWYgc2VsZi5fbW9kZSA9PSAnY2hhcmdlJzoKICAgICAgICAgICAgICAgIGlmIChzZWxmLl9jaGFyZ2VDbG9zaW5nSW4gYW5kIGRpc3QgPCAzLjAKICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGRpc3QgPiBzZWxmLl9sYXN0Q2hhcmdlRGlzdCk6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fY2hhcmdlQ2xvc2luZ0luID0gRmFsc2UKICAgICAgICAgICAgICAgIHNlbGYuX2xhc3RDaGFyZ2VEaXN0ID0gZGlzdAoKICAgICAgICAgICAgIyBpZiB3ZSBoYXZlIGEgY2xlYW4gc2hvdCwgdGhyb3chCiAgICAgICAgICAgIGlmIChkaXN0ID49IHNlbGYudGhyb3dEaXN0TWluIGFuZCBkaXN0IDwgc2VsZi50aHJvd0Rpc3RNYXgKICAgICAgICAgICAgICAgIGFuZCByYW5kb20ucmFuZG9tKCkgPCBzZWxmLnRocm93aW5lc3MgYW5kIGNhbkF0dGFjayk6CiAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ3Rocm93JwogICAgICAgICAgICAgICAgc2VsZi5fbGVhZEFtb3VudCA9ICgoMC40K3JhbmRvbS5yYW5kb20oKSowLjYpIGlmIGRpc3RSYXcgPiA0LjAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAoMC4xK3JhbmRvbS5yYW5kb20oKSowLjQpKQogICAgICAgICAgICAgICAgc2VsZi5faGF2ZURyb3BwZWRUaHJvd0JvbWIgPSBGYWxzZQogICAgICAgICAgICAgICAgc2VsZi5fdGhyb3dSZWxlYXNlVGltZSA9IChicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKDEuMC9zZWxmLnRocm93UmF0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKig4MDAgKyBpbnQoMTMwMCpyYW5kb20ucmFuZG9tKCkpKSkKCiAgICAgICAgICAgICMgaWYgd2UncmUgc3RhdGljLCBhbHdheXMgY2hhcmdlICh3aGljaCBmb3IgdXMgbWVhbnMgYmFyZWx5IG1vdmUpCiAgICAgICAgICAgIGVsaWYgc2VsZi5zdGF0aWM6CiAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ3dhaXQnCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyBpZiB3ZSdyZSB0b28gY2xvc2UgdG8gY2hhcmdlIChhbmQgYXJlbnQgaW4gdGhlIG1pZGRsZSBvZiBhbgogICAgICAgICAgICAjIGV4aXN0aW5nIGNoYXJnZSkgcnVuIGF3YXkKICAgICAgICAgICAgZWxpZiBkaXN0IDwgc2VsZi5jaGFyZ2VEaXN0TWluIGFuZCBub3Qgc2VsZi5fY2hhcmdlQ2xvc2luZ0luOgogICAgICAgICAgICAgICAgIyAuLnVubGVzcyB3ZSdyZSBuZWFyIGFuIGVkZ2UsIGluIHdoaWNoIGNhc2Ugd2UgZ290IG5vIGNob2ljZQogICAgICAgICAgICAgICAgIyBidXQgdG8gY2hhcmdlLi4KICAgICAgICAgICAgICAgIGlmIHNlbGYuX21hcCgpLl9pc1BvaW50TmVhckVkZ2Uob3VyUG9zLCBzZWxmLl9ydW5uaW5nKToKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLl9tb2RlICE9ICdjaGFyZ2UnOgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ2NoYXJnZScKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fbGVhZEFtb3VudCA9IDAuMgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jaGFyZ2VDbG9zaW5nSW4gPSBUcnVlCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2xhc3RDaGFyZ2VEaXN0ID0gZGlzdAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ2ZsZWUnCgogICAgICAgICAgICAjIHdlJ3JlIHdpdGhpbiBjaGFyZ2luZyBkaXN0YW5jZSwgYmFja2VkIGFnYWluc3QgYW4gZWRnZSwgb3IgZmFydGhlcgogICAgICAgICAgICAjIHRoYW4gb3VyIG1heCB0aHJvdyBkaXN0YW5jZS4uIGNoYWFhcmdlIQogICAgICAgICAgICBlbGlmIChkaXN0IDwgc2VsZi5jaGFyZ2VEaXN0TWF4CiAgICAgICAgICAgICAgICAgIG9yIGRpc3QgPiBzZWxmLnRocm93RGlzdE1heAogICAgICAgICAgICAgICAgICBvciBzZWxmLl9tYXAoKS5faXNQb2ludE5lYXJFZGdlKG91clBvcywgc2VsZi5fcnVubmluZykpOgogICAgICAgICAgICAgICAgaWYgc2VsZi5fbW9kZSAhPSAnY2hhcmdlJzoKICAgICAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ2NoYXJnZScKICAgICAgICAgICAgICAgICAgICBzZWxmLl9sZWFkQW1vdW50ID0gMC4wMQogICAgICAgICAgICAgICAgICAgIHNlbGYuX2NoYXJnZUNsb3NpbmdJbiA9IFRydWUKICAgICAgICAgICAgICAgICAgICBzZWxmLl9sYXN0Q2hhcmdlRGlzdCA9IGRpc3QKCiAgICAgICAgICAgICMgd2UncmUgdG9vIGNsb3NlIHRvIHRocm93IGJ1dCB0b28gZmFyIHRvIGNoYXJnZSAtIGVpdGhlciBydW4KICAgICAgICAgICAgIyBhd2F5IG9yIGp1c3QgY2hpbGwgaWYgd2UncmUgbmVhciBhbiBlZGdlCiAgICAgICAgICAgIGVsaWYgZGlzdCA8IHNlbGYudGhyb3dEaXN0TWluOgogICAgICAgICAgICAgICAgIyBjaGFyZ2UgaWYgZWl0aGVyIHdlJ3JlIHdpdGhpbiBjaGFyZ2UgcmFuZ2Ugb3IKICAgICAgICAgICAgICAgICMgY2FudCByZXRyZWF0IHRvIHRocm93CiAgICAgICAgICAgICAgICBzZWxmLl9tb2RlID0gJ2ZsZWUnCgogICAgICAgICAgICAjIGRvIHNvbWUgYXdlc29tZSBqdW1wcyBpZiB3ZSdyZSBydW5uaW5nCiAgICAgICAgICAgIGlmICgoc2VsZi5fcnVubmluZwogICAgICAgICAgICAgICAgIGFuZCBkaXN0ID4gMS4yIGFuZCBkaXN0IDwgMi4yCiAgICAgICAgICAgICAgICAgYW5kIGJzLmdldEdhbWVUaW1lKCktc2VsZi5fbGFzdEp1bXBUaW1lID4gMTAwMCkKICAgICAgICAgICAgICAgIG9yIChzZWxmLmJvdW5jeQogICAgICAgICAgICAgICAgICAgIGFuZCBicy5nZXRHYW1lVGltZSgpLXNlbGYuX2xhc3RKdW1wVGltZSA+IDQwMAogICAgICAgICAgICAgICAgICAgIGFuZCByYW5kb20ucmFuZG9tKCkgPCAwLjUpKToKICAgICAgICAgICAgICAgIHNlbGYuX2xhc3RKdW1wVGltZSA9IGJzLmdldEdhbWVUaW1lKCkKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5qdW1wUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5qdW1wUHJlc3NlZCA9IEZhbHNlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyB0aHJvdyBwdW5jaGVzIHdoZW4gcmVhbCBjbG9zZQogICAgICAgICAgICBpZiBkaXN0IDwgKDEuNiBpZiBzZWxmLl9ydW5uaW5nIGVsc2UgMS4yKSBhbmQgY2FuQXR0YWNrOgogICAgICAgICAgICAgICAgaWYgcmFuZG9tLnJhbmRvbSgpIDwgc2VsZi5wdW5jaGluZXNzOgogICAgICAgICAgICAgICAgICAgIHNlbGYub25QdW5jaFByZXNzKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLm9uUHVuY2hSZWxlYXNlKCkKCiAgICBkZWYgX29uTW92ZShzZWxmLCB4PTAsIHk9MCk6CiAgICAgICAgc2xvdyA9IGdldGF0dHIoc2VsZiwgInNsb3ciLCBGYWxzZSkKICAgICAgICBpZiBub3Qgc2VsZi5leGlzdHMoKSBvciBub3Qgc2VsZi5pc0FsaXZlKCk6IHJldHVybiAKICAgICAgICBzZWxmLm5vZGUubW92ZUxlZnRSaWdodCA9IHggaWYgbm90IHNsb3cgZWxzZSB4KjAuMjUKICAgICAgICBzZWxmLm5vZGUubW92ZVVwRG93biA9IHkgaWYgbm90IHNsb3cgZWxzZSB4KjAuMjUKCiAgICBkZWYgX19zdXBlckhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKToKICAgICAgICBzdXBlcihTcGF6Qm90LCBzZWxmKS5oYW5kbGVNZXNzYWdlKG1zZykKCiAgICBkZWYgb25QdW5jaGVkKHNlbGYsIGRhbWFnZSk6CiAgICAgICAgIiIiCiAgICAgICAgTWV0aG9kIG92ZXJyaWRlOyBzZW5kcyBicy5TcGF6Qm90UHVuY2hlZE1lc3NhZ2UgdG8gdGhlIGN1cnJlbnQgYWN0aXZpdHkuCiAgICAgICAgIiIiCiAgICAgICAgYnMuZ2V0QWN0aXZpdHkoKS5oYW5kbGVNZXNzYWdlKFNwYXpCb3RQdW5jaGVkTWVzc2FnZShzZWxmLCBkYW1hZ2UpKQoKICAgIGRlZiBvbkZpbmFsaXplKHNlbGYpOgogICAgICAgIFNwYXoub25GaW5hbGl6ZShzZWxmKQogICAgICAgICMgd2UncmUgYmVpbmcgdG9ybiBkb3duOyByZWxlYXNlCiAgICAgICAgIyBvdXIgY2FsbGJhY2socykgc28gdGhlcmUncyBubyBjaGFuY2Ugb2YgdGhlbQogICAgICAgICMga2VlcGluZyBhY3Rpdml0aWVzIG9yIG90aGVyIHRoaW5ncyBhbGl2ZS4uCiAgICAgICAgc2VsZi51cGRhdGVDYWxsYmFjayA9IE5vbmUKCiAgICBkZWYgaGFuZGxlTWVzc2FnZShzZWxmLCBtc2cpOgogICAgICAgIHNlbGYuX2hhbmRsZU1lc3NhZ2VTYW5pdHlDaGVjaygpCgogICAgICAgICMga2VlcCB0cmFjayBvZiBpZiB3ZSdyZSBiZWluZyBoZWxkIGFuZCBieSB3aG8gbW9zdCByZWNlbnRseQogICAgICAgIGlmIGlzaW5zdGFuY2UobXNnLCBicy5QaWNrZWRVcE1lc3NhZ2UpOgogICAgICAgICAgICBzZWxmLl9fc3VwZXJIYW5kbGVNZXNzYWdlKG1zZykgIyBhdWdtZW50IHN0YW5kYXJkIGJlaGF2aW9yCiAgICAgICAgICAgIHNlbGYuaGVsZENvdW50ICs9IDEKICAgICAgICAgICAgcGlja2VkVXBCeSA9IG1zZy5ub2RlLnNvdXJjZVBsYXllcgogICAgICAgICAgICBpZiBwaWNrZWRVcEJ5IGlzIG5vdCBOb25lIGFuZCBwaWNrZWRVcEJ5LmV4aXN0cygpOgogICAgICAgICAgICAgICAgc2VsZi5sYXN0UGxheWVySGVsZEJ5ID0gcGlja2VkVXBCeQoKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5Ecm9wcGVkTWVzc2FnZSk6CiAgICAgICAgICAgIHNlbGYuX19zdXBlckhhbmRsZU1lc3NhZ2UobXNnKSAjIGF1Z21lbnQgc3RhbmRhcmQgYmVoYXZpb3IKICAgICAgICAgICAgc2VsZi5oZWxkQ291bnQgLT0gMQogICAgICAgICAgICBpZiBzZWxmLmhlbGRDb3VudCA8IDA6CiAgICAgICAgICAgICAgICBwcmludCAiRVJST1I6IHNwYXogaGVsZENvdW50IDwgMCIKICAgICAgICAgICAgIyBsZXQncyBjb3VudCBzb21lb25lIGRyb3BwaW5nIHVzIGFzIGFuIGF0dGFjay4uCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIG1zZy5ub2RlLmV4aXN0cygpOiBwaWNrZWRVcEJ5ID0gbXNnLm5vZGUuc291cmNlUGxheWVyCiAgICAgICAgICAgICAgICBlbHNlOiBwaWNrZWRVcEJ5ID0gYnMuUGxheWVyKE5vbmUpICMgZW1wdHkgcGxheWVyIHJlZgogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludCAnRVhDIG9uIFNwYXpCb3QgRHJvcHBlZE1lc3NhZ2U6JywgZQogICAgICAgICAgICAgICAgcGlja2VkVXBCeSA9IGJzLlBsYXllcihOb25lKSAjIGVtcHR5IHBsYXllciByZWYKCiAgICAgICAgICAgIGlmIHBpY2tlZFVwQnkuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLmxhc3RQbGF5ZXJBdHRhY2tlZEJ5ID0gcGlja2VkVXBCeQogICAgICAgICAgICAgICAgc2VsZi5sYXN0QXR0YWNrZWRUaW1lID0gYnMuZ2V0R2FtZVRpbWUoKQogICAgICAgICAgICAgICAgc2VsZi5sYXN0QXR0YWNrZWRUeXBlID0gKCdwaWNrZWRVcCcsICdkZWZhdWx0JykKICAgICAgICAgICAgCiAgICAgICAgZWxpZiBpc2luc3RhbmNlKG1zZywgYnMuRGllTWVzc2FnZSk6CiAgICAgICAgICAgICMgcmVwb3J0IG5vcm1hbCBkZWF0aHMgZm9yIHNjb3JpbmcgcHVycG9zZXMKICAgICAgICAgICAgaWYgbm90IHNlbGYuX2RlYWQgYW5kIG5vdCBtc2cuaW1tZWRpYXRlOgoKICAgICAgICAgICAgICAgICMgaWYgdGhpcyBndXkgd2FzIGJlaW5nIGhlbGQgYXQgdGhlIHRpbWUgb2YgZGVhdGgsIHRoZQogICAgICAgICAgICAgICAgIyBob2xkZXIgaXMgdGhlIGtpbGxlcgogICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVsZENvdW50ID4gMCBhbmQgc2VsZi5sYXN0UGxheWVySGVsZEJ5IGlzIG5vdCBOb25lCiAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBzZWxmLmxhc3RQbGF5ZXJIZWxkQnkuZXhpc3RzKCkpOgogICAgICAgICAgICAgICAgICAgIGtpbGxlclBsYXllciA9IHNlbGYubGFzdFBsYXllckhlbGRCeQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIG90aGVyd2lzZSBpZiB0aGV5IHdlcmUgYXR0YWNrZWQgYnkgc29tZW9uZSBpbiB0aGUKICAgICAgICAgICAgICAgICAgICAjIGxhc3QgZmV3IHNlY29uZHMgdGhhdCBwZXJzb24ncyB0aGUga2lsbGVyLi4KICAgICAgICAgICAgICAgICAgICAjIG90aGVyd2lzZSBpdCB3YXMgYSBzdWljaWRlCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkgaXMgbm90IE5vbmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkuZXhpc3RzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGJzLmdldEdhbWVUaW1lKCkgLSBzZWxmLmxhc3RBdHRhY2tlZFRpbWUgPCA0MDAwKToKICAgICAgICAgICAgICAgICAgICAgICAga2lsbGVyUGxheWVyID0gc2VsZi5sYXN0UGxheWVyQXR0YWNrZWRCeQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGtpbGxlclBsYXllciA9IE5vbmUKICAgICAgICAgICAgICAgIGFjdGl2aXR5ID0gc2VsZi5fYWN0aXZpdHkoKQoKICAgICAgICAgICAgICAgIGlmIGtpbGxlclBsYXllciBpcyBub3QgTm9uZSBhbmQgbm90IGtpbGxlclBsYXllci5leGlzdHMoKToKICAgICAgICAgICAgICAgICAgICBraWxsZXJQbGF5ZXIgPSBOb25lCiAgICAgICAgICAgICAgICBpZiBhY3Rpdml0eSBpcyBub3QgTm9uZTogYWN0aXZpdHkuaGFuZGxlTWVzc2FnZShTcGF6Qm90RGVhdGhNZXNzYWdlKHNlbGYsIGtpbGxlclBsYXllciwgbXNnLmhvdykpCiAgICAgICAgICAgIHNlbGYuX19zdXBlckhhbmRsZU1lc3NhZ2UobXNnKSAjIGF1Z21lbnQgc3RhbmRhcmQgYmVoYXZpb3IKCiAgICAgICAgIyBrZWVwIHRyYWNrIG9mIHRoZSBwbGF5ZXIgd2hvIGxhc3QgaGl0IHVzIGZvciBwb2ludCByZXdhcmRpbmcKICAgICAgICBlbGlmIGlzaW5zdGFuY2UobXNnLCBicy5IaXRNZXNzYWdlKToKICAgICAgICAgICAgaWYgbXNnLnNvdXJjZVBsYXllciBpcyBub3QgTm9uZSBhbmQgbXNnLnNvdXJjZVBsYXllci5leGlzdHMoKToKICAgICAgICAgICAgICAgIHNlbGYubGFzdFBsYXllckF0dGFja2VkQnkgPSBtc2cuc291cmNlUGxheWVyCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFRpbWUgPSBicy5nZXRHYW1lVGltZSgpCiAgICAgICAgICAgICAgICBzZWxmLmxhc3RBdHRhY2tlZFR5cGUgPSAobXNnLmhpdFR5cGUsIG1zZy5oaXRTdWJUeXBlKQogICAgICAgICAgICBzZWxmLl9fc3VwZXJIYW5kbGVNZXNzYWdlKG1zZykKICAgICAgICBlbHNlOgogICAgICAgICAgICBTcGF6LmhhbmRsZU1lc3NhZ2Uoc2VsZiwgbXNnKQoKY2xhc3MgQm9tYmVyQm90KFNwYXpCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBib3QgdGhhdCB0aHJvd3MgcmVndWxhciBib21icwogICAgYW5kIG9jY2FzaW9uYWxseSBwdW5jaGVzLgogICAgIiIiCiAgICBjaGFyYWN0ZXI9J1NwYXonCiAgICBwdW5jaGluZXNzPTAuNTYKICAgIGRlZmF1bHRCb21iVHlwZSA9ICdraWxsTGFLaWxsJwogICAgZGVmYXVsdEJvbWJDb3VudCA9IDEKCiAgICAKY2xhc3MgQm9tYmVyQm90TGFtZShCb21iZXJCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBsZXNzIGFnZ3Jlc3NpdmUgeWVsbG93IHZlcnNpb24gb2YgYnMuQm9tYmVyQm90LgogICAgIiIiCiAgICBjb2xvcj1nTGFtZUJvdENvbG9yCiAgICBoaWdobGlnaHQ9Z0xhbWVCb3RIaWdobGlnaHQKICAgIHB1bmNoaW5lc3MgPSAwLjQKICAgIHRocm93UmF0ZSA9IDAuNwogICAgdGhyb3dpbmVzcyA9IDAuMQogICAgY2hhcmdlU3BlZWRNaW4gPSAwLjYKICAgIGNoYXJnZVNwZWVkTWF4ID0gMC42CiAgICBkZWZhdWx0Qm9tYkNvdW50ID0gMgoKICAgIApjbGFzcyBCb21iZXJCb3RTdGF0aWNMYW1lKEJvbWJlckJvdExhbWUpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBsZXNzIGFnZ3Jlc3NpdmUgeWVsbG93IHZlcnNpb24gb2YgYnMuQm9tYmVyQm90CiAgICB3aG8gZ2VuZXJhbGx5IHN0YXlzIGluIG9uZSBwbGFjZS4KICAgICIiIgogICAgc3RhdGljID0gVHJ1ZQogICAgdGhyb3dEaXN0TWluID0gMC4wCgogICAgCmNsYXNzIEJvbWJlckJvdFN0YXRpYyhCb21iZXJCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSB2ZXJzaW9uIG9mIGJzLkJvbWJlckJvdAogICAgd2hvIGdlbmVyYWxseSBzdGF5cyBpbiBvbmUgcGxhY2UuCiAgICAiIiIKICAgIHN0YXRpYyA9IFRydWUKICAgIHRocm93RGlzdE1pbiA9IDAuMAoKCmNsYXNzIEJvbWJlckJvdFBybyhCb21iZXJCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBtb3JlIGFnZ3Jlc3NpdmUgcmVkIHZlcnNpb24gb2YgYnMuQm9tYmVyQm90LgogICAgIiIiCiAgICBwb2ludHNNdWx0ID0gMgogICAgY29sb3I9Z1Byb0JvdENvbG9yCiAgICBoaWdobGlnaHQgPSBnUHJvQm90SGlnaGxpZ2h0CiAgICBkZWZhdWx0Qm9tYkNvdW50ID0gNQogICAgZGVmYXVsdEJveGluZ0dsb3ZlcyA9IFRydWUKICAgIHB1bmNoaW5lc3MgPSAwLjc4CiAgICB0aHJvd1JhdGUgPSAxLjMKICAgIHJ1biA9IFRydWUKICAgIHJ1bkRpc3RNaW4gPSA2LjAKICAgIGRlZmF1bHRCb21iVHlwZSA9ICdub3JtYWwnCgogICAgCmNsYXNzIEJvbWJlckJvdFByb1NoaWVsZGVkKEJvbWJlckJvdFBybyk6CiAgICBwb2ludHNNdWx0ID0gMwogICAgZGVmYXVsdFNoaWVsZHMgPSBUcnVlCgogICAgCmNsYXNzIEJvbWJlckJvdFByb1N0YXRpYyhCb21iZXJCb3RQcm8pOgogICAgc3RhdGljID0gVHJ1ZQogICAgdGhyb3dEaXN0TWluID0gMC4wCgpjbGFzcyBCb21iZXJCb3RQcm9TdGF0aWNTaGllbGRlZChCb21iZXJCb3RQcm9TaGllbGRlZCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIG1vcmUgYWdncmVzc2l2ZSByZWQgdmVyc2lvbiBvZiBicy5Cb21iZXJCb3QKICAgIHdobyBzdGFydHMgd2l0aCBzaGllbGRzIGFuZAogICAgd2hvIGdlbmVyYWxseSBzdGF5cyBpbiBvbmUgcGxhY2UuCiAgICAiIiIKICAgIHN0YXRpYyA9IFRydWUKICAgIHRocm93RGlzdE1pbiA9IDAuMAoKICAgIApjbGFzcyBUb3VnaEd1eUJvdChTcGF6Qm90KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEJvdCBDbGFzc2VzCiAgICAKICAgIEEgbWFubHkgYm90IHdobyB3YWxrcyBhbmQgcHVuY2hlcyB0aGluZ3MuCiAgICAiIiIKICAgIGNoYXJhY3RlciA9ICdLcm9uaycKICAgIHB1bmNoaW5lc3MgPSAwLjkKICAgIGNoYXJnZURpc3RNYXggPSA5OTk5LjAKICAgIGNoYXJnZVNwZWVkTWluID0gMS4wCiAgICBjaGFyZ2VTcGVlZE1heCA9IDEuMAogICAgdGhyb3dEaXN0TWluID0gOTk5OQogICAgdGhyb3dEaXN0TWF4ID0gOTk5OQoKICAgIApjbGFzcyBUb3VnaEd1eUJvdExhbWUoVG91Z2hHdXlCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBsZXNzIGFnZ3Jlc3NpdmUgeWVsbG93IHZlcnNpb24gb2YgYnMuVG91Z2hHdXlCb3QuCiAgICAiIiIKICAgIGNvbG9yPWdMYW1lQm90Q29sb3IKICAgIGhpZ2hsaWdodD1nTGFtZUJvdEhpZ2hsaWdodAogICAgcHVuY2hpbmVzcyA9IDAuNwogICAgY2hhcmdlU3BlZWRNaW4gPSAwLjYKICAgIGNoYXJnZVNwZWVkTWF4ID0gMC42CgogICAgCmNsYXNzIFRvdWdoR3V5Qm90UHJvKFRvdWdoR3V5Qm90KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEJvdCBDbGFzc2VzCiAgICAKICAgIEEgbW9yZSBhZ2dyZXNzaXZlIHJlZCB2ZXJzaW9uIG9mIGJzLlRvdWdoR3V5Qm90LgogICAgIiIiCiAgICBjb2xvcj1nUHJvQm90Q29sb3IKICAgIGhpZ2hsaWdodD1nUHJvQm90SGlnaGxpZ2h0CiAgICBydW4gPSBUcnVlCiAgICBydW5EaXN0TWluID0gNC4wCiAgICBkZWZhdWx0Qm94aW5nR2xvdmVzID0gVHJ1ZQogICAgcHVuY2hpbmVzcyA9IDIKICAgIHBvaW50c011bHQgPSAyCgogICAgCmNsYXNzIFRvdWdoR3V5Qm90UHJvU2hpZWxkZWQoVG91Z2hHdXlCb3RQcm8pOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBtb3JlIGFnZ3Jlc3NpdmUgdmVyc2lvbiBvZiBicy5Ub3VnaEd1eUJvdAogICAgd2hvIHN0YXJ0cyB3aXRoIHNoaWVsZHMuCiAgICAiIiIKICAgIGRlZmF1bHRTaGllbGRzID0gVHJ1ZQogICAgcG9pbnRzTXVsdCA9IDMKCiAgICAKY2xhc3MgTmluamFCb3QoU3BhekJvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIHNwZWVkeSBhdHRhY2tpbmcgbWVsZWUgYm90LgogICAgIiIiCgogICAgY2hhcmFjdGVyID0gJ1NuYWtlIFNoYWRvdycKICAgIHB1bmNoaW5lc3MgPSAxLjUKICAgIHJ1biA9IFRydWUKICAgIGNoYXJnZURpc3RNaW4gPSAxMC4wCiAgICBjaGFyZ2VEaXN0TWF4ID0gOTk5OS4wCiAgICBjaGFyZ2VTcGVlZE1pbiA9IDEuMAogICAgY2hhcmdlU3BlZWRNYXggPSAxLjAKICAgIHRocm93RGlzdE1pbiA9IDk5OTkKICAgIHRocm93RGlzdE1heCA9IDk5OTkKICAgIHBvaW50c011bHQgPSAyCgogICAgCmNsYXNzIEJ1bm55Qm90KFNwYXpCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBzcGVlZHkgYXR0YWNraW5nIG1lbGVlIGJvdC4KICAgICIiIgoKICAgIGNvbG9yPSgxLCAxLCAxKQogICAgaGlnaGxpZ2h0PSgxLjAsIDAuNSwgMC41KQogICAgY2hhcmFjdGVyID0gJ0Vhc3RlciBCdW5ueScKICAgIHB1bmNoaW5lc3MgPSAxLjAKICAgIHJ1biA9IFRydWUKICAgIGJvdW5jeSA9IFRydWUKICAgIGRlZmF1bHRCb3hpbmdHbG92ZXMgPSBUcnVlCiAgICBjaGFyZ2VEaXN0TWluID0gMTAuMAogICAgY2hhcmdlRGlzdE1heCA9IDk5OTkuMAogICAgY2hhcmdlU3BlZWRNaW4gPSAxLjAKICAgIGNoYXJnZVNwZWVkTWF4ID0gMS4wCiAgICB0aHJvd0Rpc3RNaW4gPSA5OTk5CiAgICB0aHJvd0Rpc3RNYXggPSA5OTk5CiAgICBwb2ludHNNdWx0ID0gMgogIApjbGFzcyBOaW5qYUJvdFBybyhOaW5qYUJvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIG1vcmUgYWdncmVzc2l2ZSByZWQgYnMuTmluamFCb3QuCiAgICAiIiIKICAgIGNvbG9yPWdQcm9Cb3RDb2xvcgogICAgaGlnaGxpZ2h0PWdQcm9Cb3RIaWdobGlnaHQKICAgIGRlZmF1bHRTaGllbGRzID0gVHJ1ZQogICAgZGVmYXVsdEJveGluZ0dsb3ZlcyA9IFRydWUKICAgIHBvaW50c011bHQgPSAzCgogICAgCmNsYXNzIE5pbmphQm90UHJvU2hpZWxkZWQoTmluamFCb3RQcm8pOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBtb3JlIGFnZ3Jlc3NpdmUgcmVkIGJzLk5pbmphQm90CiAgICB3aG8gc3RhcnRzIHdpdGggc2hpZWxkcy4KICAgICIiIgogICAgZGVmYXVsdFNoaWVsZHMgPSBUcnVlCiAgICBwb2ludHNNdWx0ID0gNAoKICAgIApjbGFzcyBDaGlja0JvdChTcGF6Qm90KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEJvdCBDbGFzc2VzCiAgICAKICAgIEEgc2xvdyBtb3ZpbmcgYm90IHdpdGggaW1wYWN0IGJvbWJzLgogICAgIiIiCiAgICBjaGFyYWN0ZXIgPSAnWm9lJwogICAgcHVuY2hpbmVzcyA9IDAuNzUKICAgIHRocm93aW5lc3MgPSAwLjcKICAgIGNoYXJnZURpc3RNYXggPSAxLjAKICAgIGNoYXJnZVNwZWVkTWluID0gMC4zCiAgICBjaGFyZ2VTcGVlZE1heCA9IDAuNQogICAgdGhyb3dEaXN0TWluID0gMy41CiAgICB0aHJvd0Rpc3RNYXggPSA1LjUKICAgIGRlZmF1bHRCb21iVHlwZSA9ICdpbXBhY3QnCiAgICBwb2ludHNNdWx0ID0gMgoKICAgIApjbGFzcyBDaGlja0JvdFN0YXRpYyhDaGlja0JvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIGJzLkNoaWNrQm90IHdobyBnZW5lcmFsbHkgc3RheXMgaW4gb25lIHBsYWNlLgogICAgIiIiCiAgICBzdGF0aWMgPSBUcnVlCiAgICB0aHJvd0Rpc3RNaW4gPSAwLjAKCiAgICAKY2xhc3MgQ2hpY2tCb3RQcm8oQ2hpY2tCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBtb3JlIGFnZ3Jlc3NpdmUgcmVkIHZlcnNpb24gb2YgYnMuQ2hpY2tCb3QuCiAgICAiIiIKICAgIGNvbG9yPWdQcm9Cb3RDb2xvcgogICAgaGlnaGxpZ2h0PWdQcm9Cb3RIaWdobGlnaHQKICAgIGRlZmF1bHRCb21iQ291bnQgPSA5CiAgICBkZWZhdWx0Qm94aW5nR2xvdmVzID0gVHJ1ZQogICAgY2hhcmdlU3BlZWRNaW4gPSAwLjIKICAgIGNoYXJnZVNwZWVkTWF4ID0gMC4zCiAgICBwdW5jaGluZXNzID0gMC45CiAgICB0aHJvd1JhdGUgPSAzCiAgICBydW4gPSBUcnVlCiAgICBydW5EaXN0TWluID0gNi4wCiAgICBwb2ludHNNdWx0ID0gMwoKICAgIApjbGFzcyBDaGlja0JvdFByb1NoaWVsZGVkKENoaWNrQm90UHJvKToKICAgICIiIgogICAgY2F0ZWdvcnk6IEJvdCBDbGFzc2VzCiAgICAKICAgIEEgbW9yZSBhZ2dyZXNzaXZlIHJlZCB2ZXJzaW9uIG9mIGJzLkNoaWNrQm90CiAgICB3aG8gc3RhcnRzIHdpdGggc2hpZWxkcy4KICAgICIiIgogICAgZGVmYXVsdFNoaWVsZHMgPSBUcnVlCiAgICBwb2ludHNNdWx0ID0gNAoKICAgIApjbGFzcyBNZWxCb3QoU3BhekJvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIGNyYXp5IGJvdCB3aG8gcnVucyBhbmQgdGhyb3dzIHN0aWNreSBib21icy4KICAgICIiIgogICAgY2hhcmFjdGVyID0gJ01lbCcKICAgIHB1bmNoaW5lc3MgPSAwLjkKICAgIHRocm93aW5lc3MgPSAxLjAKICAgIHJ1biA9IFRydWUKICAgIGNoYXJnZURpc3RNaW4gPSA0LjAKICAgIGNoYXJnZURpc3RNYXggPSAxMC4wCiAgICBjaGFyZ2VTcGVlZE1pbiA9IDEuMAogICAgY2hhcmdlU3BlZWRNYXggPSAxLjAKICAgIHRocm93RGlzdE1pbiA9IDAuMAogICAgdGhyb3dEaXN0TWF4ID0gNC4wCiAgICB0aHJvd1JhdGUgPSAxLjMKICAgIGRlZmF1bHRCb21iVHlwZSA9ICdzdGlja3knCiAgICBkZWZhdWx0Qm9tYkNvdW50ID0gNQogICAgcG9pbnRzTXVsdCA9IDMKCiAgICAKY2xhc3MgTWVsQm90U3RhdGljKE1lbEJvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIGNyYXp5IGJvdCB3aG8gdGhyb3dzIHN0aWNreS1ib21icyBidXQgZ2VuZXJhbGx5IHN0YXlzIGluIG9uZSBwbGFjZS4KICAgICIiIgogICAgc3RhdGljID0gVHJ1ZQoKICAgIApjbGFzcyBQaXJhdGVCb3QoU3BhekJvdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIGJvdCB3aG8gcnVucyBhbmQgZXhwbG9kZXMgaW4gNSBzZWNvbmRzLgogICAgIiIiCiAgICBjaGFyYWN0ZXIgPSAnSmFjayBNb3JnYW4nCiAgICBydW4gPSBUcnVlCiAgICBjaGFyZ2VEaXN0TWluID0gMC4wCiAgICBjaGFyZ2VEaXN0TWF4ID0gOTk5OQogICAgY2hhcmdlU3BlZWRNaW4gPSAxLjAKICAgIGNoYXJnZVNwZWVkTWF4ID0gMS4wCiAgICB0aHJvd0Rpc3RNaW4gPSA5OTk5CiAgICB0aHJvd0Rpc3RNYXggPSA5OTk5CiAgICBzdGFydEN1cnNlZCA9IFRydWUKICAgIHBvaW50c011bHQgPSA0CiAgICAKICAgIApjbGFzcyBQYXJ0eUJvdChTcGF6Qm90KToKICAgIGNoYXJhY3RlciA9ICdKYWNrIE1vcmdhbicKICAgIHBvaW50c011bHQgPSAwCiAgICBocCA9IDk5OTk5OTk5OTkKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBTcGF6Qm90Ll9faW5pdF9fKHNlbGYpCiAgICAgICAgZGVmIGNlbGVicmF0ZV9mbGV4KCk6CiAgICAgICAgICAgIGlmIHNlbGYubm9kZSBpcyBub3QgTm9uZSBhbmQgc2VsZi5ub2RlLmV4aXN0cygpOiAKICAgICAgICAgICAgICAgIHNlbGYubm9kZS5oYW5kbGVNZXNzYWdlKCJjZWxlYnJhdGUiLCAxMDAwKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnX2ZsZXgnKSBhbmQgc2VsZi5fZmxleCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9mbGV4ID0gTm9uZQogICAgICAgIGRlZiBqdW1wc19kYW5jZTIoKToKICAgICAgICAgICAgaWYgc2VsZi5ub2RlIGlzIG5vdCBOb25lIGFuZCBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuanVtcFByZXNzZWQgPSBUcnVlCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuanVtcFByZXNzZWQgPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAnX2RhbmNlMicpIGFuZCBzZWxmLl9kYW5jZTIgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5fZGFuY2UyID0gTm9uZQogICAgICAgIHNlbGYuX2ZsZXggPSBicy5UaW1lcigxMDAwLCBicy5DYWxsKGNlbGVicmF0ZV9mbGV4KSwgcmVwZWF0PVRydWUpCiAgICAgICAgc2VsZi5fZGFuY2UyID0gYnMuVGltZXIoNTAwLCBicy5DYWxsKGp1bXBzX2RhbmNlMiksIHJlcGVhdD1UcnVlKQogICAgICAgIGNlbGVicmF0ZV9mbGV4KCkKICAgICAgICBqdW1wc19kYW5jZTIoKQogICAgZGVmIF91cGRhdGVBSShzZWxmKToKICAgICAgICBwYXNzCiAgICAgICAgICAgIApjbGFzcyBUZXN0KG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CgkgICAgc2VsZi5odXJ0ID0gMQoJICAgIHNlbGYucmFkaXVzID0gMQoJICAgIHNlbGYuYWx3YXlzU2hvd0hlYWx0aEJhciA9IEZhbHNlCiAgICBkZWYgZGVsZXRlKHNlbGYpOgogICAgICAgIHBhc3MKICAgIGRlZiBleGlzdHMoc2VsZik6CiAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgCmNsYXNzIEZyb3plbkJvdChTcGF6Qm90KToKICAgIGNoYXJhY3RlciA9ICdTcGF6JwogICAgY2hhcmdlRGlzdE1pbiA9IDAuMAogICAgY2hhcmdlRGlzdE1heCA9IDk5OTkKICAgIGNoYXJnZVNwZWVkTWluID0gMS4wCiAgICBjaGFyZ2VTcGVlZE1heCA9IDEuMAogICAgdGhyb3dEaXN0TWluID0gOTk5OQogICAgdGhyb3dEaXN0TWF4ID0gOTk5OQogICAgc3RhcnRDdXJzZWQgPSBGYWxzZQogICAgc3RhdGljID0gVHJ1ZQogICAgcG9pbnRzTXVsdCA9IDAKICAgIGhwID0gLTEKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBTcGF6Qm90Ll9faW5pdF9fKHNlbGYpCiAgICAgICAgc2VsZi5ub2RlLmZyb3plbiA9IDEKICAgICAgICBzZWxmLmZyb3plbiA9IHNlbGYuc2hhdHRlcmVkID0gVHJ1ZQogICAgICAgIHNlbGYuX2RlYWQgPSBUcnVlCiAgICAgICAgc2VsZi5zaGllbGQgPSBUZXN0KCkKICAgICAgICBkZWYgaGVhbF9zaGllbGQoKToKICAgICAgICAgICAgaWYgc2VsZi5ub2RlIGlzIG5vdCBOb25lIGFuZCBzZWxmLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBzZWxmLnNoaWVsZEhpdFBvaW50cyA9IHNlbGYuc2hpZWxkSGl0UG9pbnRzTWF4ID0gMTAwMDAwMDAwMDAwMAogICAgICAgICAgICBlbHNlOiAKICAgICAgICAgICAgICAgIGlmIGhhc2F0dHIoc2VsZiwgJ19oZWFsX3NoaWVsZCcpIGFuZCBzZWxmLl9oZWFsX3NoaWVsZCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICBzZWxmLl9oZWFsX3NoaWVsZCA9IE5vbmUKICAgICAgICBzZWxmLl9oZWFsX3NoaWVsZCA9IGJzLlRpbWVyKDUwMDAsIGJzLkNhbGwoaGVhbF9zaGllbGQpLCByZXBlYXQ9VHJ1ZSkKICAgICAgICBoZWFsX3NoaWVsZCgpCiAgICBkZWYgX3VwZGF0ZUFJKHNlbGYpOgogICAgICAgIHBhc3MKICAgICAgICAKY2xhc3MgRnJvemVuQ2hpY2tCb3QoRnJvemVuQm90KToKCWNoYXJhY3RlciA9ICdab2UnCgpjbGFzcyBGcm96ZW5QaXJhdGVCb3QoRnJvemVuQm90KToKCWNoYXJhY3RlciA9ICdKYWNrIE1vcmdhbicKCQpjbGFzcyBGcm96ZW5CdW5ueUJvdChGcm96ZW5Cb3QpOgoJY2hhcmFjdGVyID0gJ0Vhc3RlciBCdW5ueScKICAgIApjbGFzcyBQaXJhdGVCb3ROb1RpbWVMaW1pdChQaXJhdGVCb3QpOgogICAgIiIiCiAgICBjYXRlZ29yeTogQm90IENsYXNzZXMKICAgIAogICAgQSBib3Qgd2hvIHJ1bnMgYnV0IGRvZXMgbm90IGV4cGxvZGUgb24gaGlzIG93bi4KICAgICIiIgogICAgY3Vyc2VUaW1lID0gLTEKCiAgICAKY2xhc3MgUGlyYXRlQm90U2hpZWxkZWQoUGlyYXRlQm90KToKICAgICIiIgogICAgY2F0ZWdvcnk6IEJvdCBDbGFzc2VzCiAgICAKICAgIEEgYnMuUGlyYXRlQm90IHdobyBzdGFydHMgd2l0aCBzaGllbGRzLgogICAgIiIiCiAgICBkZWZhdWx0U2hpZWxkcyA9IFRydWUKICAgIHBvaW50c011bHQgPSA1CiAgICAKY2xhc3MgQm90U2V0KG9iamVjdCk6CiAgICAiIiIKICAgIGNhdGVnb3J5OiBCb3QgQ2xhc3NlcwogICAgCiAgICBBIGNvbnRhaW5lci9jb250cm9sbGVyIGZvciBvbmUgb3IgbW9yZSBicy5TcGF6Qm90cy4KICAgICIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIENyZWF0ZSBhIGJvdC1zZXQuCiAgICAgICAgIiIiCiAgICAgICAgIyB3ZSBzcHJlYWQgb3VyIGJvdHMgb3V0IG92ZXIgYSBmZXcgbGlzdHMgc28gd2UgY2FuIHVwZGF0ZQogICAgICAgICMgdGhlbSBpbiBhIHN0YWdnZXJlZCBmYXNoaW9uCiAgICAgICAgc2VsZi5fYm90TGlzdENvdW50ID0gNQogICAgICAgIHNlbGYuX2JvdEFkZExpc3QgPSAwCiAgICAgICAgc2VsZi5fYm90VXBkYXRlTGlzdCA9IDAKICAgICAgICBzZWxmLl9ib3RMaXN0cyA9IFtbXSBmb3IgaSBpbiByYW5nZShzZWxmLl9ib3RMaXN0Q291bnQpXQogICAgICAgIHNlbGYuX3NwYXduU291bmQgPSBicy5nZXRTb3VuZCgnc3Bhd24nKQogICAgICAgIHNlbGYuX3NwYXduaW5nQ291bnQgPSAwCiAgICAgICAgc2VsZi5zdGFydE1vdmluZygpCgogICAgZGVmIF9fZGVsX18oc2VsZik6CiAgICAgICAgc2VsZi5jbGVhcigpCgogICAgZGVmIHNwYXduQm90KHNlbGYsIGJvdFR5cGUsIHBvcywgc3Bhd25UaW1lPTMwMDAsIG9uU3Bhd25DYWxsPU5vbmUpOgogICAgICAgICIiIgogICAgICAgIFNwYXduIGEgYm90IGZyb20gdGhpcyBzZXQuCiAgICAgICAgIiIiCiAgICAgICAgYnNVdGlscy5TcGF3bmVyKHB0PXBvcywgc3Bhd25UaW1lPXNwYXduVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFNwYXduTWVzc2FnZT1GYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgc3Bhd25DYWxsYmFjaz1icy5DYWxsKHNlbGYuX3NwYXduQm90LCBib3RUeXBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zLCBvblNwYXduQ2FsbCkpCiAgICAgICAgc2VsZi5fc3Bhd25pbmdDb3VudCArPSAxCgogICAgZGVmIF9zcGF3bkJvdChzZWxmLCBib3RUeXBlLCBwb3MsIG9uU3Bhd25DYWxsKToKICAgICAgICBzcGF6ID0gYm90VHlwZSgpCiAgICAgICAgdHJ5OiBicy5wbGF5U291bmQoc2VsZi5fc3Bhd25Tb3VuZCwgcG9zaXRpb249cG9zKQogICAgICAgIGV4Y2VwdDogcGFzcwogICAgICAgIHNwYXoubm9kZS5oYW5kbGVNZXNzYWdlKCJmbGFzaCIpCiAgICAgICAgc3Bhei5ub2RlLmlzQXJlYU9mSW50ZXJlc3QgPSAwCiAgICAgICAgc3Bhei5oYW5kbGVNZXNzYWdlKGJzLlN0YW5kTWVzc2FnZShwb3MsIHJhbmRvbS51bmlmb3JtKDAsIDM2MCkpKQogICAgICAgIHNlbGYuYWRkQm90KHNwYXopCiAgICAgICAgc2VsZi5fc3Bhd25pbmdDb3VudCAtPSAxCiAgICAgICAgaWYgb25TcGF3bkNhbGwgaXMgbm90IE5vbmU6IG9uU3Bhd25DYWxsKHNwYXopCiAgICAgICAgCiAgICBkZWYgaGF2ZUxpdmluZ0JvdHMoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgUmV0dXJucyB3aGV0aGVyIGFueSBib3RzIGluIHRoZSBzZXQgYXJlIGFsaXZlIG9yIHNwYXduaW5nLgogICAgICAgICIiIgogICAgICAgIGhhdmVMaXZpbmcgPSBhbnkoKGFueSgobm90IGEuX2RlYWQgZm9yIGEgaW4gbCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGwgaW4gc2VsZi5fYm90TGlzdHMpKQogICAgICAgIGhhdmVTcGF3bmluZyA9IFRydWUgaWYgc2VsZi5fc3Bhd25pbmdDb3VudCA+IDAgZWxzZSBGYWxzZQogICAgICAgIHJldHVybiAoaGF2ZUxpdmluZyBvciBoYXZlU3Bhd25pbmcpCgoKICAgIGRlZiBnZXRMaXZpbmdCb3RzKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIFJldHVybnMgdGhlIGxpdmluZyBib3RzIGluIHRoZSBzZXQuCiAgICAgICAgIiIiCiAgICAgICAgYm90cyA9IFtdCiAgICAgICAgZm9yIGwgaW4gc2VsZi5fYm90TGlzdHM6CiAgICAgICAgICAgIGZvciBiIGluIGw6CiAgICAgICAgICAgICAgICBpZiBub3QgYi5fZGVhZDogYm90cy5hcHBlbmQoYikKICAgICAgICByZXR1cm4gYm90cwoKICAgIGRlZiBfdXBkYXRlKHNlbGYpOgoKICAgICAgICAjIHVwZGF0ZSBvbmUgb2Ygb3VyIGJvdCBsaXN0cyBlYWNoIHRpbWUgdGhyb3VnaC4uCiAgICAgICAgIyBmaXJzdCBvZmYsIHJlbW92ZSBkZWFkIGJvdHMgZnJvbSB0aGUgbGlzdAogICAgICAgICMgKHdlIGNoZWNrIGV4aXN0cygpIGhlcmUgaW5zdGVhZCBvZiBkZWFkLi4gd2Ugd2FudCB0byBrZWVwIHRoZW0KICAgICAgICAjIGFyb3VuZCBldmVuIGlmIHRoZXkncmUganVzdCBhIGNvcnBzZSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIGJvdExpc3QgPSBzZWxmLl9ib3RMaXN0c1tzZWxmLl9ib3RVcGRhdGVMaXN0XSA9IFwKICAgICAgICAgICAgICAgIFtiIGZvciBiIGluIHNlbGYuX2JvdExpc3RzW3NlbGYuX2JvdFVwZGF0ZUxpc3RdIGlmIGIuZXhpc3RzKCldCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgYnMucHJpbnRFeGNlcHRpb24oImVycm9yIHVwZGF0aW5nIGJvdCBsaXN0OiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICtzdHIoc2VsZi5fYm90TGlzdHNbc2VsZi5fYm90VXBkYXRlTGlzdF0pKQogICAgICAgIHNlbGYuX2JvdFVwZGF0ZUxpc3QgPSAoc2VsZi5fYm90VXBkYXRlTGlzdCsxKSVzZWxmLl9ib3RMaXN0Q291bnQKCiAgICAgICAgIyB1cGRhdGUgb3VyIGxpc3Qgb2YgcGxheWVyIHBvaW50cyBmb3IgdGhlIGJvdHMgdG8gdXNlCiAgICAgICAgcGxheWVyUHRzID0gW10KICAgICAgICBmb3IgcGxheWVyIGluIGJzLmdldEFjdGl2aXR5KCkucGxheWVyczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgcGxheWVyLmlzQWxpdmUoKToKICAgICAgICAgICAgICAgICAgICBwbGF5ZXJQdHMuYXBwZW5kKChicy5WZWN0b3IoKnBsYXllci5hY3Rvci5ub2RlLnBvc2l0aW9uKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLlZlY3RvcigqcGxheWVyLmFjdG9yLm5vZGUudmVsb2NpdHkpKSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgIGJzLnByaW50RXhjZXB0aW9uKCdlcnJvciBvbiBib3Qtc2V0IF91cGRhdGUnKQoKICAgICAgICBmb3IgYiBpbiBib3RMaXN0OgogICAgICAgICAgICBiLl9zZXRQbGF5ZXJQdHMocGxheWVyUHRzKQogICAgICAgICAgICBiLl91cGRhdGVBSSgpCgogICAgZGVmIGNsZWFyKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIEltbWVkaWF0ZWx5IGNsZWFyIG91dCBhbnkgYm90cyBpbiB0aGUgc2V0LgogICAgICAgICIiIgogICAgICAgICMgZG9udCBkbyB0aGlzIGlmIHRoZSBhY3Rpdml0eSBpcyBzaHV0dGluZyBkb3duIG9yIGRlYWQKICAgICAgICBhY3Rpdml0eSA9IGJzLmdldEFjdGl2aXR5KGV4Y2VwdGlvbk9uTm9uZT1GYWxzZSkKICAgICAgICBpZiBhY3Rpdml0eSBpcyBOb25lIG9yIGFjdGl2aXR5LmlzRmluYWxpemVkKCk6IHJldHVybgogICAgICAgIAogICAgICAgIGZvciBpIGluIHJhbmdlKGxlbihzZWxmLl9ib3RMaXN0cykpOgogICAgICAgICAgICBmb3IgYiBpbiBzZWxmLl9ib3RMaXN0c1tpXToKICAgICAgICAgICAgICAgIGIuaGFuZGxlTWVzc2FnZShicy5EaWVNZXNzYWdlKGltbWVkaWF0ZT1UcnVlKSkKICAgICAgICAgICAgc2VsZi5fYm90TGlzdHNbaV0gPSBbXQogICAgICAgIAogICAgZGVmIGNlbGVicmF0ZShzZWxmLCBkdXJhdGlvbik6CiAgICAgICAgIiIiCiAgICAgICAgVGVsbCBhbGwgbGl2aW5nIGJvdHMgaW4gdGhlIHNldCB0byBjZWxlYnJhdGUgbW9tZW50YXJpbHkKICAgICAgICB3aGlsZSBjb250aW51aW5nIG9ud2FyZCB3aXRoIHRoZWlyIGV2aWwgYm90IGFjdGl2aXRpZXMuCiAgICAgICAgIiIiCiAgICAgICAgZm9yIGwgaW4gc2VsZi5fYm90TGlzdHM6CiAgICAgICAgICAgIGZvciBiIGluIGw6CiAgICAgICAgICAgICAgICBpZiBiLm5vZGUuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICAgICAgYi5ub2RlLmhhbmRsZU1lc3NhZ2UoJ2NlbGVicmF0ZScsIGR1cmF0aW9uKQoKICAgIGRlZiBzdGFydE1vdmluZyhzZWxmKToKICAgICAgICAiIiIKICAgICAgICBTdGFydHMgcHJvY2Vzc2luZyBib3QgQUkgdXBkYXRlcyBhbmQgbGV0IHRoZW0gc3RhcnQgZG9pbmcgdGhlaXIgdGhpbmcuCiAgICAgICAgIiIiCiAgICAgICAgc2VsZi5fYm90VXBkYXRlVGltZXIgPSBicy5UaW1lcig1MCwgYnMuV2Vha0NhbGwoc2VsZi5fdXBkYXRlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGVhdD1UcnVlKQogICAgICAgICAgICAgICAgICAgIAogICAgZGVmIHN0b3BNb3Zpbmcoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgVGVsbCBhbGwgYm90cyB0byBzdG9wIG1vdmluZyBhbmQgc3RvcHMKICAgICAgICB1cGRhdGluZyB0aGVpciBBSS4KICAgICAgICBVc2VmdWwgd2hlbiBwbGF5ZXJzIGhhdmUgd29uIGFuZCB5b3Ugd2FudCB0aGUKICAgICAgICBlbmVteSBib3RzIHRvIGp1c3Qgc3RhbmQgYW5kIGxvb2sgYmV3aWxkZXJlZC4KICAgICAgICAiIiIKICAgICAgICBzZWxmLl9ib3RVcGRhdGVUaW1lciA9IE5vbmUKICAgICAgICBmb3IgbCBpbiBzZWxmLl9ib3RMaXN0czoKICAgICAgICAgICAgZm9yIGIgaW4gbDoKICAgICAgICAgICAgICAgIGlmIGIubm9kZS5leGlzdHMoKToKICAgICAgICAgICAgICAgICAgICBiLm5vZGUubW92ZUxlZnRSaWdodCA9IDAKICAgICAgICAgICAgICAgICAgICBiLm5vZGUubW92ZVVwRG93biA9IDAKICAgICAgICAKICAgIGRlZiBmaW5hbENlbGVicmF0ZShzZWxmKToKICAgICAgICAiIiIKICAgICAgICBUZWxsIGFsbCBib3RzIGluIHRoZSBzZXQgdG8gc3RvcCB3aGF0IHRoZXkgd2VyZSBkb2luZwogICAgICAgIGFuZCBqdXN0IGp1bXAgYXJvdW5kIGFuZCBjZWxlYnJhdGUuICBVc2UgdGhpcyB3aGVuCiAgICAgICAgdGhlIGJvdHMgaGF2ZSB3b24gYSBnYW1lLgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2JvdFVwZGF0ZVRpbWVyID0gTm9uZQogICAgICAgICMgYXQgdGhpcyBwb2ludCBzdG9wIGRvaW5nIGFueXRoaW5nIGJ1dCBqdW1waW5nIGFuZCBjZWxlYnJhdGluZwogICAgICAgIGZvciBsIGluIHNlbGYuX2JvdExpc3RzOgogICAgICAgICAgICBmb3IgYiBpbiBsOgogICAgICAgICAgICAgICAgaWYgYi5ub2RlLmV4aXN0cygpOgogICAgICAgICAgICAgICAgICAgIGIubm9kZS5tb3ZlTGVmdFJpZ2h0ID0gMAogICAgICAgICAgICAgICAgICAgIGIubm9kZS5tb3ZlVXBEb3duID0gMAogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcihyYW5kb20ucmFuZHJhbmdlKDAsIDUwMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLkNhbGwoYi5ub2RlLmhhbmRsZU1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NlbGVicmF0ZScsIDEwMDAwKSkKICAgICAgICAgICAgICAgICAgICBqdW1wRHVyYXRpb24gPSByYW5kb20ucmFuZHJhbmdlKDQwMCwgNTAwKQogICAgICAgICAgICAgICAgICAgIGogPSByYW5kb20ucmFuZHJhbmdlKDAsIDIwMCkKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgxMCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGIubm9kZS5qdW1wUHJlc3NlZCA9IFRydWUKICAgICAgICAgICAgICAgICAgICAgICAgYi5ub2RlLmp1bXBQcmVzc2VkID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgaiArPSBqdW1wRHVyYXRpb24KICAgICAgICAgICAgICAgICAgICBicy5nYW1lVGltZXIocmFuZG9tLnJhbmRyYW5nZSgwLCAxMDAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnMuQ2FsbChiLm5vZGUuaGFuZGxlTWVzc2FnZSwgJ2F0dGFja1NvdW5kJykpCiAgICAgICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKHJhbmRvbS5yYW5kcmFuZ2UoMTAwMCwgMjAwMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzLkNhbGwoYi5ub2RlLmhhbmRsZU1lc3NhZ2UsICdhdHRhY2tTb3VuZCcpKQogICAgICAgICAgICAgICAgICAgIGJzLmdhbWVUaW1lcihyYW5kb20ucmFuZHJhbmdlKDIwMDAsIDMwMDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicy5DYWxsKGIubm9kZS5oYW5kbGVNZXNzYWdlLCAnYXR0YWNrU291bmQnKSkKCiAgICBkZWYgYWRkQm90KHNlbGYsIGJvdCk6CiAgICAgICAgIiIiCiAgICAgICAgQWRkIGEgYnMuU3BhekJvdCBpbnN0YW5jZSB0byB0aGUgc2V0LgogICAgICAgICIiIgogICAgICAgIHNlbGYuX2JvdExpc3RzW3NlbGYuX2JvdEFkZExpc3RdLmFwcGVuZChib3QpCiAgICAgICAgc2VsZi5fYm90QWRkTGlzdCA9IChzZWxmLl9ib3RBZGRMaXN0KzEpJXNlbGYuX2JvdExpc3RDb3VudAoKIyBkZWZpbmUgb3VyIGJ1aWx0LWluIGNoYXJhY3RlcnMuLi4KCiMjIyMjIyMjIyMjIyMjIyAgU1BBWiAgICMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiU3BheiIpCgp0LmNvbG9yVGV4dHVyZSA9ICJuZW9TcGF6Q29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJuZW9TcGF6Q29sb3JNYXNrIgoKdC5pY29uVGV4dHVyZSA9ICJuZW9TcGF6SWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAibmVvU3Bhekljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICJuZW9TcGF6SGVhZCIKdC50b3Jzb01vZGVsID0gIm5lb1NwYXpUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICJuZW9TcGF6UGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAibmVvU3BhelVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICJuZW9TcGF6Rm9yZUFybSIKdC5oYW5kTW9kZWwgPSAibmVvU3BhekhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJuZW9TcGF6VXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJuZW9TcGF6TG93ZXJMZWciCnQudG9lc01vZGVsID0gIm5lb1NwYXpUb2VzIgoKdC5qdW1wU291bmRzPVsic3Bhekp1bXAwMSIsCiAgICAgICAgICAgICAgInNwYXpKdW1wMDIiLAogICAgICAgICAgICAgICJzcGF6SnVtcDAzIiwKICAgICAgICAgICAgICAic3Bhekp1bXAwNCJdCnQuYXR0YWNrU291bmRzPVsic3BhekF0dGFjazAxIiwKICAgICAgICAgICAgICAgICJzcGF6QXR0YWNrMDIiLAogICAgICAgICAgICAgICAgInNwYXpBdHRhY2swMyIsCiAgICAgICAgICAgICAgICAic3BhekF0dGFjazA0Il0KdC5pbXBhY3RTb3VuZHM9WyJzcGF6SW1wYWN0MDEiLAogICAgICAgICAgICAgICAgInNwYXpJbXBhY3QwMiIsCiAgICAgICAgICAgICAgICAic3BhekltcGFjdDAzIiwKICAgICAgICAgICAgICAgICJzcGF6SW1wYWN0MDQiXQp0LmRlYXRoU291bmRzPVsic3BhekRlYXRoMDEiXQp0LnBpY2t1cFNvdW5kcz1bInNwYXpQaWNrdXAwMSJdCnQuZmFsbFNvdW5kcz1bInNwYXpGYWxsMDEiXQoKdC5zdHlsZSA9ICdzcGF6JwoKCiMjIyMjIyMjIyMjIyMjIyAgWm9lICAgIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJab2UiKQoKdC5jb2xvclRleHR1cmUgPSAiem9lQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJ6b2VDb2xvck1hc2siCgp0LmRlZmF1bHRDb2xvciA9ICgwLjYsIDAuNiwgMC42KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMCwgMSwgMCkKCnQuaWNvblRleHR1cmUgPSAiem9lSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiem9lSWNvbkNvbG9yTWFzayIKCnQuaGVhZE1vZGVsID0gInpvZUhlYWQiCnQudG9yc29Nb2RlbCA9ICJ6b2VUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICJ6b2VQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJ6b2VVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAiem9lRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAiem9lSGFuZCIKdC51cHBlckxlZ01vZGVsID0gInpvZVVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAiem9lTG93ZXJMZWciCnQudG9lc01vZGVsID0gInpvZVRvZXMiCgp0Lmp1bXBTb3VuZHM9WyJ6b2VKdW1wMDEiLAogICAgICAgICAgICAgICJ6b2VKdW1wMDIiLAogICAgICAgICAgICAgICJ6b2VKdW1wMDMiXQp0LmF0dGFja1NvdW5kcz1bInpvZUF0dGFjazAxIiwKICAgICAgICAgICAgICAgICJ6b2VBdHRhY2swMiIsCiAgICAgICAgICAgICAgICAiem9lQXR0YWNrMDMiLAogICAgICAgICAgICAgICAgInpvZUF0dGFjazA0Il0KdC5pbXBhY3RTb3VuZHM9WyJ6b2VJbXBhY3QwMSIsCiAgICAgICAgICAgICAgICAiem9lSW1wYWN0MDIiLAogICAgICAgICAgICAgICAgInpvZUltcGFjdDAzIiwKICAgICAgICAgICAgICAgICJ6b2VJbXBhY3QwNCJdCnQuZGVhdGhTb3VuZHM9WyJ6b2VEZWF0aDAxIl0KdC5waWNrdXBTb3VuZHM9WyJ6b2VQaWNrdXAwMSJdCnQuZmFsbFNvdW5kcz1bInpvZUZhbGwwMSJdCgp0LnN0eWxlID0gJ2ZlbWFsZScKCgojIyMjIyMjIyMjIyMjIyMgIE5pbmphICAgIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJTbmFrZSBTaGFkb3ciKQoKdC5jb2xvclRleHR1cmUgPSAibmluamFDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gIm5pbmphQ29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMSwgMSwgMSkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDAuNTUsIDAuOCwgMC41NSkKCnQuaWNvblRleHR1cmUgPSAibmluamFJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJuaW5qYUljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICJuaW5qYUhlYWQiCnQudG9yc29Nb2RlbCA9ICJuaW5qYVRvcnNvIgp0LnBlbHZpc01vZGVsID0gIm5pbmphUGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAibmluamFVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAibmluamFGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICJuaW5qYUhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJuaW5qYVVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAibmluamFMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAibmluamFUb2VzIgoKbmluamFBdHRhY2tzID0gWyduaW5qYUF0dGFjaycrc3RyKGkrMSkrJycgZm9yIGkgaW4gcmFuZ2UoNyldCm5pbmphSGl0cyA9IFsnbmluamFIaXQnK3N0cihpKzEpKycnIGZvciBpIGluIHJhbmdlKDgpXQpuaW5qYUp1bXBzID0gWyduaW5qYUF0dGFjaycrc3RyKGkrMSkrJycgZm9yIGkgaW4gcmFuZ2UoNyldCgp0Lmp1bXBTb3VuZHM9bmluamFKdW1wcwp0LmF0dGFja1NvdW5kcz1uaW5qYUF0dGFja3MKdC5pbXBhY3RTb3VuZHM9bmluamFIaXRzCnQuZGVhdGhTb3VuZHM9WyJuaW5qYURlYXRoMSJdCnQucGlja3VwU291bmRzPW5pbmphQXR0YWNrcwp0LmZhbGxTb3VuZHM9WyJuaW5qYUZhbGwxIl0KCnQuc3R5bGUgPSAnbmluamEnCgoKIyMjIyMjIyMjIyMjIyMjICBLcm9uayAgICMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiS3JvbmsiKQoKdC5jb2xvclRleHR1cmUgPSAia3JvbmsiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJrcm9ua0NvbG9yTWFzayIKCnQuZGVmYXVsdENvbG9yID0gKDAuNCwgMC41LCAwLjQpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLjUsIDAuMykKCnQuaWNvblRleHR1cmUgPSAia3JvbmtJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJrcm9ua0ljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICJrcm9ua0hlYWQiCnQudG9yc29Nb2RlbCA9ICJrcm9ua1RvcnNvIgp0LnBlbHZpc01vZGVsID0gImtyb25rUGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAia3JvbmtVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAia3JvbmtGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICJrcm9ua0hhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJrcm9ua1VwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAia3JvbmtMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAia3JvbmtUb2VzIgoKa3JvbmtTb3VuZHMgPSBbImtyb25rMSIsCiAgICAgICAgICAgICAgImtyb25rMiIsCiAgICAgICAgICAgICAgImtyb25rMyIsCiAgICAgICAgICAgICAgImtyb25rNCIsCiAgICAgICAgICAgICAgImtyb25rNSIsCiAgICAgICAgICAgICAgImtyb25rNiIsCiAgICAgICAgICAgICAgImtyb25rNyIsCiAgICAgICAgICAgICAgImtyb25rOCIsCiAgICAgICAgICAgICAgImtyb25rOSIsCiAgICAgICAgICAgICAgImtyb25rMTAiXQp0Lmp1bXBTb3VuZHM9a3JvbmtTb3VuZHMKdC5hdHRhY2tTb3VuZHM9a3JvbmtTb3VuZHMKdC5pbXBhY3RTb3VuZHM9a3JvbmtTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImtyb25rRGVhdGgiXQp0LnBpY2t1cFNvdW5kcz1rcm9ua1NvdW5kcwp0LmZhbGxTb3VuZHM9WyJrcm9ua0ZhbGwiXQoKdC5zdHlsZSA9ICdrcm9uaycKCgojIyMjIyMjIyMjIyMjIyMgIE1FTCAgICMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiTWVsIikKCnQuY29sb3JUZXh0dXJlID0gIm1lbENvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAibWVsQ29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMSwgMSwgMSkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDAuMSwgMC42LCAwLjEpCgp0Lmljb25UZXh0dXJlID0gIm1lbEljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gIm1lbEljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICAgICAibWVsSGVhZCIKdC50b3Jzb01vZGVsID0gICAgIm1lbFRvcnNvIgp0LnBlbHZpc01vZGVsID0gImtyb25rUGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAibWVsVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJtZWxGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAibWVsSGFuZCIKdC51cHBlckxlZ01vZGVsID0gIm1lbFVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAibWVsTG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJtZWxUb2VzIgoKbWVsU291bmRzID0gWyJtZWwwMSIsCiAgICAgICAgICAgICAgIm1lbDAyIiwKICAgICAgICAgICAgICAibWVsMDMiLAogICAgICAgICAgICAgICJtZWwwNCIsCiAgICAgICAgICAgICAgIm1lbDA1IiwKICAgICAgICAgICAgICAibWVsMDYiLAogICAgICAgICAgICAgICJtZWwwNyIsCiAgICAgICAgICAgICAgIm1lbDA4IiwKICAgICAgICAgICAgICAibWVsMDkiLAogICAgICAgICAgICAgICJtZWwxMCJdCgp0LmF0dGFja1NvdW5kcyA9IG1lbFNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBtZWxTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBtZWxTb3VuZHMKdC5kZWF0aFNvdW5kcz1bIm1lbERlYXRoMDEiXQp0LnBpY2t1cFNvdW5kcyA9IG1lbFNvdW5kcwp0LmZhbGxTb3VuZHM9WyJtZWxGYWxsMDEiXQoKdC5zdHlsZSA9ICdtZWwnCgoKIyMjIyMjIyMjIyMjIyMjICBKYWNrIE1vcmdhbiAgICMjIyMjIyMjIyMjIyMjIyMjIwoKdCA9IEFwcGVhcmFuY2UoIkphY2sgTW9yZ2FuIikKCnQuY29sb3JUZXh0dXJlID0gImphY2tDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImphY2tDb2xvck1hc2siCgp0LmRlZmF1bHRDb2xvciA9ICgxLCAwLjIsIDAuMSkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDEsIDApCgp0Lmljb25UZXh0dXJlID0gImphY2tJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJqYWNrSWNvbkNvbG9yTWFzayIKCnQuaGVhZE1vZGVsID0gICAgICJqYWNrSGVhZCIKdC50b3Jzb01vZGVsID0gICAgImphY2tUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICJrcm9ua1BlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImphY2tVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgImphY2tGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAiamFja0hhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJqYWNrVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJqYWNrTG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJqYWNrVG9lcyIKCmhpdFNvdW5kcyA9IFsiamFja0hpdDAxIiwKICAgICAgICAgICAgICJqYWNrSGl0MDIiLAogICAgICAgICAgICAgImphY2tIaXQwMyIsCiAgICAgICAgICAgICAiamFja0hpdDA0IiwKICAgICAgICAgICAgICJqYWNrSGl0MDUiLAogICAgICAgICAgICAgImphY2tIaXQwNiIsCiAgICAgICAgICAgICAiamFja0hpdDA3Il0KCnNvdW5kcyA9IFsiamFjazAxIiwKICAgICAgICAgICJqYWNrMDIiLAogICAgICAgICAgImphY2swMyIsCiAgICAgICAgICAiamFjazA0IiwKICAgICAgICAgICJqYWNrMDUiLAogICAgICAgICAgImphY2swNiJdCgp0LmF0dGFja1NvdW5kcyA9IHNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBzb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBoaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImphY2tEZWF0aDAxIl0KdC5waWNrdXBTb3VuZHMgPSBzb3VuZHMKdC5mYWxsU291bmRzPVsiamFja0ZhbGwwMSJdCgp0LnN0eWxlID0gJ3BpcmF0ZScKCgojIyMjIyMjIyMjIyMjIyMgIFNBTlRBICAgIyMjIyMjIyMjIyMjIyMjIyMjCgp0ID0gQXBwZWFyYW5jZSgiU2FudGEgQ2xhdXMiKQoKdC5jb2xvclRleHR1cmUgPSAic2FudGFDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gInNhbnRhQ29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMSwgMCwgMCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDEsIDEpCgp0Lmljb25UZXh0dXJlID0gInNhbnRhSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAic2FudGFJY29uQ29sb3JNYXNrIgoKdC5oZWFkTW9kZWwgPSAgICAgInNhbnRhSGVhZCIKdC50b3Jzb01vZGVsID0gICAgInNhbnRhVG9yc28iCnQucGVsdmlzTW9kZWwgPSAia3JvbmtQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJzYW50YVVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAic2FudGFGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAic2FudGFIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAic2FudGFVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gInNhbnRhTG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJzYW50YVRvZXMiCgpoaXRTb3VuZHMgPSBbJ3NhbnRhSGl0MDEnLCAnc2FudGFIaXQwMicsICdzYW50YUhpdDAzJywgJ3NhbnRhSGl0MDQnXQpzb3VuZHMgPSBbJ3NhbnRhMDEnLCAnc2FudGEwMicsICdzYW50YTAzJywgJ3NhbnRhMDQnLCAnc2FudGEwNSddCgp0LmF0dGFja1NvdW5kcyA9IHNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBzb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBoaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bInNhbnRhRGVhdGgiXQp0LnBpY2t1cFNvdW5kcyA9IHNvdW5kcwp0LmZhbGxTb3VuZHM9WyJzYW50YUZhbGwiXQoKdC5zdHlsZSA9ICdzYW50YScKCiMjIyMjIyMjIyMjIyMjIyAgRlJPU1RZICAgIyMjIyMjIyMjIyMjIyMjIyMjCgp0ID0gQXBwZWFyYW5jZSgiRnJvc3R5IikKCnQuY29sb3JUZXh0dXJlID0gImZyb3N0eUNvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAiZnJvc3R5Q29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMC41LCAwLjUsIDEpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLjUsIDApCgp0Lmljb25UZXh0dXJlID0gImZyb3N0eUljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gImZyb3N0eUljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICAgICAiZnJvc3R5SGVhZCIKdC50b3Jzb01vZGVsID0gICAgImZyb3N0eVRvcnNvIgp0LnBlbHZpc01vZGVsID0gImZyb3N0eVBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImZyb3N0eVVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiZnJvc3R5Rm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImZyb3N0eUhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJmcm9zdHlVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImZyb3N0eUxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiZnJvc3R5VG9lcyIKCmZyb3N0eVNvdW5kcyA9IFsnZnJvc3R5MDEnLCAnZnJvc3R5MDInLCAnZnJvc3R5MDMnLCAnZnJvc3R5MDQnLCAnZnJvc3R5MDUnXQpmcm9zdHlIaXRTb3VuZHMgPSBbJ2Zyb3N0eUhpdDAxJywgJ2Zyb3N0eUhpdDAyJywgJ2Zyb3N0eUhpdDAzJ10KCnQuYXR0YWNrU291bmRzID0gZnJvc3R5U291bmRzCnQuanVtcFNvdW5kcyA9IGZyb3N0eVNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IGZyb3N0eUhpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsiZnJvc3R5RGVhdGgiXQp0LnBpY2t1cFNvdW5kcyA9IGZyb3N0eVNvdW5kcwp0LmZhbGxTb3VuZHM9WyJmcm9zdHlGYWxsIl0KCnQuc3R5bGUgPSAnZnJvc3R5JwoKIyMjIyMjIyMjIyMjIyMjICBCT05FUyAgIyMjIyMjIyMjIyMjIyMjIyMjCgp0ID0gQXBwZWFyYW5jZSgiQm9uZXMiKQoKdC5jb2xvclRleHR1cmUgPSAiYm9uZXNDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImJvbmVzQ29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMC42LCAwLjksIDEpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgwLjYsIDAuOSwgMSkKCnQuaWNvblRleHR1cmUgPSAiYm9uZXNJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJib25lc0ljb25Db2xvck1hc2siCgp0LmhlYWRNb2RlbCA9ICAgICAiYm9uZXNIZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAiYm9uZXNUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImJvbmVzUGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAiYm9uZXNVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgImJvbmVzRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImJvbmVzSGFuZCIKdC51cHBlckxlZ01vZGVsID0gImJvbmVzVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJib25lc0xvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiYm9uZXNUb2VzIgoKYm9uZXNTb3VuZHMgPSAgICBbJ2JvbmVzMScsICdib25lczInLCAnYm9uZXMzJ10KYm9uZXNIaXRTb3VuZHMgPSBbJ2JvbmVzMScsICdib25lczInLCAnYm9uZXMzJ10KCnQuYXR0YWNrU291bmRzID0gYm9uZXNTb3VuZHMKdC5qdW1wU291bmRzID0gYm9uZXNTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBib25lc0hpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsiYm9uZXNEZWF0aCJdCnQucGlja3VwU291bmRzID0gYm9uZXNTb3VuZHMKdC5mYWxsU291bmRzPVsiYm9uZXNGYWxsIl0KCnQuc3R5bGUgPSAnYm9uZXMnCgojIGJlYXIgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCnQgPSBBcHBlYXJhbmNlKCJCZXJuYXJkIikKCnQuY29sb3JUZXh0dXJlID0gImJlYXJDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImJlYXJDb2xvck1hc2siCgp0LmRlZmF1bHRDb2xvciA9ICgwLjcsIDAuNSwgMC4wKQojdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDAuNiwgMC41LCAwLjgpCgp0Lmljb25UZXh0dXJlID0gImJlYXJJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJiZWFySWNvbkNvbG9yTWFzayIKCnQuaGVhZE1vZGVsID0gICAgICJiZWFySGVhZCIKdC50b3Jzb01vZGVsID0gICAgImJlYXJUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImJlYXJQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJiZWFyVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJiZWFyRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImJlYXJIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiYmVhclVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAiYmVhckxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiYmVhclRvZXMiCgpiZWFyU291bmRzID0gICAgWydiZWFyMScsICdiZWFyMicsICdiZWFyMycsICdiZWFyNCddCmJlYXJIaXRTb3VuZHMgPSBbJ2JlYXJIaXQxJywgJ2JlYXJIaXQyJ10KCnQuYXR0YWNrU291bmRzID0gYmVhclNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBiZWFyU291bmRzCnQuaW1wYWN0U291bmRzID0gYmVhckhpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsiYmVhckRlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBiZWFyU291bmRzCnQuZmFsbFNvdW5kcz1bImJlYXJGYWxsIl0KCnQuc3R5bGUgPSAnYmVhcicKCiMgUGVuZ3VpbiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKdCA9IEFwcGVhcmFuY2UoIlBhc2NhbCIpCgp0LmNvbG9yVGV4dHVyZSA9ICJwZW5ndWluQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJwZW5ndWluQ29sb3JNYXNrIgoKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjUsIDAuOCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCgp0Lmljb25UZXh0dXJlID0gInBlbmd1aW5JY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJwZW5ndWluSWNvbkNvbG9yTWFzayIKCnQuaGVhZE1vZGVsID0gICAgICJwZW5ndWluSGVhZCIKdC50b3Jzb01vZGVsID0gICAgInBlbmd1aW5Ub3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgInBlbmd1aW5QZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJwZW5ndWluVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJwZW5ndWluRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgInBlbmd1aW5IYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAicGVuZ3VpblVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAicGVuZ3Vpbkxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAicGVuZ3VpblRvZXMiCgpwZW5ndWluU291bmRzID0gICAgWydwZW5ndWluMScsICdwZW5ndWluMicsICdwZW5ndWluMycsICdwZW5ndWluNCddCnBlbmd1aW5IaXRTb3VuZHMgPSBbJ3Blbmd1aW5IaXQxJywgJ3Blbmd1aW5IaXQyJ10KCnQuYXR0YWNrU291bmRzID0gcGVuZ3VpblNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBwZW5ndWluU291bmRzCnQuaW1wYWN0U291bmRzID0gcGVuZ3VpbkhpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsicGVuZ3VpbkRlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBwZW5ndWluU291bmRzCnQuZmFsbFNvdW5kcz1bInBlbmd1aW5GYWxsIl0KCnQuc3R5bGUgPSAncGVuZ3VpbicKCgojIEFsaSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiVGFvYmFvIE1hc2NvdCIpCnQuY29sb3JUZXh0dXJlID0gImFsaUNvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAiYWxpQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgxLCAwLjUsIDApCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAxLCAxKQp0Lmljb25UZXh0dXJlID0gImFsaUljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gImFsaUljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJhbGlIZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAiYWxpVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJhbGlQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJhbGlVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgImFsaUZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJhbGlIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiYWxpVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJhbGlMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgImFsaVRvZXMiCmFsaVNvdW5kcyA9ICAgIFsnYWxpMScsICdhbGkyJywgJ2FsaTMnLCAnYWxpNCddCmFsaUhpdFNvdW5kcyA9IFsnYWxpSGl0MScsICdhbGlIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBhbGlTb3VuZHMKdC5qdW1wU291bmRzID0gYWxpU291bmRzCnQuaW1wYWN0U291bmRzID0gYWxpSGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJhbGlEZWF0aCJdCnQucGlja3VwU291bmRzID0gYWxpU291bmRzCnQuZmFsbFNvdW5kcz1bImFsaUZhbGwiXQp0LnN0eWxlID0gJ2FsaScKCiMgY3lib3JnICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJCLTkwMDAiKQp0LmNvbG9yVGV4dHVyZSA9ICJjeWJvcmdDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImN5Ym9yZ0NvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC41LCAwLjUsIDAuNSkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAiY3lib3JnSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiY3lib3JnSWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgImN5Ym9yZ0hlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJjeWJvcmdUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImN5Ym9yZ1BlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImN5Ym9yZ1VwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiY3lib3JnRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImN5Ym9yZ0hhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJjeWJvcmdVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImN5Ym9yZ0xvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiY3lib3JnVG9lcyIKY3lib3JnU291bmRzID0gICAgWydjeWJvcmcxJywgJ2N5Ym9yZzInLCAnY3lib3JnMycsICdjeWJvcmc0J10KY3lib3JnSGl0U291bmRzID0gWydjeWJvcmdIaXQxJywgJ2N5Ym9yZ0hpdDInXQp0LmF0dGFja1NvdW5kcyA9IGN5Ym9yZ1NvdW5kcwp0Lmp1bXBTb3VuZHMgPSBjeWJvcmdTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBjeWJvcmdIaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImN5Ym9yZ0RlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBjeWJvcmdTb3VuZHMKdC5mYWxsU291bmRzPVsiY3lib3JnRmFsbCJdCnQuc3R5bGUgPSAnY3lib3JnJwoKIyBBZ2VudCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiQWdlbnQgSm9obnNvbiIpCnQuY29sb3JUZXh0dXJlID0gImFnZW50Q29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJhZ2VudENvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjMsIDAuMzMpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLjUsIDAuMykKdC5pY29uVGV4dHVyZSA9ICJhZ2VudEljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gImFnZW50SWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgImFnZW50SGVhZCIKdC50b3Jzb01vZGVsID0gICAgImFnZW50VG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJhZ2VudFBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImFnZW50VXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJhZ2VudEZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJhZ2VudEhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJhZ2VudFVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAiYWdlbnRMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgImFnZW50VG9lcyIKYWdlbnRTb3VuZHMgPSAgICBbJ2FnZW50MScsICdhZ2VudDInLCAnYWdlbnQzJywgJ2FnZW50NCddCmFnZW50SGl0U291bmRzID0gWydhZ2VudEhpdDEnLCAnYWdlbnRIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBhZ2VudFNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBhZ2VudFNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IGFnZW50SGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJhZ2VudERlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBhZ2VudFNvdW5kcwp0LmZhbGxTb3VuZHM9WyJhZ2VudEZhbGwiXQp0LnN0eWxlID0gJ2FnZW50JwoKIyBKdW1wc3VpdCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiTGVlIikKdC5jb2xvclRleHR1cmUgPSAianVtcHN1aXRDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImp1bXBzdWl0Q29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjMsIDAuNSwgMC44KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMCwgMCkKdC5pY29uVGV4dHVyZSA9ICJqdW1wc3VpdEljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gImp1bXBzdWl0SWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgImp1bXBzdWl0SGVhZCIKdC50b3Jzb01vZGVsID0gICAgImp1bXBzdWl0VG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJqdW1wc3VpdFBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImp1bXBzdWl0VXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJqdW1wc3VpdEZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJqdW1wc3VpdEhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJqdW1wc3VpdFVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAianVtcHN1aXRMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgImp1bXBzdWl0VG9lcyIKanVtcHN1aXRTb3VuZHMgPSBbJ2p1bXBzdWl0MScsICdqdW1wc3VpdDInLCAnanVtcHN1aXQzJywgJ2p1bXBzdWl0NCddCmp1bXBzdWl0SGl0U291bmRzID0gWydqdW1wc3VpdEhpdDEnLCAnanVtcHN1aXRIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBqdW1wc3VpdFNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBqdW1wc3VpdFNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IGp1bXBzdWl0SGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJqdW1wc3VpdERlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBqdW1wc3VpdFNvdW5kcwp0LmZhbGxTb3VuZHM9WyJqdW1wc3VpdEZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIEFjdGlvbkhlcm8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKdCA9IEFwcGVhcmFuY2UoIlRvZGQgTWNCdXJ0b24iKQp0LmNvbG9yVGV4dHVyZSA9ICJhY3Rpb25IZXJvQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJhY3Rpb25IZXJvQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjMsIDAuNSwgMC44KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMCwgMCkKdC5pY29uVGV4dHVyZSA9ICJhY3Rpb25IZXJvSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiYWN0aW9uSGVyb0ljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJhY3Rpb25IZXJvSGVhZCIKdC50b3Jzb01vZGVsID0gICAgImFjdGlvbkhlcm9Ub3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImFjdGlvbkhlcm9QZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJhY3Rpb25IZXJvVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJhY3Rpb25IZXJvRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImFjdGlvbkhlcm9IYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiYWN0aW9uSGVyb1VwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAiYWN0aW9uSGVyb0xvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiYWN0aW9uSGVyb1RvZXMiCmFjdGlvbkhlcm9Tb3VuZHMgPSBbJ2FjdGlvbkhlcm8xJywgJ2FjdGlvbkhlcm8yJywgJ2FjdGlvbkhlcm8zJywgJ2FjdGlvbkhlcm80J10KYWN0aW9uSGVyb0hpdFNvdW5kcyA9IFsnYWN0aW9uSGVyb0hpdDEnLCAnYWN0aW9uSGVyb0hpdDInXQp0LmF0dGFja1NvdW5kcyA9IGFjdGlvbkhlcm9Tb3VuZHMKdC5qdW1wU291bmRzID0gYWN0aW9uSGVyb1NvdW5kcwp0LmltcGFjdFNvdW5kcyA9IGFjdGlvbkhlcm9IaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImFjdGlvbkhlcm9EZWF0aCJdCnQucGlja3VwU291bmRzID0gYWN0aW9uSGVyb1NvdW5kcwp0LmZhbGxTb3VuZHM9WyJhY3Rpb25IZXJvRmFsbCJdCnQuc3R5bGUgPSAnc3BheicKCiMgQXNzYXNzaW4gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKdCA9IEFwcGVhcmFuY2UoIlpvbGEiKQp0LmNvbG9yVGV4dHVyZSA9ICJhc3Nhc3NpbkNvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAiYXNzYXNzaW5Db2xvck1hc2siCnQuZGVmYXVsdENvbG9yID0gKDAuMywgMC41LCAwLjgpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLCAwKQp0Lmljb25UZXh0dXJlID0gImFzc2Fzc2luSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiYXNzYXNzaW5JY29uQ29sb3JNYXNrIgp0LmhlYWRNb2RlbCA9ICAgICAiYXNzYXNzaW5IZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAiYXNzYXNzaW5Ub3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImFzc2Fzc2luUGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAiYXNzYXNzaW5VcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgImFzc2Fzc2luRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImFzc2Fzc2luSGFuZCIKdC51cHBlckxlZ01vZGVsID0gImFzc2Fzc2luVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJhc3Nhc3Npbkxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiYXNzYXNzaW5Ub2VzIgphc3Nhc3NpblNvdW5kcyA9IFsnYXNzYXNzaW4xJywgJ2Fzc2Fzc2luMicsICdhc3Nhc3NpbjMnLCAnYXNzYXNzaW40J10KYXNzYXNzaW5IaXRTb3VuZHMgPSBbJ2Fzc2Fzc2luSGl0MScsICdhc3Nhc3NpbkhpdDInXQp0LmF0dGFja1NvdW5kcyA9IGFzc2Fzc2luU291bmRzCnQuanVtcFNvdW5kcyA9IGFzc2Fzc2luU291bmRzCnQuaW1wYWN0U291bmRzID0gYXNzYXNzaW5IaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImFzc2Fzc2luRGVhdGgiXQp0LnBpY2t1cFNvdW5kcyA9IGFzc2Fzc2luU291bmRzCnQuZmFsbFNvdW5kcz1bImFzc2Fzc2luRmFsbCJdCnQuc3R5bGUgPSAnc3BheicKCiMgV2l6YXJkICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJHcnVtYmxlZG9yZiIpCnQuY29sb3JUZXh0dXJlID0gIndpemFyZENvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAid2l6YXJkQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjIsIDAuNCwgMS4wKQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMC4wNiwgMC4xNSwgMC40KQp0Lmljb25UZXh0dXJlID0gIndpemFyZEljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gIndpemFyZEljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJ3aXphcmRIZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAid2l6YXJkVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJ3aXphcmRQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJ3aXphcmRVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgIndpemFyZEZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJ3aXphcmRIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAid2l6YXJkVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJ3aXphcmRMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgIndpemFyZFRvZXMiCndpemFyZFNvdW5kcyA9ICAgIFsnd2l6YXJkMScsICd3aXphcmQyJywgJ3dpemFyZDMnLCAnd2l6YXJkNCddCndpemFyZEhpdFNvdW5kcyA9IFsnd2l6YXJkSGl0MScsICd3aXphcmRIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSB3aXphcmRTb3VuZHMKdC5qdW1wU291bmRzID0gd2l6YXJkU291bmRzCnQuaW1wYWN0U291bmRzID0gd2l6YXJkSGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJ3aXphcmREZWF0aCJdCnQucGlja3VwU291bmRzID0gd2l6YXJkU291bmRzCnQuZmFsbFNvdW5kcz1bIndpemFyZEZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIENvd2JveSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiQnV0Y2giKQp0LmNvbG9yVGV4dHVyZSA9ICJjb3dib3lDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImNvd2JveUNvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjUsIDAuOCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAiY293Ym95SWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiY293Ym95SWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgImNvd2JveUhlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJjb3dib3lUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImNvd2JveVBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImNvd2JveVVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiY293Ym95Rm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImNvd2JveUhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJjb3dib3lVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImNvd2JveUxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiY293Ym95VG9lcyIKY293Ym95U291bmRzID0gICAgWydjb3dib3kxJywgJ2Nvd2JveTInLCAnY293Ym95MycsICdjb3dib3k0J10KY293Ym95SGl0U291bmRzID0gWydjb3dib3lIaXQxJywgJ2Nvd2JveUhpdDInXQp0LmF0dGFja1NvdW5kcyA9IGNvd2JveVNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBjb3dib3lTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBjb3dib3lIaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bImNvd2JveURlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBjb3dib3lTb3VuZHMKdC5mYWxsU291bmRzPVsiY293Ym95RmFsbCJdCnQuc3R5bGUgPSAnc3BheicKCiMgV2l0Y2ggIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKdCA9IEFwcGVhcmFuY2UoIldpdGNoIikKdC5jb2xvclRleHR1cmUgPSAid2l0Y2hDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gIndpdGNoQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjMsIDAuNSwgMC44KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMCwgMCkKdC5pY29uVGV4dHVyZSA9ICJ3aXRjaEljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gIndpdGNoSWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgIndpdGNoSGVhZCIKdC50b3Jzb01vZGVsID0gICAgIndpdGNoVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJ3aXRjaFBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gIndpdGNoVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJ3aXRjaEZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJ3aXRjaEhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJ3aXRjaFVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAid2l0Y2hMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgIndpdGNoVG9lcyIKd2l0Y2hTb3VuZHMgPSAgICBbJ3dpdGNoMScsICd3aXRjaDInLCAnd2l0Y2gzJywgJ3dpdGNoNCddCndpdGNoSGl0U291bmRzID0gWyd3aXRjaEhpdDEnLCAnd2l0Y2hIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSB3aXRjaFNvdW5kcwp0Lmp1bXBTb3VuZHMgPSB3aXRjaFNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IHdpdGNoSGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJ3aXRjaERlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSB3aXRjaFNvdW5kcwp0LmZhbGxTb3VuZHM9WyJ3aXRjaEZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIFdhcnJpb3IgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKdCA9IEFwcGVhcmFuY2UoIldhcnJpb3IiKQp0LmNvbG9yVGV4dHVyZSA9ICJ3YXJyaW9yQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJ3YXJyaW9yQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjMsIDAuNSwgMC44KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMCwgMCkKdC5pY29uVGV4dHVyZSA9ICJ3YXJyaW9ySWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAid2Fycmlvckljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJ3YXJyaW9ySGVhZCIKdC50b3Jzb01vZGVsID0gICAgIndhcnJpb3JUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgIndhcnJpb3JQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJ3YXJyaW9yVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJ3YXJyaW9yRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgIndhcnJpb3JIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAid2FycmlvclVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAid2Fycmlvckxvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAid2FycmlvclRvZXMiCndhcnJpb3JTb3VuZHMgPSAgICBbJ3dhcnJpb3IxJywgJ3dhcnJpb3IyJywgJ3dhcnJpb3IzJywgJ3dhcnJpb3I0J10Kd2FycmlvckhpdFNvdW5kcyA9IFsnd2FycmlvckhpdDEnLCAnd2FycmlvckhpdDInXQp0LmF0dGFja1NvdW5kcyA9IHdhcnJpb3JTb3VuZHMKdC5qdW1wU291bmRzID0gd2FycmlvclNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IHdhcnJpb3JIaXRTb3VuZHMKdC5kZWF0aFNvdW5kcz1bIndhcnJpb3JEZWF0aCJdCnQucGlja3VwU291bmRzID0gd2FycmlvclNvdW5kcwp0LmZhbGxTb3VuZHM9WyJ3YXJyaW9yRmFsbCJdCnQuc3R5bGUgPSAnc3BheicKCiMgU3VwZXJoZXJvICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJNaWRkbGUtTWFuIikKdC5jb2xvclRleHR1cmUgPSAic3VwZXJoZXJvQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJzdXBlcmhlcm9Db2xvck1hc2siCnQuZGVmYXVsdENvbG9yID0gKDAuMywgMC41LCAwLjgpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLCAwKQp0Lmljb25UZXh0dXJlID0gInN1cGVyaGVyb0ljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gInN1cGVyaGVyb0ljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJzdXBlcmhlcm9IZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAic3VwZXJoZXJvVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJzdXBlcmhlcm9QZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJzdXBlcmhlcm9VcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgInN1cGVyaGVyb0ZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJzdXBlcmhlcm9IYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAic3VwZXJoZXJvVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJzdXBlcmhlcm9Mb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgInN1cGVyaGVyb1RvZXMiCnN1cGVyaGVyb1NvdW5kcyA9ICAgIFsnc3VwZXJoZXJvMScsICdzdXBlcmhlcm8yJywgJ3N1cGVyaGVybzMnLCAnc3VwZXJoZXJvNCddCnN1cGVyaGVyb0hpdFNvdW5kcyA9IFsnc3VwZXJoZXJvSGl0MScsICdzdXBlcmhlcm9IaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBzdXBlcmhlcm9Tb3VuZHMKdC5qdW1wU291bmRzID0gc3VwZXJoZXJvU291bmRzCnQuaW1wYWN0U291bmRzID0gc3VwZXJoZXJvSGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJzdXBlcmhlcm9EZWF0aCJdCnQucGlja3VwU291bmRzID0gc3VwZXJoZXJvU291bmRzCnQuZmFsbFNvdW5kcz1bInN1cGVyaGVyb0ZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIEFsaWVuICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJBbGllbiIpCnQuY29sb3JUZXh0dXJlID0gImFsaWVuQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJhbGllbkNvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjUsIDAuOCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAiYWxpZW5JY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJhbGllbkljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJhbGllbkhlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJhbGllblRvcnNvIgp0LnBlbHZpc01vZGVsID0gICAiYWxpZW5QZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJhbGllblVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiYWxpZW5Gb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAiYWxpZW5IYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiYWxpZW5VcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImFsaWVuTG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJhbGllblRvZXMiCmFsaWVuU291bmRzID0gICAgWydhbGllbjEnLCAnYWxpZW4yJywgJ2FsaWVuMycsICdhbGllbjQnXQphbGllbkhpdFNvdW5kcyA9IFsnYWxpZW5IaXQxJywgJ2FsaWVuSGl0MiddCnQuYXR0YWNrU291bmRzID0gYWxpZW5Tb3VuZHMKdC5qdW1wU291bmRzID0gYWxpZW5Tb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBhbGllbkhpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsiYWxpZW5EZWF0aCJdCnQucGlja3VwU291bmRzID0gYWxpZW5Tb3VuZHMKdC5mYWxsU291bmRzPVsiYWxpZW5GYWxsIl0KdC5zdHlsZSA9ICdzcGF6JwoKIyBPbGRMYWR5ICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJPbGRMYWR5IikKdC5jb2xvclRleHR1cmUgPSAib2xkTGFkeUNvbG9yIgp0LmNvbG9yTWFza1RleHR1cmUgPSAib2xkTGFkeUNvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjUsIDAuOCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAib2xkTGFkeUljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gIm9sZExhZHlJY29uQ29sb3JNYXNrIgp0LmhlYWRNb2RlbCA9ICAgICAib2xkTGFkeUhlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJvbGRMYWR5VG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJvbGRMYWR5UGVsdmlzIgp0LnVwcGVyQXJtTW9kZWwgPSAib2xkTGFkeVVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAib2xkTGFkeUZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJvbGRMYWR5SGFuZCIKdC51cHBlckxlZ01vZGVsID0gIm9sZExhZHlVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gIm9sZExhZHlMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgIm9sZExhZHlUb2VzIgpvbGRMYWR5U291bmRzID0gICAgWydvbGRMYWR5MScsICdvbGRMYWR5MicsICdvbGRMYWR5MycsICdvbGRMYWR5NCddCm9sZExhZHlIaXRTb3VuZHMgPSBbJ29sZExhZHlIaXQxJywgJ29sZExhZHlIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBvbGRMYWR5U291bmRzCnQuanVtcFNvdW5kcyA9IG9sZExhZHlTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSBvbGRMYWR5SGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJvbGRMYWR5RGVhdGgiXQp0LnBpY2t1cFNvdW5kcyA9IG9sZExhZHlTb3VuZHMKdC5mYWxsU291bmRzPVsib2xkTGFkeUZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIEdsYWRpYXRvciAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiR2xhZGlhdG9yIikKdC5jb2xvclRleHR1cmUgPSAiZ2xhZGlhdG9yQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJnbGFkaWF0b3JDb2xvck1hc2siCnQuZGVmYXVsdENvbG9yID0gKDAuMywgMC41LCAwLjgpCnQuZGVmYXVsdEhpZ2hsaWdodCA9ICgxLCAwLCAwKQp0Lmljb25UZXh0dXJlID0gImdsYWRpYXRvckljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gImdsYWRpYXRvckljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJnbGFkaWF0b3JIZWFkIgp0LnRvcnNvTW9kZWwgPSAgICAiZ2xhZGlhdG9yVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJnbGFkaWF0b3JQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJnbGFkaWF0b3JVcHBlckFybSIKdC5mb3JlQXJtTW9kZWwgPSAgImdsYWRpYXRvckZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJnbGFkaWF0b3JIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiZ2xhZGlhdG9yVXBwZXJMZWciCnQubG93ZXJMZWdNb2RlbCA9ICJnbGFkaWF0b3JMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgImdsYWRpYXRvclRvZXMiCmdsYWRpYXRvclNvdW5kcyA9ICAgIFsnZ2xhZGlhdG9yMScsICdnbGFkaWF0b3IyJywgJ2dsYWRpYXRvcjMnLCAnZ2xhZGlhdG9yNCddCmdsYWRpYXRvckhpdFNvdW5kcyA9IFsnZ2xhZGlhdG9ySGl0MScsICdnbGFkaWF0b3JIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBnbGFkaWF0b3JTb3VuZHMKdC5qdW1wU291bmRzID0gZ2xhZGlhdG9yU291bmRzCnQuaW1wYWN0U291bmRzID0gZ2xhZGlhdG9ySGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJnbGFkaWF0b3JEZWF0aCJdCnQucGlja3VwU291bmRzID0gZ2xhZGlhdG9yU291bmRzCnQuZmFsbFNvdW5kcz1bImdsYWRpYXRvckZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIFdyZXN0bGVyICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJXcmVzdGxlciIpCnQuY29sb3JUZXh0dXJlID0gIndyZXN0bGVyQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJ3cmVzdGxlckNvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMC4zLCAwLjUsIDAuOCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAid3Jlc3RsZXJJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJ3cmVzdGxlckljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJ3cmVzdGxlckhlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJ3cmVzdGxlclRvcnNvIgp0LnBlbHZpc01vZGVsID0gICAid3Jlc3RsZXJQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJ3cmVzdGxlclVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAid3Jlc3RsZXJGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAid3Jlc3RsZXJIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAid3Jlc3RsZXJVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gIndyZXN0bGVyTG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJ3cmVzdGxlclRvZXMiCndyZXN0bGVyU291bmRzID0gICAgWyd3cmVzdGxlcjEnLCAnd3Jlc3RsZXIyJywgJ3dyZXN0bGVyMycsICd3cmVzdGxlcjQnXQp3cmVzdGxlckhpdFNvdW5kcyA9IFsnd3Jlc3RsZXJIaXQxJywgJ3dyZXN0bGVySGl0MiddCnQuYXR0YWNrU291bmRzID0gd3Jlc3RsZXJTb3VuZHMKdC5qdW1wU291bmRzID0gd3Jlc3RsZXJTb3VuZHMKdC5pbXBhY3RTb3VuZHMgPSB3cmVzdGxlckhpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsid3Jlc3RsZXJEZWF0aCJdCnQucGlja3VwU291bmRzID0gd3Jlc3RsZXJTb3VuZHMKdC5mYWxsU291bmRzPVsid3Jlc3RsZXJGYWxsIl0KdC5zdHlsZSA9ICdzcGF6JwoKIyBPcGVyYVNpbmdlciAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiR3JldGVsIikKdC5jb2xvclRleHR1cmUgPSAib3BlcmFTaW5nZXJDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gIm9wZXJhU2luZ2VyQ29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgwLjMsIDAuNSwgMC44KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMCwgMCkKdC5pY29uVGV4dHVyZSA9ICJvcGVyYVNpbmdlckljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gIm9wZXJhU2luZ2VySWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgIm9wZXJhU2luZ2VySGVhZCIKdC50b3Jzb01vZGVsID0gICAgIm9wZXJhU2luZ2VyVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJvcGVyYVNpbmdlclBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gIm9wZXJhU2luZ2VyVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJvcGVyYVNpbmdlckZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJvcGVyYVNpbmdlckhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJvcGVyYVNpbmdlclVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAib3BlcmFTaW5nZXJMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgIm9wZXJhU2luZ2VyVG9lcyIKb3BlcmFTaW5nZXJTb3VuZHMgPSAgICBbJ29wZXJhU2luZ2VyMScsICdvcGVyYVNpbmdlcjInLAogICAgICAgICAgICAgICAgICAgICAgICAnb3BlcmFTaW5nZXIzJywgJ29wZXJhU2luZ2VyNCddCm9wZXJhU2luZ2VySGl0U291bmRzID0gWydvcGVyYVNpbmdlckhpdDEnLCAnb3BlcmFTaW5nZXJIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBvcGVyYVNpbmdlclNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBvcGVyYVNpbmdlclNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IG9wZXJhU2luZ2VySGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJvcGVyYVNpbmdlckRlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBvcGVyYVNpbmdlclNvdW5kcwp0LmZhbGxTb3VuZHM9WyJvcGVyYVNpbmdlckZhbGwiXQp0LnN0eWxlID0gJ3NwYXonCgojIFBpeGllICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnQgPSBBcHBlYXJhbmNlKCJQaXhlbCIpCnQuY29sb3JUZXh0dXJlID0gInBpeGllQ29sb3IiCnQuY29sb3JNYXNrVGV4dHVyZSA9ICJwaXhpZUNvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMCwgMSwgMC43KQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMC42NSwgMC4zNSwgMC43NSkKdC5pY29uVGV4dHVyZSA9ICJwaXhpZUljb24iCnQuaWNvbk1hc2tUZXh0dXJlID0gInBpeGllSWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgInBpeGllSGVhZCIKdC50b3Jzb01vZGVsID0gICAgInBpeGllVG9yc28iCnQucGVsdmlzTW9kZWwgPSAgICJwaXhpZVBlbHZpcyIKdC51cHBlckFybU1vZGVsID0gInBpeGllVXBwZXJBcm0iCnQuZm9yZUFybU1vZGVsID0gICJwaXhpZUZvcmVBcm0iCnQuaGFuZE1vZGVsID0gICAgICJwaXhpZUhhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJwaXhpZVVwcGVyTGVnIgp0Lmxvd2VyTGVnTW9kZWwgPSAicGl4aWVMb3dlckxlZyIKdC50b2VzTW9kZWwgPSAgICAgInBpeGllVG9lcyIKcGl4aWVTb3VuZHMgPSAgICBbJ3BpeGllMScsICdwaXhpZTInLCAncGl4aWUzJywgJ3BpeGllNCddCnBpeGllSGl0U291bmRzID0gWydwaXhpZUhpdDEnLCAncGl4aWVIaXQyJ10KdC5hdHRhY2tTb3VuZHMgPSBwaXhpZVNvdW5kcwp0Lmp1bXBTb3VuZHMgPSBwaXhpZVNvdW5kcwp0LmltcGFjdFNvdW5kcyA9IHBpeGllSGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJwaXhpZURlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBwaXhpZVNvdW5kcwp0LmZhbGxTb3VuZHM9WyJwaXhpZUZhbGwiXQp0LnN0eWxlID0gJ3BpeGllJwoKIyBSb2JvdCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiUm9ib3QiKQp0LmNvbG9yVGV4dHVyZSA9ICJjeWJvcmdDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImN5Ym9yZ0NvbG9yTWFzayIKdC5kZWZhdWx0Q29sb3IgPSAoMS4wLCAxLjAsIDEuMCkKdC5kZWZhdWx0SGlnaGxpZ2h0ID0gKDEsIDAsIDApCnQuaWNvblRleHR1cmUgPSAiY3lib3JnSWNvbiIKdC5pY29uTWFza1RleHR1cmUgPSAiY3lib3JnSWNvbkNvbG9yTWFzayIKdC5oZWFkTW9kZWwgPSAgICAgImN5Ym9yZ0hlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJjeWJvcmdUb3JzbyIKdC5wZWx2aXNNb2RlbCA9ICAgImN5Ym9yZ1BlbHZpcyIKdC51cHBlckFybU1vZGVsID0gImN5Ym9yZ1VwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiY3lib3JnRm9yZUFybSIKdC5oYW5kTW9kZWwgPSAgICAgImN5Ym9yZ0hhbmQiCnQudXBwZXJMZWdNb2RlbCA9ICJjeWJvcmdVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImN5Ym9yZ0xvd2VyTGVnIgp0LnRvZXNNb2RlbCA9ICAgICAiY3lib3JnVG9lcyIKcm9ib3RTb3VuZHMgPSAgICBbJ2N5Ym9yZzEnLCAnY3lib3JnMicsICdjeWJvcmczJywgJ2N5Ym9yZzQnXQpyb2JvdEhpdFNvdW5kcyA9IFsncm9ib3RIaXQxJywgJ3JvYm90SGl0MiddCnQuYXR0YWNrU291bmRzID0gY3lib3JnU291bmRzCnQuanVtcFNvdW5kcyA9IGN5Ym9yZ1NvdW5kcwp0LmltcGFjdFNvdW5kcyA9IGN5Ym9yZ0hpdFNvdW5kcwp0LmRlYXRoU291bmRzPVsiY3lib3JnRGVhdGgiXQp0LnBpY2t1cFNvdW5kcyA9IGN5Ym9yZ1NvdW5kcwp0LmZhbGxTb3VuZHM9WyJjeWJvcmdGYWxsIl0KdC5zdHlsZSA9ICdjeWJvcmcnIAoKIyBCdW5ueSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwp0ID0gQXBwZWFyYW5jZSgiRWFzdGVyIEJ1bm55IikKdC5jb2xvclRleHR1cmUgPSAiYnVubnlDb2xvciIKdC5jb2xvck1hc2tUZXh0dXJlID0gImJ1bm55Q29sb3JNYXNrIgp0LmRlZmF1bHRDb2xvciA9ICgxLCAxLCAxKQp0LmRlZmF1bHRIaWdobGlnaHQgPSAoMSwgMC41LCAwLjUpCnQuaWNvblRleHR1cmUgPSAiYnVubnlJY29uIgp0Lmljb25NYXNrVGV4dHVyZSA9ICJidW5ueUljb25Db2xvck1hc2siCnQuaGVhZE1vZGVsID0gICAgICJidW5ueUhlYWQiCnQudG9yc29Nb2RlbCA9ICAgICJidW5ueVRvcnNvIgp0LnBlbHZpc01vZGVsID0gICAiYnVubnlQZWx2aXMiCnQudXBwZXJBcm1Nb2RlbCA9ICJidW5ueVVwcGVyQXJtIgp0LmZvcmVBcm1Nb2RlbCA9ICAiYnVubnlGb3JlQXJtIgp0LmhhbmRNb2RlbCA9ICAgICAiYnVubnlIYW5kIgp0LnVwcGVyTGVnTW9kZWwgPSAiYnVubnlVcHBlckxlZyIKdC5sb3dlckxlZ01vZGVsID0gImJ1bm55TG93ZXJMZWciCnQudG9lc01vZGVsID0gICAgICJidW5ueVRvZXMiCmJ1bm55U291bmRzID0gICAgWydidW5ueTEnLCAnYnVubnkyJywgJ2J1bm55MycsICdidW5ueTQnXQpidW5ueUhpdFNvdW5kcyA9IFsnYnVubnlIaXQxJywgJ2J1bm55SGl0MiddCnQuYXR0YWNrU291bmRzID0gYnVubnlTb3VuZHMKdC5qdW1wU291bmRzID0gWydidW5ueUp1bXAnXQp0LmltcGFjdFNvdW5kcyA9IGJ1bm55SGl0U291bmRzCnQuZGVhdGhTb3VuZHM9WyJidW5ueURlYXRoIl0KdC5waWNrdXBTb3VuZHMgPSBidW5ueVNvdW5kcwp0LmZhbGxTb3VuZHM9WyJidW5ueUZhbGwiXQp0LnN0eWxlID0gJ2J1bm55JwoKCmNsYXNzIFBvaXNvbihvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG93bmVyPU5vbmUpOgogICAgICAgIHNlbGYub3duZXIgPSBvd25lcgogICAgICAgIGlmIHNlbGYub3duZXIgaXMgbm90IE5vbmUgYW5kIHNlbGYub3duZXIuZXhpc3RzKCk6CiAgICAgICAgICAgIHNlbGYubGlnaHQgPSBicy5uZXdOb2RlKCdsaWdodCcsIG93bmVyPXNlbGYub3duZXIsCiAgICAgICAgICAgICAgICBhdHRycz17J3JhZGl1cyc6IDAuMDk1LAogICAgICAgICAgICAgICAgICAgICd2b2x1bWVJbnRlbnNpdHlTY2FsZSc6IDAuNywKICAgICAgICAgICAgICAgICAgICAnY29sb3InOiAoMCwgMS40LCAwLjIpfSkKICAgICAgICAgICAgc2VsZi5vd25lci5jb25uZWN0QXR0cigncG9zaXRpb24nLCBzZWxmLmxpZ2h0LCAncG9zaXRpb24nKQogICAgICAgICAgICBzZWxmLnRpbWVyID0gYnMuVGltZXIoNTAsIGJzLkNhbGwoc2VsZi5ydW4pLCBUcnVlKQogICAgICAgICAgICBicy5nYW1lVGltZXIoMTAwMDAsIGJzLkNhbGwoc2VsZi5kZWxldGUpKQogICAgICAgIGVsc2U6IHNlbGYuZGVsZXRlKCkKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgaWYgc2VsZi5vd25lci5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5vd25lci5oYW5kbGVNZXNzYWdlKGJzLkhpdE1lc3NhZ2UocG9zPXNlbGYub3duZXIucG9zaXRpb24sCiAgICAgICAgICAgICAgICB2ZWxvY2l0eT0oMCwgMCwgMCksCiAgICAgICAgICAgICAgICBtYWduaXR1ZGU9MTMsCiAgICAgICAgICAgICAgICBoaXRUeXBlPSdleHBsb3Npb24nLAogICAgICAgICAgICAgICAgaGl0U3ViVHlwZT0ncG9pc29uRWZmZWN0JywKICAgICAgICAgICAgICAgIHJhZGl1cz0xLAogICAgICAgICAgICAgICAgc291cmNlUGxheWVyPWJzLlBsYXllcihOb25lKSwKICAgICAgICAgICAgICAgIGtpY2tCYWNrPTApKQogICAgICAgIGVsc2U6IHNlbGYuZGVsZXRlKCkKICAgIGRlZiBkZWxldGUoc2VsZik6CiAgICAgICAgaWYgaGFzYXR0cihzZWxmLCAibGlnaHQiKToKICAgICAgICAgICAgaWYgaGFzYXR0cihzZWxmLmxpZ2h0LCAicmFkaXVzIik6IGJzVXRpbHMuYW5pbWF0ZShzZWxmLmxpZ2h0LCAicmFkaXVzIiwgezA6IHNlbGYubGlnaHQucmFkaXVzLCA1MDA6IDB9KQogICAgICAgICAgICBicy5nYW1lVGltZXIoNTAwLCBzZWxmLmxpZ2h0LmRlbGV0ZSkKICAgICAgICBzZWxmLnRpbWVyID0gTm9uZQogICAgICAgIHNlbGYub3duZXIgPSBOb25lCiAgICAgICAgCmNsYXNzIFRlbGVwb3J0KG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgb3duZXI9Tm9uZSk6CiAgICAgICAgc2VsZi5vd25lciA9IG93bmVyCiAgICAgICAgaWYgc2VsZi5vd25lciBpcyBub3QgTm9uZSBhbmQgc2VsZi5vd25lci5leGlzdHMoKToKICAgICAgICAgICAgc2VsZi5saWdodCA9IGJzLm5ld05vZGUoJ2xpZ2h0Jywgb3duZXI9c2VsZi5vd25lciwKICAgICAgICAgICAgICAgIGF0dHJzPXsncmFkaXVzJzogMC4wOTUsCiAgICAgICAgICAgICAgICAgICAgJ3ZvbHVtZUludGVuc2l0eVNjYWxlJzogMC43LAogICAgICAgICAgICAgICAgICAgICdjb2xvcic6ICgwLCAxLjQsIDAuMil9KQogICAgICAgICAgICBzZWxmLm93bmVyLmNvbm5lY3RBdHRyKCdwb3NpdGlvbicsIHNlbGYubGlnaHQsICdwb3NpdGlvbicpCiAgICAgICAgICAgIHNlbGYudGltZXIgPSBicy5UaW1lcig1MCwgYnMuQ2FsbChzZWxmLnJ1biksIFRydWUpCiAgICAgICAgICAgIGJzLmdhbWVUaW1lcigxMDAwMCwgYnMuQ2FsbChzZWxmLmRlbGV0ZSkpCiAgICAgICAgZWxzZTogc2VsZi5kZWxldGUoKQogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICAgICAgdGltZSA9IDMwMDAKICAgICAgICAgICAgaWYgbm90IHNlbGYubm9kZS5leGlzdHMoKTogcmV0dXJuCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLl90ZWxlcG9ydGVkOgogICAgICAgICAgICAgICAgbWFwQm91bmRzID0gc2VsZi5nZXRBY3Rpdml0eSgpLmdldE1hcCgpLnNwYXduUG9pbnRzCiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuaGFuZGxlTWVzc2FnZSgic3RhbmQiLCByYW5kb20udW5pZm9ybShtYXBCb3VuZHNbMF1bMF0sIG1hcEJvdW5kc1sxXVswXSksIHJhbmRvbS51bmlmb3JtKG1hcEJvdW5kc1swXVsxXSwgbWFwQm91bmRzWzFdWzFdKSwgcmFuZG9tLnVuaWZvcm0obWFwQm91bmRzWzBdWzJdLCBtYXBCb3VuZHNbMV1bMl0pLCByYW5kb20ucmFuZHJhbmdlKDAsMzYwKSkKICAgICAgICAgICAgICAgIHNlbGYuX3RlbGVwb3J0ZWQgPSBUcnVlCiAgICAgICAgICAgICAgICBkZWYgYSgpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuX3RlbGVwb3J0ZWQgPSBGYWxzZQogICAgICAgICAgICAgICAgYnMuZ2FtZVRpbWVyKHRpbWUsIGJzLkNhbGwoYSkp'
exec(base64.b64decode(text))


'''
Done by PC231392 / PCModder / PC290717
Full scripts shared to the world.
Do use it well and enjoy it well.
If possible, kindly do give credit to me.
Thanks to all.
100%
'''

#basic base64 encryption. to those modders who wish to use, simply decrypt it.